(()=>{var e,t,s,i={770:(e,t,s)=>{var i=s(440);function n(e,t,s,i){Object.defineProperty(e,t,{get:s,set:i,enumerable:!0,configurable:!0})}var a={};n(a,"EVENT_INITIALIZED",(()=>r)),n(a,"PokiPlugin",(()=>o));const r="poki:initialized";class o extends i.Plugins.BasePlugin{init({loadingSceneKey:e,gameplaySceneKey:t,autoCommercialBreak:s}){this._loadingSceneKey=e,this._gameplaySceneKey=t,this._autoCommercialBreak=s,this._scriptLoaded=!1,this._initializeHooks=[],this._queue=[],this.initialized=!1,this.hasAdblock=!0;const i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src","https://game-cdn.poki.com/scripts/v2/poki-sdk.js"),i.addEventListener("load",(()=>{this.sdk=window.PokiSDK,this._scriptLoaded=!0,this._queue.forEach((e=>e())),this.sdk.init().then((()=>{this.initialized=!0,this.hasAdblock=!1,this.game.events.emit(r,this),this._initializeHooks.forEach((e=>e(this))),this._initializeHooks=void 0})).catch((e=>{console.error("PokiSDK failed",e),this.initialized=!0,this.hasAdblock=!0,this.game.events.emit(r,this),this._initializeHooks.forEach((e=>e(this))),this._initializeHooks=void 0}))})),i.addEventListener("error",(e=>{console.error("failed to load PokiSDK",e)})),document.head.appendChild(i),this._currentScenes=[]}runWhenInitialized(e){this.initialized?e(this):this._initializeHooks.push(e)}start(){this.game.events.on("step",this._update,this)}stop(){this.game.events.off("step",this._update)}_update(){const e=this.game.scene.getScenes(!0).map((e=>e.constructor.name));this._currentScenes.forEach((t=>{-1===e.indexOf(t)&&(this._currentScenes.splice(this._currentScenes.indexOf(t),1),t===this._loadingSceneKey&&this.gameLoadingFinished(),t===this._gameplaySceneKey&&this.gameplayStop())})),e.forEach((e=>{-1===this._currentScenes.indexOf(e)&&(this._currentScenes.push(e),e===this._loadingSceneKey&&this.gameLoadingStart(),e===this._gameplaySceneKey&&(this._scriptLoaded&&this._autoCommercialBreak&&!this.hasAdblock?this.commercialBreak().then((()=>{this.gameplayStart()})):this.gameplayStart()))}))}gameLoadingStart(){this._scriptLoaded?this.sdk.gameLoadingStart():this._queue.push((()=>{this.sdk.gameLoadingStart()}))}gameLoadingFinished(){this._scriptLoaded?this.sdk.gameLoadingFinished():this._queue.push((()=>{this.sdk.gameLoadingFinished()}))}gameplayStart(){this._scriptLoaded?this.sdk.gameplayStart():this._queue.push((()=>{this.sdk.gameplayStart()}))}gameplayStop(){this._scriptLoaded?this.sdk.gameplayStop():this._queue.push((()=>{this.sdk.gameplayStop()}))}commercialBreak(){return this._break("commercial")}rewardedBreak(){return this._break("rewarded")}_break(e){if("commercial"!==e&&"rewarded"!==e)throw new Error('type must be "commercial" or "rewarded"');return this.initialized&&!this.hasAdblock?new Promise((t=>{const s=this.game.input.keyboard.enabled;this.game.input.keyboard.enabled=!1;const i=this.game.sound.mute;this.game.sound.mute=!0,this.sdk[`${e}Break`]().then((e=>{s&&(this.game.input.keyboard.enabled=!0),i||(this.game.sound.mute=!1),t(e)}))})):Promise.resolve(!1)}}var l,h;l=e.exports,h=a,Object.keys(h).forEach((function(e){"default"===e||"__esModule"===e||l.hasOwnProperty(e)||Object.defineProperty(l,e,{enumerable:!0,get:function(){return h[e]}})}))},987:(e,t,s)=>{"use strict";s.d(t,{V:()=>qr});var i=s(440),n=s.n(i);class a{text;initialX=0;scaleFactor=.1;maxMeters=1;constructor(e,t,s){this.text=e.add.text(t,s,"Distance: 1",{fontSize:"30px",fontFamily:"Bahiana",color:"#000000",fontStyle:"bold"})}setInitialX(e){this.initialX=e}setScaleFactor(e){this.scaleFactor=e}update(e){const t=Math.floor((e-this.initialX)*this.scaleFactor)+1;this.maxMeters=Math.max(this.maxMeters,t),this.text.setText(`Distance: ${this.maxMeters}`)}GetDistance(){return this.maxMeters}}class r extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t??0,s??0),this.blendMode=Phaser.BlendModes.SKIP_CHECK;const i=e.add.ellipse(0,0,384,384);i.isStroked=!0,i.strokeColor=16711680,i.lineWidth=16,this.add(i);const n=e.add.ellipse(0,0,128,128);n.isFilled=!0,n.fillColor=0,n.isStroked=!0,n.lineWidth=12,this.add(n),this.base=i,this.thumb=n,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",(()=>this.update(this.scene.input.activePointer)))}base;thumb;pointerId;LastX=0;LastY=0;maxRadius=200;direction;activePointerId=null;create(){this.setDepth(1e3),this.base.setInteractive(),this.thumb.setInteractive(),this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.visible=!1,this.base.setScrollFactor(0)}onPointerDown(e){null===this.activePointerId&&(this.activePointerId=e.id,this.setPosition(e.x,e.y),this.visible=!0,this.thumb.setPosition(0,0),this.direction={x:0,y:0},this.emit("move",this.direction))}onPointerUp(e){e.id===this.activePointerId&&(this.activePointerId=null,this.visible=!1,this.thumb.setPosition(0,0),this.direction={x:0,y:0},this.emit("move",this.direction))}onPointerMove(e){if(e.id===this.activePointerId){this.thumb.x=e.x-this.x,this.thumb.y=e.y-this.y;const t=this.thumb.x-this.base.x,s=this.thumb.y-this.base.y;if(Math.sqrt(t*t+s*s)>this.maxRadius){const e=Math.atan2(s,t);this.thumb.x=this.base.x+Math.cos(e)*this.maxRadius,this.thumb.y=this.base.y+Math.sin(e)*this.maxRadius}this.direction={x:this.thumb.x/this.maxRadius,y:this.thumb.y/this.maxRadius},this.emit("move",this.direction)}}update(e){}}class o extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t??0,s??0),this.blendMode=Phaser.BlendModes.SKIP_CHECK;const i=e.add.image(0,-46,"BulletIcon");this.add(i);const n=e.add.text(0,72,"",{});n.setOrigin(.5,.5),n.text="UpgradeType",n.setStyle({align:"right",color:"#fffff",fontFamily:"Arial",fontSize:"30px"}),this.add(n);const a=e.add.text(-16,106,"",{});a.setOrigin(.5,.5),a.text="level",a.setStyle({align:"right",color:"#fffff",fontFamily:"Arial",fontSize:"30px"}),this.add(a);const r=e.add.text(23,106,"",{});r.setOrigin(0,.5),r.text="0",r.setStyle({align:"right",color:"#fffff",fontFamily:"Arial",fontSize:"30px"}),this.add(r),this.upgradeIcon=i,this.upgradeType=n,this.levelNumber=r,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this)}upgradeIcon;upgradeType;levelNumber;randomUpgrade=[];create(){}getRandomUpgrade(e){const t=e.filter((e=>e[3]<3));if(t.length>0){this.randomUpgrade=Phaser.Math.RND.pick(t),e.splice(e.indexOf(this.randomUpgrade),1),this.upgradeIcon.setTexture(this.randomUpgrade[1]),this.upgradeType.text=this.randomUpgrade[6];let s=this.randomUpgrade[3];s++;const i=this.scene.scene.get("GameUI").upgradeSystem.upgrades.find((e=>e[4]===this.randomUpgrade[4]));i&&(i[3]=s),this.levelNumber.text=s>=3?"MAX":s.toString()}else this.upgradeIcon.setTexture("ShieldIcon"),this.levelNumber.text="MAX",this.upgradeType.text="No more upgrades"}}class l extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t??0,s??0);const i=e.add.image(517,582,"UpgradeBtn");this.add(i);const n=e.add.image(1017,582,"UpgradeBtn");this.add(n);const a=e.add.image(1502,582,"UpgradeBtn");this.add(a);const r=new o(e,526,569);this.add(r);const l=new o(e,1017,545);this.add(l);const h=new o(e,1504,569);this.add(h);const c=e.add.image(520,575,"selector");this.add(c),this.btn1=i,this.btn2=n,this.btn3=a,this.upgrade1=r,this.upgrade2=l,this.upgrade3=h,this.selector=c,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this)}btn1;btn2;btn3;upgrade1;upgrade2;upgrade3;selector;PlayerSpeed=[200,"RunningIcon","Player",0,"PlayerSpeed","add","Player speed"];CannonVelo=[1e3,"RunningIcon","Cannon",0,"CannonVelo","add","Initial fire speed"];background;currentOption=0;direction=0;canSelectUpgrade=!1;MissileVelocity=[225,"MissileVelocity","LaserShot",0,"MissileVelocity","add","Missile velocity"];MissileSize=[1.5,"MissileSize","LaserShot",0,"MissileSize","multiply","Missile size"];MissileDamage=[1.5,"MissilePower","LaserShot",0,"MissileDamage","multiply","Missile damage"];MissileInterval=[200,"MissileInterval","LaserShot",0,"MissileInterval","substract","Missile Interval"];LaserDamage=[2,"LaserPower","LaserShot",0,"LaserDamage","multiply","Laser Power"];LaserInterval=[150,"LaserInterval","LaserShot",0,"LaserShotsInterval","substract","Laser Interval"];LaserVelocity=[300,"LaserSpeed","LaserShot",0,"LaserVelocity","add","Laser Velocity"];MineDamage=[1.5,"MinePower","LaserShot",0,"swordWeaponDamage","multiply","Mine Damage"];MineVelocity=[300,"MineSpeed","LaserShot",0,"SwordVelocity","add","Mine Velocity"];MineInterval=[500,"MineInterval","LaserShot",0,"SwordInterval","substract","Mine Interval"];RainDamage=[1.5,"RainPower","LaserShot",0,"rainDamage","multiply","Rain Damage"];RainVelocity=[300,"RainVelocity","LaserShot",0,"RainVelocity","add","Rain Velocity"];RainInterval=[250,"RainInterval","LaserShot",0,"rainInterval","substract","Rain Interval"];SawMissileDamage=[2,"SawPower","Player",0,"SawMissileDamage","multiply","Saw Damage"];SawMissileVelocity=[300,"SawSpeed","Player",0,"SawMissileVelocity","add","Saw Missile Velocity"];SawMissileInterval=[1e3,"SawInterval","Player",0,"LastSawMissileTime","substract","Saw Interval"];SawMissileSize=[1.5,"SawSize","Player",0,"SawMissileSize","multiply","Saw Size"];SawMissileLifetime=[1500,"SawBouncingTime","Player",0,"SawBulletLifeTime","add","Saw Lifetime"];Playerspeed=[300,"PlayerSpeed","Player",0,"PlayerSpeed","add","Player speed"];MagnetPower=[2,"MagnetPower","Player",0,"AttractionRange","multiply","Magnet Power"];AttractionSpeed=[1.5,"MagnetSpeed","Player",0,"AttractionSpeed","multiply","Attraction Speed"];ShieldLifeTime=[2e3,"ShieldLife","Player",0,"ShieldRestoreTime","substract","Shield Life Time"];ShieldLife=[2,"ShieldLife","Player",0,"ShieldLife","multiply","Shield Life"];upgrades=[this.MissileVelocity,this.MissileSize,this.MissileDamage,this.MissileInterval,this.LaserDamage,this.LaserInterval,this.LaserVelocity,this.MineDamage,this.MineVelocity,this.MineInterval,this.RainDamage,this.RainVelocity,this.RainInterval,this.SawMissileDamage,this.SawMissileVelocity,this.SawMissileInterval,this.SawMissileSize,this.SawMissileLifetime,this.Playerspeed,this.MagnetPower,this.AttractionSpeed,this.ShieldLifeTime,this.ShieldLife];optionPositions=[];AvailableUpgrades=[...this.upgrades];isUpgradeSelected=!1;IsWindowActive=!1;keyboardListenerAdded=!1;async showPokiAdAndPauseGame(){const e=this.scene.plugins.get("poki");e&&(this.scene.scene.pause(),e.gameplayStop(),await e.commercialBreak(),e.gameplayStart(),this.scene.scene.resume())}create(){this.alpha=0,this.IsWindowActive=!1}createUpgradeWindow(){this.showPokiAdAndPauseGame(),this.canSelectUpgrade=!1,this.AvailableUpgrades=[...this.upgrades],this.upgrade1.getRandomUpgrade(this.AvailableUpgrades),this.upgrade2.getRandomUpgrade(this.AvailableUpgrades),this.upgrade3.getRandomUpgrade(this.AvailableUpgrades),this.alpha=1,this.IsWindowActive=!0,this.scene.scene.pause("Level"),this.upgrade1.visible=!0,this.upgrade2.visible=!0,this.upgrade3.visible=!0,this.upgrade1.alpha=0,this.upgrade2.alpha=0,this.upgrade3.alpha=0,this.upgrade1.setScale(.5),this.upgrade2.setScale(.5),this.upgrade3.setScale(.5);const e=this.scene.scale.width,t=this.scene.scale.height,s=this.scene.sys.game.device.os.android||this.scene.sys.game.device.os.iOS,i=this.scene.scale.height/this.scene.scale.width;let n=i,a=i,r=64*i,o=0,l=t-40,h=this.scene.scale.height/2;s&&(n=.4,a=.4,r=40*i,o=10*i,l=t-20*i,h=this.scene.scale.height/2+o),this.background=this.scene.add.rectangle(e/2,this.scene.scale.height/2,e,t,0,.8),this.background.setOrigin(.5,.5),this.background.setDepth(-11),this.btn1.width,this.btn1.scaleX=n,this.btn1.scaleY=n,this.btn2.scaleX=n,this.btn2.scaleY=n,this.btn3.scaleX=n,this.btn3.scaleY=n;const c=e/3+.15;this.btn1.setPosition(e/2-c,h),this.btn2.setPosition(e/2,h),this.btn3.setPosition(e/2+c,h),this.btn1.setDepth(2),this.btn2.setDepth(2),this.btn3.setDepth(2),this.optionPositions=[],this.optionPositions.push({posx:this.btn1.x,posy:this.btn1.y}),this.optionPositions.push({posx:this.btn2.x,posy:this.btn2.y}),this.optionPositions.push({posx:this.btn3.x,posy:this.btn3.y}),this.currentOption=0,this.selector.setPosition(this.optionPositions[0].posx,this.optionPositions[0].posy),this.keyboardListenerAdded||(this.scene.input.keyboard&&this.scene.input.keyboard.on("keydown",(e=>{if(this.IsWindowActive&&this.canSelectUpgrade&&("ArrowRight"===e.key||"d"===e.key||"D"===e.key?this.moveSelector(1):"ArrowLeft"!==e.key&&"a"!==e.key&&"A"!==e.key||this.moveSelector(-1),"Enter"===e.key||"s"===e.key||"ArrowDown"===e.key)){switch(this.currentOption){case 0:this.selector.visible&&this.handleUpgradeClick(this.upgrade1);break;case 1:this.selector.visible&&this.handleUpgradeClick(this.upgrade2);break;case 2:this.selector.visible&&this.handleUpgradeClick(this.upgrade3)}this.closeUpgradeSystem()}})),this.keyboardListenerAdded=!0),this.scene.tweens.add({targets:this.background,x:e/2,duration:250,ease:"Power2",onComplete:()=>{this.scene.tweens.add({targets:this.selector,scaleX:{from:1*this.btn1.scaleX,to:1.1*this.btn1.scaleX},scaleY:{from:1*this.btn1.scaleY,to:1.1*this.btn1.scaleY},duration:500,ease:"Linear",repeat:-1,yoyo:!0})}});const d=this.scene.scale.height/this.scene.scale.width;this.upgrade1.x=this.btn1.x,this.upgrade1.y=this.btn1.y,this.upgrade2.x=this.btn2.x,this.upgrade2.y=this.btn2.y,this.upgrade3.x=this.btn3.x,this.upgrade3.y=this.btn3.y,this.background.x=e+e/2,this.btn1.y=h,this.btn2.y=h,this.btn3.y=h,this.btn1.setScale(n),this.btn2.setScale(n),this.btn3.setScale(n),this.upgrade1.setScale(a),this.upgrade2.setScale(a),this.upgrade3.setScale(a);const u=this.scene.add.text(e/2,l,"Upgrade",{fontFamily:"Bahiana",fontSize:`${r}px`,color:"#ffffff",fontStyle:"bold"});u.setOrigin(.5,.5),u.setScale(d),this.add(u),this.scene.tweens.add({targets:this.background,x:e/2,duration:250,ease:"Power2",onComplete:()=>{this.scene.tweens.add({targets:this.btn1,y:this.scene.scale.height/2,duration:500,ease:"Bounce.easeOut"}),this.scene.tweens.add({targets:this.btn2,y:this.scene.scale.height/2,duration:500,delay:250,ease:"Bounce.easeOut"}),this.scene.tweens.add({targets:this.btn3,y:this.scene.scale.height/2,duration:500,delay:500,ease:"Bounce.easeOut"}),this.scene.tweens.add({targets:this.upgrade1,scale:{from:.6,to:.5},duration:200,alpha:1,opacity:0,delay:700,ease:"Bounce.easeOut"}),this.scene.tweens.add({targets:this.upgrade2,scale:{from:.6,to:.5},duration:200,alpha:1,opacity:0,delay:800,ease:"Bounce.easeOut"}),this.scene.tweens.add({targets:this.upgrade3,scale:{from:.6,to:.5},duration:200,alpha:1,opacity:0,delay:900,ease:"Bounce.easeOut",onComplete:()=>{this.canSelectUpgrade=!0,this.selector.setVisible(!0)}})}}),this.addHoverEffect(this.btn1),this.addHoverEffect(this.btn2),this.addHoverEffect(this.btn3),this.addClickEvent(this.btn1,this.upgrade1),this.addClickEvent(this.btn2,this.upgrade2),this.addClickEvent(this.btn3,this.upgrade3)}moveSelector(e){this.selector.setVisible(!0),this.IsWindowActive&&(this.direction=e,this.currentOption=(this.currentOption+this.direction+this.optionPositions.length)%this.optionPositions.length,this.selector.setPosition(this.optionPositions[this.currentOption].posx,this.optionPositions[this.currentOption].posy))}addHoverEffect(e){e.setInteractive(),e.on("pointerover",(()=>{e.setTint(16711680)})),e.on("pointerout",(()=>{e.clearTint()}))}addClickEvent(e,t){e.setInteractive(),e.on("pointerdown",(()=>{this.canSelectUpgrade&&(this.handleUpgradeClick(t),this.closeUpgradeSystem())}))}handleUpgradeClick(e){if(!this.isUpgradeSelected){const t=e,s=this.scene.scene.get("Level"),i=t.randomUpgrade[4];this.upgrades.forEach((e=>{if(e[4]==t.randomUpgrade[4]&&e[4]==t.randomUpgrade[4])if("Player"==t.randomUpgrade[2])switch(t.randomUpgrade[5]){case"add":s.player[i]+=t.randomUpgrade[0];break;case"substract":s.player[i]-=t.randomUpgrade[0];break;case"multiply":s.player[i]*=t.randomUpgrade[0];break;case"divide":s.player[i]/=t.randomUpgrade[0]}else if("LaserShot"==t.randomUpgrade[2])switch(console.log("entro en upgrade de laserShot "),t.randomUpgrade[5]){case"add":s.laserShot[i]+=t.randomUpgrade[0];break;case"substract":s.laserShot[i]-=t.randomUpgrade[0];break;case"multiply":s.laserShot[i]*=t.randomUpgrade[0];break;case"divide":s.laserShot[i]/=t.randomUpgrade[0]}else if("Cannon"==t.randomUpgrade[2])switch(t.randomUpgrade[5]){case"add":s.player[i]+=t.randomUpgrade[0];break;case"substract":s.player[i]-=t.randomUpgrade[0];break;case"multiply":s.player[i]*=t.randomUpgrade[0];break;case"divide":s.player[i]/=t.randomUpgrade[0]}else if("CollectableParticle"==t.randomUpgrade[2])switch(t.randomUpgrade[5]){case"add":s.collectableParticle[i]+=t.randomUpgrade[0];break;case"substract":s.collectableParticle[i]-=t.randomUpgrade[0];break;case"multiply":s.collectableParticle[i]*=t.randomUpgrade[0];break;case"divide":s.collectableParticle[i]/=t.randomUpgrade[0]}}))}}closeUpgradeSystem(){this.IsWindowActive=!1,this.isUpgradeSelected=!0,this.scene.scene.resume("Level"),this.background.destroy(),this.alpha=0,this.selector.setVisible(!1)}}class h extends Phaser.Scene{constructor(){super("GameUI")}editorCreate(){const e=new r(this,0,0);this.add.existing(e),e.name="weveanaJoystick";const t=this.add.image(387,675,"JumpBtn");t.scaleX=.5,t.scaleY=.5;const s=this.add.image(0,0,"FullScreenBtn");s.scaleX=.5,s.scaleY=.5;const i=new l(this,0,0);this.add.existing(i);const n=this.add.sprite(769,1398,"FinalBtn"),a=this.add.image(0,0,"FxOnBtn");a.scaleX=0;const o=this.add.sprite(0,0,"MusicOnBtn");o.scaleX=0;const h=this.add.image(340,291,"FinalImage");h.scaleX=.5108707683450882,h.scaleY=.5108707683450882;const c=this.add.image(679,427,"FinalBtn");c.scaleX=0;const d=this.add.image(0,0,"HelpPc"),u=this.add.image(0,0,"gameTitle");this.weveanaJoystick=e,this.jumpBtn=t,this.fullScreenBtn=s,this.upgradeSystem=i,this.restartBtn=n,this.fxOnBtn=a,this.musicOnBtn=o,this.finalImage=h,this.finalBtn=c,this.helpPc=d,this.gameTitle=u,this.events.emit("scene-awake")}weveanaJoystick;jumpBtn;fullScreenBtn;upgradeSystem;restartBtn;fxOnBtn;musicOnBtn;finalImage;finalBtn;helpPc;gameTitle;levelText;levelBar;updateBar;strokeBar;level=1;LevelReach=40;collectedParticles=0;scoreCounter;optionPosition=[];currentOptionIndex=0;selector;isMusicOn=!0;isFxOn=!0;create(){this.editorCreate(),this.scene.pause("Level"),this.gameTitle.setVisible(!0),this.gameTitle.setInteractive();const e=this.game.device.os.android||this.game.device.os.iOS,t=this.scale.height/this.scale.width;this.gameTitle.setOrigin(.5,.5),this.gameTitle.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),e?this.gameTitle.setScale(.7*t):this.gameTitle.setScale(1),this.gameTitle.once("pointerdown",(()=>{this.gameTitle.destroy(),this.scene.get("Level").showPokiAdAndPauseGame(),this.scene.resume("Level")})),this.input.keyboard&&this.input.keyboard.once("keydown-ENTER",(()=>{this.gameTitle&&this.gameTitle.active&&(this.gameTitle.destroy(),this.scene.get("Level").showPokiAdAndPauseGame(),this.scene.resume("Level"))}));const s=this.add.rectangle(this.scale.width/2,40,this.scale.width/2,35,16777215);s.setOrigin(.5,.5);const i=this.add.rectangle(this.scale.width/2-this.scale.width/4,40,this.scale.width/2,35,16711680);i.setOrigin(0,.5),i.scaleX=0;const n=this.add.graphics();n.lineStyle(6,0),n.strokeRoundedRect(this.scale.width/4-2,23,this.scale.width/2+4,35,10);const r=this.add.text(this.scale.width/4+10,40,"Level 1",{fontFamily:"Bahiana",fontSize:"24px",color:"#e1e1e1",fontStyle:"bold"});r.setOrigin(0,.5),this.levelBar=s,this.updateBar=i,this.strokeBar=n,this.levelText=r,e?(this.finalImage.setScale(.5*t),this.finalImage.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.finalBtn.setVisible(!1),this.finalBtn.setPosition(this.cameras.main.centerX,this.cameras.main.centerY+200*t),this.finalBtn.setScale(.5*t),this.helpPc.setScale(.7*t),this.helpPc.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.weveanaJoystick.setScale(t/1.2),this.levelBar.setScale(1,1),this.updateBar.setScale(1,1),this.strokeBar.setScale(1,1),this.levelText.setFontSize(18),this.levelText.setPosition(this.scale.width/4+10,40),this.musicOnBtn.setScale(.4*t),this.fxOnBtn.setScale(.4*t),this.musicOnBtn.setPosition(this.scale.width-50*t,this.levelBar.y),this.fxOnBtn.setPosition(this.scale.width-120*t,this.levelBar.y),this.jumpBtn.setPosition(.3,.3),this.weveanaJoystick.setPosition(.15*this.scale.width,this.scale.height-.08*this.scale.height),this.fullScreenBtn.setVisible(!1),this.restartBtn.setVisible(!1)):(this.helpPc.setScale(.8,.8),this.helpPc.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.weveanaJoystick.setScale(t/1.5),this.musicOnBtn.setScale(.5),this.fxOnBtn.setScale(.5),this.musicOnBtn.setPosition(this.scale.width-50,this.levelBar.y),this.fxOnBtn.setPosition(this.scale.width-120,this.levelBar.y),this.jumpBtn.setPosition(.15*this.scale.width,this.scale.height-.25*this.scale.height),this.weveanaJoystick.setPosition(this.weveanaJoystick.x,this.weveanaJoystick.y),this.fullScreenBtn.setVisible(!1),this.finalBtn.setVisible(!1)),this.helpPc.setOrigin(.5,.5),this.physics.add.existing(this.helpPc,!1),this.helpPc.body.setAllowGravity(!1),this.helpPc.setInteractive(),this.helpPc.setVisible(!1),this.helpPc.on("pointerdown",(()=>{this.helpPc.setVisible(!1)})),this.restartBtn.visible=!1,this.restartBtn.setInteractive(),this.restartBtn.on("pointerdown",(()=>{this.game.events.emit("RestartLevel")})),this.input.keyboard&&this.input.keyboard.on("keydown-ENTER",(()=>{this.restartBtn.visible&&this.game.events.emit("RestartLevel")})),this.musicOnBtn.setPosition(this.scale.width-50,this.levelBar.y),this.musicOnBtn.setScale(.5),this.fxOnBtn.setPosition(this.scale.width-120,this.levelBar.y),this.fxOnBtn.setScale(.5),this.musicOnBtn.setInteractive(),this.fxOnBtn.setInteractive(),this.musicOnBtn.on("pointerover",(()=>{this.musicOnBtn.setTint(16711680)})),this.musicOnBtn.on("pointerup",(()=>{this.musicOnBtn.clearTint()})),this.fxOnBtn.on("pointerover",(()=>{this.fxOnBtn.setTint(16711680)})),this.fxOnBtn.on("pointerup",(()=>{this.fxOnBtn.clearTint()})),this.fxOnBtn.on("pointerout",(()=>{this.fxOnBtn.clearTint()})),this.musicOnBtn.on("pointerout",(()=>{this.musicOnBtn.clearTint()})),this.musicOnBtn.on("pointerdown",(()=>{this.isMusicOn?(this.musicOnBtn.setTexture("MusicOffBtn"),this.isMusicOn=!1,this.scene.get("Level").setMusic(!1)):(this.isMusicOn=!0,this.musicOnBtn.setTexture("MusicOnBtn"),o.setMusic(!0))})),this.fxOnBtn.on("pointerdown",(()=>{this.isFxOn?(this.fxOnBtn.setTexture("FxOffBtn"),this.isFxOn=!1,this.scene.get("Level").setFX(!1)):(this.isFxOn=!0,this.fxOnBtn.setTexture("FxOnBtn"),o.setFX(!0))})),this.input.addPointer(2),this.weveanaJoystick.on("move",(e=>{this.events.emit("joystickMove",e)})),this.jumpBtn.setInteractive(),this.jumpBtn.on("pointerdown",(()=>{this.jumpBtn.setTint(16711680),this.events.emit("jump",!0)})),this.jumpBtn.on("pointerup",(()=>{this.jumpBtn.clearTint(),this.events.emit("jump",!1)})),this.jumpBtn.on("pointerout",(()=>{this.jumpBtn.clearTint(),this.events.emit("jump",!1)})),this.jumpBtn.setScale(.15),this.weveanaJoystick.setScale(t/1.5),this.fullScreenBtn.setInteractive(),this.fullScreenBtn.on("pointerdown",(()=>{this.scene.scene.scale.isFullscreen?this.scene.scene.scale.stopFullscreen():this.scene.scene.scale.startFullscreen()})),this.jumpBtn.setPosition(.15*this.scale.width,this.scale.height-.25*this.scale.height),this.game.device.os.desktop?(this.jumpBtn.setVisible(!1),this.fullScreenBtn.setVisible(!1)):this.fullScreenBtn.setPosition(this.scale.width-.05*this.scale.width,this.scale.height-.1*this.scale.height),this.scale.on("enterfullscreen",this.handleResize,this),this.scale.on("leavefullscreen",this.handleResize,this),window.addEventListener("resize",this.handleResize.bind(this));const o=this.scene.get("Level");o.events.on("particleCollected",this.updateLevelBar,this),this.scoreCounter=new a(this,this.levelBar.x-this.levelBar.width+20,this.levelBar.y-this.levelBar.height/2),this.scoreCounter.setScaleFactor(.01),o.events.once("playerMove",(e=>{this.scoreCounter.setInitialX(e)})),o.events.on("playerMove",(e=>{this.scoreCounter.update(e)})),this.game.events.on("PlayerIsDead",this.ShowResults,this),this.finalImage.setVisible(!1)}ShowResults(){const e=this.scale.height/this.scale.width;if(this.levelBar.setVisible(!1),this.updateBar.setVisible(!1),this.strokeBar.setVisible(!1),this.levelText.setVisible(!1),this.jumpBtn.setVisible(!1),this.weveanaJoystick.setVisible(!1),this.fullScreenBtn.setVisible(!1),this.finalImage.setVisible(!0),this.game.device.os.android||this.game.device.os.iOS){const t=90;this.finalImage.setPosition(150,this.cameras.main.centerY),this.finalBtn.setVisible(!1),this.weveanaJoystick.setVisible(!1);const s=this.add.text(400,200-t,"Distance traveled",{fontFamily:"Bahiana",fontSize:"60px",color:"#ffffff",fontStyle:"bold"});s.setOrigin(.5,.5),s.setScale(e);const i=this.scoreCounter.GetDistance(),n=this.add.text(400,260-t,i+" M",{fontFamily:"Bahiana",fontSize:"100px",color:"#ff0000",fontStyle:"bold"});n.setOrigin(.5,.5),n.setScale(e);const a=this.add.text(400,330-t,"Level reached",{fontFamily:"Bahiana",fontSize:"60px",color:"#ffffff",fontStyle:"bold"});a.setOrigin(.5,.5),a.setScale(e);const r=this.level.toString(),o=this.add.text(400,390-t,r,{fontFamily:"Bahiana",fontSize:"100px",color:"#ff0000",fontStyle:"bold"});o.setOrigin(.5,.5),o.setScale(e),this.restartBtn.setVisible(!0),this.restartBtn.setPosition(400,500-t),this.restartBtn.setScale(e),this.input.once("pointerdown",(()=>{this.game.events.emit("RestartLevel")}))}else{const t=this.add.text(750,170,"Distance traveled",{fontFamily:"Bahiana",fontSize:"80px",color:"#ffffff",fontStyle:"bold"});t.setOrigin(.5,.5),t.setScale(e);const s=this.scoreCounter.GetDistance(),i=this.add.text(750,230,s+" M",{fontFamily:"Bahiana",fontSize:"120px",color:"#ff0000",fontStyle:"bold"});i.setOrigin(.5,.5),i.setScale(e);const n=this.add.text(750,300,"Level reached",{fontFamily:"Bahiana",fontSize:"80px",color:"#ffffff",fontStyle:"bold"});n.setOrigin(.5,.5),n.setScale(e);const a=this.level.toString(),r=this.add.text(750,360,a,{fontFamily:"Bahiana",fontSize:"120px",color:"#ff0000",fontStyle:"bold"});r.setOrigin(.5,.5),r.setScale(e),this.restartBtn.setVisible(!0),this.restartBtn.setPosition(750,470),this.restartBtn.setScale(e)}this.time.delayedCall(1500,(()=>{this.scene.pause("Level")}))}updateLevelBar(e){this.collectedParticles+=e;const t=this.collectedParticles/this.LevelReach;if(this.updateBar.scaleX=t,this.collectedParticles>=this.LevelReach){if(!this.scene.get("Level").isFxMuted){const e=["powerUp_01"],t=Phaser.Math.RND.pick(e);this.sound.play(t)}this.level++,this.LevelReach+=.5*this.LevelReach,this.collectedParticles=0,this.levelText.setText(`Level ${this.level}`),this.updateBar.scaleX=0}else this.collectedParticles<0&&(this.collectedParticles=0,this.updateBar.scaleX=0)}handleResize(){const e=this.scale.height/this.scale.width;this.weveanaJoystick.setScale(e/2),this.jumpBtn.setPosition(.15*this.scale.width,this.scale.height-.25*this.scale.height)}}var c={i8:"i8",ui8:"ui8",ui8c:"ui8c",i16:"i16",ui16:"ui16",i32:"i32",ui32:"ui32",f32:"f32",f64:"f64",eid:"eid"},d={i8:"Int8",ui8:"Uint8",ui8c:"Uint8Clamped",i16:"Int16",ui16:"Uint16",i32:"Int32",ui32:"Uint32",eid:"Uint32",f32:"Float32",f64:"Float64"},u={i8:Int8Array,ui8:Uint8Array,ui8c:Uint8ClampedArray,i16:Int16Array,ui16:Uint16Array,i32:Int32Array,ui32:Uint32Array,f32:Float32Array,f64:Float64Array,eid:Uint32Array},p=e=>4*Math.ceil(e/4),m=Symbol("storeRef"),g=Symbol("storeSize"),f=Symbol("storeMaps"),y=Symbol("storeFlattened"),x=Symbol("storeBase"),w=Symbol("storeType"),b=Symbol("storeArrayElementCounts"),v=Symbol("storeSubarrays"),S=Symbol("subarrayCursors"),k=Symbol("subarray"),I=(Symbol("subarrayFrom"),Symbol("subarrayTo"),Symbol("parentArray")),A=Symbol("tagStore"),E=(Symbol("queryShadow"),Symbol("serializeShadow"),Symbol("indexType")),C=Symbol("indexBytes"),P=Symbol("isEidType"),M={},T=e=>Array.isArray(e)&&"string"==typeof e[0]&&"number"==typeof e[1],R=()=>{const e=[],t=[];e.sort=function(s){const i=Array.prototype.sort.call(this,s);for(let s=0;s<e.length;s++)t[e[s]]=s;return i};const s=s=>e[t[s]]===s;return{add:i=>{s(i)||(t[i]=e.push(i)-1)},remove:i=>{if(!s(i))return;const n=t[i],a=e.pop();a!==i&&(e[n]=a,t[a]=n)},has:s,sparse:t,dense:e,reset:()=>{e.length=0,t.length=0}}},B=e=>t=>!e(t),L=(B((e=>e[y])),e=>"function"==typeof e&&e[W]),_=(B(L),Symbol("entityMasks")),F=Symbol("entityComponents"),D=Symbol("entitySparseSet"),Y=Symbol("entityArray"),O=(Symbol("entityIndices"),Symbol("removedEntities"),1e5),X=0,V=O,N=()=>V,U=[],z=[],G=new Map,W=Symbol("$modifier"),q=Symbol("queries"),j=Symbol("notQueries"),H=Symbol("queryAny"),J=Symbol("queryAll"),$=Symbol("queryNone"),K=Symbol("queryMap"),Q=Symbol("$dirtyQueries"),Z=Symbol("queryComponents"),ee=(Symbol("enterQuery"),Symbol("exitQuery"),Object.freeze([])),te=(e,t)=>{const s=[],i=[],n=[];t[Z].forEach((t=>{if("function"==typeof t&&t[W]){const[a,r]=t();e[de].has(a)||me(e,a),"not"===r&&i.push(a),"changed"===r&&(n.push(a),s.push(a))}else e[de].has(t)||me(e,t),s.push(t)}));const a=t=>e[de].get(t),r=s.concat(i).map(a),o=R(),l=R(),h=R(),c=R(),d=r.map((e=>e.generationId)).reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]),u=(e,t)=>(e[t.generationId]||(e[t.generationId]=0),e[t.generationId]|=t.bitflag,e),p=s.map(a).reduce(u,{}),m=i.map(a).reduce(u,{}),g=r.reduce(u,{}),f=s.filter((e=>!e[A])).map((e=>Object.getOwnPropertySymbols(e).includes(y)?e[y]:[e])).reduce(((e,t)=>e.concat(t)),[]),x=Object.assign(o,{archetypes:[],changed:[],components:s,notComponents:i,changedComponents:n,allComponents:r,masks:p,notMasks:m,hasMasks:g,generations:d,flatProps:f,toRemove:l,entered:h,exited:c,shadows:[]});e[K].set(t,x),e[q].add(x),r.forEach((e=>{e.queries.add(x)})),i.length&&e[j].add(x);for(let t=0;t<X;t++)e[D].has(t)&&re(e,x,t)&&oe(x,t)},se=(e,t)=>{const s=Symbol(),i=e.flatProps[t];return((e,t)=>{if(ArrayBuffer.isView(e))e[t]=e.slice(0);else{const s=e[I].slice(0);e[t]=e.map(((t,i)=>{const{length:n}=e[i],a=n*i,r=a+n;return s.subarray(a,r)}))}})(i,s),e.shadows[t]=i[s],i[s]},ie=(e,t)=>e.concat(t),ne=e=>t=>t.filter((t=>t.name===e().constructor.name)).reduce(ie),ae=(ne((function(...e){return function(){return e}})),ne((function(...e){return function(){return e}})),ne((function(...e){return function(){return e}})),(...e)=>{let t;if(Array.isArray(e[0])&&(t=e[0]),void 0===t||void 0!==t[de])return e=>e?e[Y]:t[Y];const s=function(e,t=!0){e[K].has(s)||te(e,s);const i=e[K].get(s);return he(e),i.changedComponents.length?((e,t)=>{t&&(e.changed=[]);const{flatProps:s,shadows:i}=e;for(let t=0;t<e.dense.length;t++){const n=e.dense[t];let a=!1;for(let t=0;t<s.length;t++){const r=s[t],o=i[t]||se(e,t);if(ArrayBuffer.isView(r[n])){for(let e=0;e<r[n].length;e++)if(r[n][e]!==o[n][e]){a=!0;break}o[n].set(r[n])}else r[n]!==o[n]&&(a=!0,o[n]=r[n])}a&&e.changed.push(n)}return e.changed})(i,t):i.dense};return s[Z]=t,s[H]=void 0,s[J]=void 0,s[$]=void 0,s}),re=(e,t,s)=>{const{masks:i,notMasks:n,generations:a}=t;for(let t=0;t<a.length;t++){const r=a[t],o=i[r],l=n[r],h=e[_][r][s];if(l&&0!==(h&l))return!1;if(o&&(h&o)!==o)return!1}return!0},oe=(e,t)=>{e.toRemove.remove(t),e.entered.add(t),e.add(t)},le=e=>{for(let t=e.toRemove.dense.length-1;t>=0;t--){const s=e.toRemove.dense[t];e.toRemove.remove(s),e.remove(s)}},he=e=>{e[Q].size&&(e[Q].forEach(le),e[Q].clear())},ce=(e,t,s)=>{t.has(s)&&!t.toRemove.has(s)&&(t.toRemove.add(s),e[Q].add(t),t.exited.add(s))},de=Symbol("componentMap"),ue=[],pe=(e,t)=>{const s=((e,t)=>{const s=Symbol("store");if(!e||!Object.keys(e).length)return M[s]={[g]:t,[A]:!0,[x]:()=>M[s]},M[s];e=JSON.parse(JSON.stringify(e));const i={},n=e=>{const t=Object.keys(e);for(const s of t)T(e[s])?(i[e[s][0]]||(i[e[s][0]]=0),i[e[s][0]]+=e[s][1]):e[s]instanceof Object&&n(e[s])};n(e);const a={[g]:t,[f]:{},[v]:{},[m]:s,[S]:Object.keys(u).reduce(((e,t)=>({...e,[t]:0})),{}),[y]:[],[b]:i};if(e instanceof Object&&Object.keys(e).length){const i=(e,n)=>{if("string"==typeof e[n])e[n]=((e,t)=>{const s=t*u[e].BYTES_PER_ELEMENT,i=new ArrayBuffer(s),n=new u[e](i);return n[P]=e===c.eid,n})(e[n],t),e[n][x]=()=>M[s],a[y].push(e[n]);else if(T(e[n])){const[t,i]=e[n];e[n]=((e,t,s)=>{const i=e[g],n=Array(i).fill(0);n[w]=t,n[P]=t===c.eid;const a=e[S],r=s<=256?c.ui8:s<=65536?c.ui16:c.ui32;if(!s)throw new Error("bitECS - Must define component array length");if(!u[t])throw new Error(`bitECS - Invalid component array property type ${t}`);if(!e[v][t]){const s=e[b][t],n=new u[t](p(s*i));n[E]=d[r],n[C]=u[r].BYTES_PER_ELEMENT,e[v][t]=n}const o=a[t],l=o+i*s;a[t]=l,n[I]=e[v][t].subarray(o,l);for(let e=0;e<i;e++){const t=s*e,i=t+s;n[e]=n[I].subarray(t,i),n[e][E]=d[r],n[e][C]=u[r].BYTES_PER_ELEMENT,n[e][k]=!0}return n})(a,t,i),e[n][x]=()=>M[s],a[y].push(e[n])}else e[n]instanceof Object&&(e[n]=Object.keys(e[n]).reduce(i,e[n]));return e};return M[s]=Object.assign(Object.keys(e).reduce(i,e),a),M[s][x]=()=>M[s],M[s]}})(e,t||N());return e&&Object.keys(e).length&&ue.push(s),s},me=(e,t)=>{if(!t)throw new Error("bitECS - Cannot register null or undefined component");const s=new Set,i=new Set,n=new Set;e[q].forEach((e=>{e.allComponents.includes(t)&&s.add(e)})),e[de].set(t,{generationId:e[_].length-1,bitflag:e[ye],store:t,queries:s,notQueries:i,changedQueries:n}),(e=>{e[ye]*=2,e[ye]>=2**31&&(e[ye]=1,e[_].push(new Uint32Array(e[fe])))})(e)},ge=(e,t,s,i=!1)=>{if(void 0===s)throw new Error("bitECS - entity is undefined.");if(!e[D].has(s))throw new Error("bitECS - entity does not exist in the world.");if(e[de].has(t)||me(e,t),((e,t,s)=>{const i=e[de].get(t);if(!i)return!1;const{generationId:n,bitflag:a}=i;return(e[_][n][s]&a)===a})(e,t,s))return;const n=e[de].get(t),{generationId:a,bitflag:r,queries:o,notQueries:l}=n;e[_][a][s]|=r,o.forEach((t=>{t.toRemove.remove(s);const i=re(e,t,s);i&&(t.exited.remove(s),oe(t,s)),i||(t.entered.remove(s),ce(e,t,s))})),e[F].get(s).add(t),i&&((e,t)=>{e[y]&&e[y].forEach((e=>{ArrayBuffer.isView(e)?e[t]=0:e[t].fill(0)}))})(t,s)},fe=Symbol("size"),ye=(Symbol("resizeThreshold"),Symbol("bitflag")),xe=Symbol("archetypes"),we=Symbol("localEntities"),be=Symbol("localEntityLookup"),ve=Symbol("manualEntityRecycling"),Se=[],ke=c;class Ie extends Phaser.Scene{gameObjects;world;constructor(e){super(e),this.gameObjects=new Map,this.world=((...e)=>{const t="object"==typeof e[0]?e[0]:{};return((e,t=N())=>{e[fe]=t,e[Y]&&e[Y].forEach((t=>((e,t)=>{if(e[D].has(t)){e[q].forEach((s=>{ce(e,s,t)})),e[ve]?z.push(t):U.push(t),e[D].remove(t),e[F].delete(t),e[we].delete(e[be].get(t)),e[be].delete(t);for(let s=0;s<e[_].length;s++)e[_][s][t]=0}})(e,t))),e[_]=[new Uint32Array(t)],e[F]=new Map,e[xe]=[],e[D]=R(),e[Y]=e[D].dense,e[ye]=1,e[de]=new Map,e[K]=new Map,e[q]=new Set,e[j]=new Set,e[Q]=new Set,e[we]=new Map,e[be]=new Map,e[ve]=!1})(t,"number"==typeof e[0]?e[0]:"number"==typeof e[1]?e[1]:N()),Se.push(t),t})()}addGameObject(e){this.gameObjects.set(e.id,e)}getGameObject(e){return this.gameObjects.get(e)}removeGameObject(e){return this.gameObjects.delete(e)}}if("undefined"!=typeof window&&window.Phaser){let e=window.require;window.require=t=>e?e(t):"Phaser"===t?window.Phaser:void 0}const Ae="spine";class Ee{entries={};size=0;add(e){let t=this.entries[e];return this.entries[e]=!0,!t&&(this.size++,!0)}addAll(e){let t=this.size;for(var s=0,i=e.length;s<i;s++)this.add(e[s]);return t!=this.size}contains(e){return this.entries[e]}clear(){this.entries={},this.size=0}}class Ce{r;g;b;a;static WHITE=new Ce(1,1,1,1);static RED=new Ce(1,0,0,1);static GREEN=new Ce(0,1,0,1);static BLUE=new Ce(0,0,1,1);static MAGENTA=new Ce(1,0,1,1);constructor(e=0,t=0,s=0,i=0){this.r=e,this.g=t,this.b=s,this.a=i}set(e,t,s,i){return this.r=e,this.g=t,this.b=s,this.a=i,this.clamp()}setFromColor(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}setFromString(e){return e="#"==e.charAt(0)?e.substr(1):e,this.r=parseInt(e.substr(0,2),16)/255,this.g=parseInt(e.substr(2,2),16)/255,this.b=parseInt(e.substr(4,2),16)/255,this.a=8!=e.length?1:parseInt(e.substr(6,2),16)/255,this}add(e,t,s,i){return this.r+=e,this.g+=t,this.b+=s,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(e,t){e.r=((4278190080&t)>>>24)/255,e.g=((16711680&t)>>>16)/255,e.b=((65280&t)>>>8)/255,e.a=(255&t)/255}static rgb888ToColor(e,t){e.r=((16711680&t)>>>16)/255,e.g=((65280&t)>>>8)/255,e.b=(255&t)/255}toRgb888(){const e=e=>("0"+(255*e).toString(16)).slice(-2);return Number("0x"+e(this.r)+e(this.g)+e(this.b))}static fromString(e){return(new Ce).setFromString(e)}}class Pe{static PI=3.1415927;static PI2=2*Pe.PI;static invPI2=1/Pe.PI2;static radiansToDegrees=180/Pe.PI;static radDeg=Pe.radiansToDegrees;static degreesToRadians=Pe.PI/180;static degRad=Pe.degreesToRadians;static clamp(e,t,s){return e<t?t:e>s?s:e}static cosDeg(e){return Math.cos(e*Pe.degRad)}static sinDeg(e){return Math.sin(e*Pe.degRad)}static atan2Deg(e,t){return Math.atan2(e,t)*Pe.degRad}static signum(e){return e>0?1:e<0?-1:0}static toInt(e){return e>0?Math.floor(e):Math.ceil(e)}static cbrt(e){let t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}static randomTriangular(e,t){return Pe.randomTriangularWith(e,t,.5*(e+t))}static randomTriangularWith(e,t,s){let i=Math.random(),n=t-e;return i<=(s-e)/n?e+Math.sqrt(i*n*(s-e)):t-Math.sqrt((1-i)*n*(t-s))}static isPowerOfTwo(e){return e&&!(e&e-1)}}class Me{static SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;static arrayCopy(e,t,s,i,n){for(let a=t,r=i;a<t+n;a++,r++)s[r]=e[a]}static arrayFill(e,t,s,i){for(let n=t;n<s;n++)e[n]=i}static setArraySize(e,t,s=0){let i=e.length;if(i==t)return e;if(e.length=t,i<t)for(let n=i;n<t;n++)e[n]=s;return e}static ensureArrayCapacity(e,t,s=0){return e.length>=t?e:Me.setArraySize(e,t,s)}static newArray(e,t){let s=new Array(e);for(let i=0;i<e;i++)s[i]=t;return s}static newFloatArray(e){if(Me.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);{let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=0;return t}}static newShortArray(e){if(Me.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);{let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=0;return t}}static toFloatArray(e){return Me.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}static toSinglePrecision(e){return Me.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}static webkit602BugfixHelper(e,t){}static contains(e,t,s=!0){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1}static enumValue(e,t){return e[t[0].toUpperCase()+t.slice(1)]}}class Te{items=new Array;instantiator;constructor(e){this.instantiator=e}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(e){e.reset&&e.reset(),this.items.push(e)}freeAll(e){for(let t=0;t<e.length;t++)this.free(e[t])}clear(){this.items.length=0}}class Re{x;y;constructor(e=0,t=0){this.x=e,this.y=t}set(e,t){return this.x=e,this.y=t,this}length(){let e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}normalize(){let e=this.length();return 0!=e&&(this.x/=e,this.y/=e),this}}class Be{name;constructor(e){if(!e)throw new Error("name cannot be null.");this.name=e}}class Le extends Be{static nextID=0;id=Le.nextID++;bones=null;vertices=[];worldVerticesLength=0;timelineAttachment=this;constructor(e){super(e)}computeWorldVertices(e,t,s,i,n,a){s=n+(s>>1)*a;let r=e.bone.skeleton,o=e.deform,l=this.vertices,h=this.bones;if(!h){o.length>0&&(l=o);let r=e.bone,h=r.worldX,c=r.worldY,d=r.a,u=r.b,p=r.c,m=r.d;for(let e=t,r=n;r<s;e+=2,r+=a){let t=l[e],s=l[e+1];i[r]=t*d+s*u+h,i[r+1]=t*p+s*m+c}return}let c=0,d=0;for(let e=0;e<t;e+=2){let e=h[c];c+=e+1,d+=e}let u=r.bones;if(0==o.length)for(let e=n,t=3*d;e<s;e+=a){let s=0,n=0,a=h[c++];for(a+=c;c<a;c++,t+=3){let e=u[h[c]],i=l[t],a=l[t+1],r=l[t+2];s+=(i*e.a+a*e.b+e.worldX)*r,n+=(i*e.c+a*e.d+e.worldY)*r}i[e]=s,i[e+1]=n}else{let e=o;for(let t=n,r=3*d,o=d<<1;t<s;t+=a){let s=0,n=0,a=h[c++];for(a+=c;c<a;c++,r+=3,o+=2){let t=u[h[c]],i=l[r]+e[o],a=l[r+1]+e[o+1],d=l[r+2];s+=(i*t.a+a*t.b+t.worldX)*d,n+=(i*t.c+a*t.d+t.worldY)*d}i[t]=s,i[t+1]=n}}}copyTo(e){this.bones?(e.bones=new Array(this.bones.length),Me.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=Me.newFloatArray(this.vertices.length),Me.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment}}class _e{static _nextID=0;id=_e.nextID();regions;start=0;digits=0;setupIndex=0;constructor(e){this.regions=new Array(e)}copy(){let e=new _e(this.regions.length);return Me.arrayCopy(this.regions,0,e.regions,0,this.regions.length),e.start=this.start,e.digits=this.digits,e.setupIndex=this.setupIndex,e}apply(e,t){let s=e.sequenceIndex;-1==s&&(s=this.setupIndex),s>=this.regions.length&&(s=this.regions.length-1);let i=this.regions[s];t.region!=i&&(t.region=i,t.updateRegion())}getPath(e,t){let s=e,i=(this.start+t).toString();for(let e=this.digits-i.length;e>0;e--)s+="0";return s+=i,s}static nextID(){return _e._nextID++}}var Fe;!function(e){e[e.hold=0]="hold",e[e.once=1]="once",e[e.loop=2]="loop",e[e.pingpong=3]="pingpong",e[e.onceReverse=4]="onceReverse",e[e.loopReverse=5]="loopReverse",e[e.pingpongReverse=6]="pingpongReverse"}(Fe||(Fe={}));const De=[Fe.hold,Fe.once,Fe.loop,Fe.pingpong,Fe.onceReverse,Fe.loopReverse,Fe.pingpongReverse];class Ye{name;timelines=[];timelineIds=new Ee;duration;constructor(e,t,s){if(!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=s}setTimelines(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(var t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(e,t,s,i,n,a,r,o){if(!e)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(s%=this.duration,t>0&&(t%=this.duration));let l=this.timelines;for(let i=0,h=l.length;i<h;i++)l[i].apply(e,t,s,n,a,r,o)}}var Oe,Xe;!function(e){e[e.setup=0]="setup",e[e.first=1]="first",e[e.replace=2]="replace",e[e.add=3]="add"}(Oe||(Oe={})),function(e){e[e.mixIn=0]="mixIn",e[e.mixOut=1]="mixOut"}(Xe||(Xe={}));const Ve={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class Ne{propertyIds;frames;constructor(e,t){this.propertyIds=t,this.frames=Me.newFloatArray(e*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(e,t){let s=e.length;for(let i=1;i<s;i++)if(e[i]>t)return i-1;return s-1}static search(e,t,s){let i=e.length;for(let n=s;n<i;n+=s)if(e[n]>t)return n-s;return i-s}}class Ue extends Ne{curves;constructor(e,t,s){super(e,s),this.curves=Me.newFloatArray(e+18*t),this.curves[e-1]=1}setLinear(e){this.curves[e]=0}setStepped(e){this.curves[e]=1}shrink(e){let t=this.getFrameCount()+18*e;if(this.curves.length>t){let e=Me.newFloatArray(t);Me.arrayCopy(this.curves,0,e,0,t),this.curves=e}}setBezier(e,t,s,i,n,a,r,o,l,h,c){let d=this.curves,u=this.getFrameCount()+18*e;0==s&&(d[t]=2+u);let p=.03*(i-2*a+o),m=.03*(n-2*r+l),g=.006*(3*(a-o)-i+h),f=.006*(3*(r-l)-n+c),y=2*p+g,x=2*m+f,w=.3*(a-i)+p+.16666667*g,b=.3*(r-n)+m+.16666667*f,v=i+w,S=n+b;for(let e=u+18;u<e;u+=2)d[u]=v,d[u+1]=S,w+=y,b+=x,y+=g,x+=f,v+=w,S+=b}getBezierValue(e,t,s,i){let n=this.curves;if(n[i]>e){let a=this.frames[t],r=this.frames[t+s];return r+(e-a)/(n[i]-a)*(n[i+1]-r)}let a=i+18;for(i+=2;i<a;i+=2)if(n[i]>=e){let t=n[i-2],s=n[i-1];return s+(e-t)/(n[i]-t)*(n[i+1]-s)}t+=this.getFrameEntries();let r=n[a-2],o=n[a-1];return o+(e-r)/(this.frames[t]-r)*(this.frames[t+s]-o)}}class ze extends Ue{constructor(e,t,s){super(e,t,[s])}getFrameEntries(){return 2}setFrame(e,t,s){e<<=1,this.frames[e]=t,this.frames[e+1]=s}getCurveValue(e){let t=this.frames,s=t.length-2;for(let i=2;i<=s;i+=2)if(t[i]>e){s=i-2;break}let i=this.curves[s>>1];switch(i){case 0:let i=t[s],n=t[s+1];return n+(e-i)/(t[s+2]-i)*(t[s+2+1]-n);case 1:return t[s+1]}return this.getBezierValue(e,s,1,i-2)}getRelativeValue(e,t,s,i,n){if(e<this.frames[0]){switch(s){case Oe.setup:return n;case Oe.first:return i+(n-i)*t}return i}let a=this.getCurveValue(e);switch(s){case Oe.setup:return n+a*t;case Oe.first:case Oe.replace:a+=n-i}return i+a*t}getAbsoluteValue(e,t,s,i,n){if(e<this.frames[0]){switch(s){case Oe.setup:return n;case Oe.first:return i+(n-i)*t}return i}let a=this.getCurveValue(e);return s==Oe.setup?n+(a-n)*t:i+(a-i)*t}getAbsoluteValue2(e,t,s,i,n,a){if(e<this.frames[0]){switch(s){case Oe.setup:return n;case Oe.first:return i+(n-i)*t}return i}return s==Oe.setup?n+(a-n)*t:i+(a-i)*t}getScaleValue(e,t,s,i,n,a){if(e<this.frames[0]){switch(s){case Oe.setup:return a;case Oe.first:return n+(a-n)*t}return n}let r=this.getCurveValue(e)*a;if(1==t)return s==Oe.add?n+r-a:r;if(i==Xe.mixOut)switch(s){case Oe.setup:return a+(Math.abs(r)*Pe.signum(a)-a)*t;case Oe.first:case Oe.replace:return n+(Math.abs(r)*Pe.signum(n)-n)*t}else{let e=0;switch(s){case Oe.setup:return e=Math.abs(a)*Pe.signum(r),e+(r-e)*t;case Oe.first:case Oe.replace:return e=Math.abs(n)*Pe.signum(r),e+(r-e)*t}}return n+(r-a)*t}}class Ge extends Ue{constructor(e,t,s,i){super(e,t,[s,i])}getFrameEntries(){return 3}setFrame(e,t,s,i){e*=3,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i}}class We extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.rotate+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.rotation=this.getRelativeValue(s,n,a,o.rotation,o.data.rotation))}}class qe extends Ge{boneIndex=0;constructor(e,t,s){super(e,t,Ve.x+"|"+s,Ve.y+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];if(!o.active)return;let l=this.frames;if(s<l[0]){switch(a){case Oe.setup:return o.x=o.data.x,void(o.y=o.data.y);case Oe.first:o.x+=(o.data.x-o.x)*n,o.y+=(o.data.y-o.y)*n}return}let h=0,c=0,d=Ne.search(l,s,3),u=this.curves[d/3];switch(u){case 0:let e=l[d];h=l[d+1],c=l[d+2];let t=(s-e)/(l[d+3]-e);h+=(l[d+3+1]-h)*t,c+=(l[d+3+2]-c)*t;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}switch(a){case Oe.setup:o.x=o.data.x+h*n,o.y=o.data.y+c*n;break;case Oe.first:case Oe.replace:o.x+=(o.data.x+h-o.x)*n,o.y+=(o.data.y+c-o.y)*n;break;case Oe.add:o.x+=h*n,o.y+=c*n}}}class je extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.x+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.x=this.getRelativeValue(s,n,a,o.x,o.data.x))}}class He extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.y+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.y=this.getRelativeValue(s,n,a,o.y,o.data.y))}}class Je extends Ge{boneIndex=0;constructor(e,t,s){super(e,t,Ve.scaleX+"|"+s,Ve.scaleY+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];if(!o.active)return;let l,h,c=this.frames;if(s<c[0]){switch(a){case Oe.setup:return o.scaleX=o.data.scaleX,void(o.scaleY=o.data.scaleY);case Oe.first:o.scaleX+=(o.data.scaleX-o.scaleX)*n,o.scaleY+=(o.data.scaleY-o.scaleY)*n}return}let d=Ne.search(c,s,3),u=this.curves[d/3];switch(u){case 0:let e=c[d];l=c[d+1],h=c[d+2];let t=(s-e)/(c[d+3]-e);l+=(c[d+3+1]-l)*t,h+=(c[d+3+2]-h)*t;break;case 1:l=c[d+1],h=c[d+2];break;default:l=this.getBezierValue(s,d,1,u-2),h=this.getBezierValue(s,d,2,u+18-2)}if(l*=o.data.scaleX,h*=o.data.scaleY,1==n)a==Oe.add?(o.scaleX+=l-o.data.scaleX,o.scaleY+=h-o.data.scaleY):(o.scaleX=l,o.scaleY=h);else{let e=0,t=0;if(r==Xe.mixOut)switch(a){case Oe.setup:e=o.data.scaleX,t=o.data.scaleY,o.scaleX=e+(Math.abs(l)*Pe.signum(e)-e)*n,o.scaleY=t+(Math.abs(h)*Pe.signum(t)-t)*n;break;case Oe.first:case Oe.replace:e=o.scaleX,t=o.scaleY,o.scaleX=e+(Math.abs(l)*Pe.signum(e)-e)*n,o.scaleY=t+(Math.abs(h)*Pe.signum(t)-t)*n;break;case Oe.add:o.scaleX+=(l-o.data.scaleX)*n,o.scaleY+=(h-o.data.scaleY)*n}else switch(a){case Oe.setup:e=Math.abs(o.data.scaleX)*Pe.signum(l),t=Math.abs(o.data.scaleY)*Pe.signum(h),o.scaleX=e+(l-e)*n,o.scaleY=t+(h-t)*n;break;case Oe.first:case Oe.replace:e=Math.abs(o.scaleX)*Pe.signum(l),t=Math.abs(o.scaleY)*Pe.signum(h),o.scaleX=e+(l-e)*n,o.scaleY=t+(h-t)*n;break;case Oe.add:o.scaleX+=(l-o.data.scaleX)*n,o.scaleY+=(h-o.data.scaleY)*n}}}}class $e extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.scaleX+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.scaleX=this.getScaleValue(s,n,a,r,o.scaleX,o.data.scaleX))}}class Ke extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.scaleY+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.scaleY=this.getScaleValue(s,n,a,r,o.scaleY,o.data.scaleY))}}class Qe extends Ge{boneIndex=0;constructor(e,t,s){super(e,t,Ve.shearX+"|"+s,Ve.shearY+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];if(!o.active)return;let l=this.frames;if(s<l[0]){switch(a){case Oe.setup:return o.shearX=o.data.shearX,void(o.shearY=o.data.shearY);case Oe.first:o.shearX+=(o.data.shearX-o.shearX)*n,o.shearY+=(o.data.shearY-o.shearY)*n}return}let h=0,c=0,d=Ne.search(l,s,3),u=this.curves[d/3];switch(u){case 0:let e=l[d];h=l[d+1],c=l[d+2];let t=(s-e)/(l[d+3]-e);h+=(l[d+3+1]-h)*t,c+=(l[d+3+2]-c)*t;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}switch(a){case Oe.setup:o.shearX=o.data.shearX+h*n,o.shearY=o.data.shearY+c*n;break;case Oe.first:case Oe.replace:o.shearX+=(o.data.shearX+h-o.shearX)*n,o.shearY+=(o.data.shearY+c-o.shearY)*n;break;case Oe.add:o.shearX+=h*n,o.shearY+=c*n}}}class Ze extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.shearX+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.shearX=this.getRelativeValue(s,n,a,o.shearX,o.data.shearX))}}class et extends ze{boneIndex=0;constructor(e,t,s){super(e,t,Ve.shearY+"|"+s),this.boneIndex=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];o.active&&(o.shearY=this.getRelativeValue(s,n,a,o.shearY,o.data.shearY))}}class tt extends Ne{boneIndex=0;constructor(e,t){super(e,[Ve.inherit+"|"+t]),this.boneIndex=t}getFrameEntries(){return 2}setFrame(e,t,s){e*=2,this.frames[e]=t,this.frames[e+1]=s}apply(e,t,s,i,n,a,r){let o=e.bones[this.boneIndex];if(!o.active)return;if(r==Xe.mixOut)return void(a==Oe.setup&&(o.inherit=o.data.inherit));let l=this.frames;s<l[0]?a!=Oe.setup&&a!=Oe.first||(o.inherit=o.data.inherit):o.inherit=this.frames[Ne.search(l,s,2)+1]}}class st extends Ue{slotIndex=0;constructor(e,t,s){super(e,t,[Ve.rgb+"|"+s,Ve.alpha+"|"+s]),this.slotIndex=s}getFrameEntries(){return 5}setFrame(e,t,s,i,n,a){e*=5,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i,this.frames[e+3]=n,this.frames[e+4]=a}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames,h=o.color;if(s<l[0]){let e=o.data.color;switch(a){case Oe.setup:return void h.setFromColor(e);case Oe.first:h.add((e.r-h.r)*n,(e.g-h.g)*n,(e.b-h.b)*n,(e.a-h.a)*n)}return}let c=0,d=0,u=0,p=0,m=Ne.search(l,s,5),g=this.curves[m/5];switch(g){case 0:let e=l[m];c=l[m+1],d=l[m+2],u=l[m+3],p=l[m+4];let t=(s-e)/(l[m+5]-e);c+=(l[m+5+1]-c)*t,d+=(l[m+5+2]-d)*t,u+=(l[m+5+3]-u)*t,p+=(l[m+5+4]-p)*t;break;case 1:c=l[m+1],d=l[m+2],u=l[m+3],p=l[m+4];break;default:c=this.getBezierValue(s,m,1,g-2),d=this.getBezierValue(s,m,2,g+18-2),u=this.getBezierValue(s,m,3,g+36-2),p=this.getBezierValue(s,m,4,g+54-2)}1==n?h.set(c,d,u,p):(a==Oe.setup&&h.setFromColor(o.data.color),h.add((c-h.r)*n,(d-h.g)*n,(u-h.b)*n,(p-h.a)*n))}}class it extends Ue{slotIndex=0;constructor(e,t,s){super(e,t,[Ve.rgb+"|"+s]),this.slotIndex=s}getFrameEntries(){return 4}setFrame(e,t,s,i,n){e<<=2,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i,this.frames[e+3]=n}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames,h=o.color;if(s<l[0]){let e=o.data.color;switch(a){case Oe.setup:return h.r=e.r,h.g=e.g,void(h.b=e.b);case Oe.first:h.r+=(e.r-h.r)*n,h.g+=(e.g-h.g)*n,h.b+=(e.b-h.b)*n}return}let c=0,d=0,u=0,p=Ne.search(l,s,4),m=this.curves[p>>2];switch(m){case 0:let e=l[p];c=l[p+1],d=l[p+2],u=l[p+3];let t=(s-e)/(l[p+4]-e);c+=(l[p+4+1]-c)*t,d+=(l[p+4+2]-d)*t,u+=(l[p+4+3]-u)*t;break;case 1:c=l[p+1],d=l[p+2],u=l[p+3];break;default:c=this.getBezierValue(s,p,1,m-2),d=this.getBezierValue(s,p,2,m+18-2),u=this.getBezierValue(s,p,3,m+36-2)}if(1==n)h.r=c,h.g=d,h.b=u;else{if(a==Oe.setup){let e=o.data.color;h.r=e.r,h.g=e.g,h.b=e.b}h.r+=(c-h.r)*n,h.g+=(d-h.g)*n,h.b+=(u-h.b)*n}}}class nt extends ze{slotIndex=0;constructor(e,t,s){super(e,t,Ve.alpha+"|"+s),this.slotIndex=s}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=o.color;if(s<this.frames[0]){let e=o.data.color;switch(a){case Oe.setup:return void(l.a=e.a);case Oe.first:l.a+=(e.a-l.a)*n}return}let h=this.getCurveValue(s);1==n?l.a=h:(a==Oe.setup&&(l.a=o.data.color.a),l.a+=(h-l.a)*n)}}class at extends Ue{slotIndex=0;constructor(e,t,s){super(e,t,[Ve.rgb+"|"+s,Ve.alpha+"|"+s,Ve.rgb2+"|"+s]),this.slotIndex=s}getFrameEntries(){return 8}setFrame(e,t,s,i,n,a,r,o,l){e<<=3,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i,this.frames[e+3]=n,this.frames[e+4]=a,this.frames[e+5]=r,this.frames[e+6]=o,this.frames[e+7]=l}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames,h=o.color,c=o.darkColor;if(s<l[0]){let e=o.data.color,t=o.data.darkColor;switch(a){case Oe.setup:return h.setFromColor(e),c.r=t.r,c.g=t.g,void(c.b=t.b);case Oe.first:h.add((e.r-h.r)*n,(e.g-h.g)*n,(e.b-h.b)*n,(e.a-h.a)*n),c.r+=(t.r-c.r)*n,c.g+=(t.g-c.g)*n,c.b+=(t.b-c.b)*n}return}let d=0,u=0,p=0,m=0,g=0,f=0,y=0,x=Ne.search(l,s,8),w=this.curves[x>>3];switch(w){case 0:let e=l[x];d=l[x+1],u=l[x+2],p=l[x+3],m=l[x+4],g=l[x+5],f=l[x+6],y=l[x+7];let t=(s-e)/(l[x+8]-e);d+=(l[x+8+1]-d)*t,u+=(l[x+8+2]-u)*t,p+=(l[x+8+3]-p)*t,m+=(l[x+8+4]-m)*t,g+=(l[x+8+5]-g)*t,f+=(l[x+8+6]-f)*t,y+=(l[x+8+7]-y)*t;break;case 1:d=l[x+1],u=l[x+2],p=l[x+3],m=l[x+4],g=l[x+5],f=l[x+6],y=l[x+7];break;default:d=this.getBezierValue(s,x,1,w-2),u=this.getBezierValue(s,x,2,w+18-2),p=this.getBezierValue(s,x,3,w+36-2),m=this.getBezierValue(s,x,4,w+54-2),g=this.getBezierValue(s,x,5,w+72-2),f=this.getBezierValue(s,x,6,w+90-2),y=this.getBezierValue(s,x,7,w+108-2)}if(1==n)h.set(d,u,p,m),c.r=g,c.g=f,c.b=y;else{if(a==Oe.setup){h.setFromColor(o.data.color);let e=o.data.darkColor;c.r=e.r,c.g=e.g,c.b=e.b}h.add((d-h.r)*n,(u-h.g)*n,(p-h.b)*n,(m-h.a)*n),c.r+=(g-c.r)*n,c.g+=(f-c.g)*n,c.b+=(y-c.b)*n}}}class rt extends Ue{slotIndex=0;constructor(e,t,s){super(e,t,[Ve.rgb+"|"+s,Ve.rgb2+"|"+s]),this.slotIndex=s}getFrameEntries(){return 7}setFrame(e,t,s,i,n,a,r,o){e*=7,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i,this.frames[e+3]=n,this.frames[e+4]=a,this.frames[e+5]=r,this.frames[e+6]=o}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames,h=o.color,c=o.darkColor;if(s<l[0]){let e=o.data.color,t=o.data.darkColor;switch(a){case Oe.setup:return h.r=e.r,h.g=e.g,h.b=e.b,c.r=t.r,c.g=t.g,void(c.b=t.b);case Oe.first:h.r+=(e.r-h.r)*n,h.g+=(e.g-h.g)*n,h.b+=(e.b-h.b)*n,c.r+=(t.r-c.r)*n,c.g+=(t.g-c.g)*n,c.b+=(t.b-c.b)*n}return}let d=0,u=0,p=0,m=0,g=0,f=0,y=Ne.search(l,s,7),x=this.curves[y/7];switch(x){case 0:let e=l[y];d=l[y+1],u=l[y+2],p=l[y+3],m=l[y+4],g=l[y+5],f=l[y+6];let t=(s-e)/(l[y+7]-e);d+=(l[y+7+1]-d)*t,u+=(l[y+7+2]-u)*t,p+=(l[y+7+3]-p)*t,m+=(l[y+7+4]-m)*t,g+=(l[y+7+5]-g)*t,f+=(l[y+7+6]-f)*t;break;case 1:d=l[y+1],u=l[y+2],p=l[y+3],m=l[y+4],g=l[y+5],f=l[y+6];break;default:d=this.getBezierValue(s,y,1,x-2),u=this.getBezierValue(s,y,2,x+18-2),p=this.getBezierValue(s,y,3,x+36-2),m=this.getBezierValue(s,y,4,x+54-2),g=this.getBezierValue(s,y,5,x+72-2),f=this.getBezierValue(s,y,6,x+90-2)}if(1==n)h.r=d,h.g=u,h.b=p,c.r=m,c.g=g,c.b=f;else{if(a==Oe.setup){let e=o.data.color,t=o.data.darkColor;h.r=e.r,h.g=e.g,h.b=e.b,c.r=t.r,c.g=t.g,c.b=t.b}h.r+=(d-h.r)*n,h.g+=(u-h.g)*n,h.b+=(p-h.b)*n,c.r+=(m-c.r)*n,c.g+=(g-c.g)*n,c.b+=(f-c.b)*n}}}class ot extends Ne{slotIndex=0;attachmentNames;constructor(e,t){super(e,[Ve.attachment+"|"+t]),this.slotIndex=t,this.attachmentNames=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.attachmentNames[e]=s}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];o.bone.active&&(r!=Xe.mixOut?s<this.frames[0]?a!=Oe.setup&&a!=Oe.first||this.setAttachment(e,o,o.data.attachmentName):this.setAttachment(e,o,this.attachmentNames[Ne.search1(this.frames,s)]):a==Oe.setup&&this.setAttachment(e,o,o.data.attachmentName))}setAttachment(e,t,s){t.setAttachment(s?e.getAttachment(this.slotIndex,s):null)}}class lt extends Ue{slotIndex=0;attachment;vertices;constructor(e,t,s,i){super(e,t,[Ve.deform+"|"+s+"|"+i.id]),this.slotIndex=s,this.attachment=i,this.vertices=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.vertices[e]=s}setBezier(e,t,s,i,n,a,r,o,l,h,c){let d=this.curves,u=this.getFrameCount()+18*e;0==s&&(d[t]=2+u);let p=.03*(i-2*a+o),m=.03*l-.06*r,g=.006*(3*(a-o)-i+h),f=.018*(r-l+.33333333),y=2*p+g,x=2*m+f,w=.3*(a-i)+p+.16666667*g,b=.3*r+m+.16666667*f,v=i+w,S=b;for(let e=u+18;u<e;u+=2)d[u]=v,d[u+1]=S,w+=y,b+=x,y+=g,x+=f,v+=w,S+=b}getCurvePercent(e,t){let s=this.curves,i=s[t];switch(i){case 0:let s=this.frames[t];return(e-s)/(this.frames[t+this.getFrameEntries()]-s);case 1:return 0}if(i-=2,s[i]>e){let n=this.frames[t];return s[i+1]*(e-n)/(s[i]-n)}let n=i+18;for(i+=2;i<n;i+=2)if(s[i]>=e){let t=s[i-2],n=s[i-1];return n+(e-t)/(s[i]-t)*(s[i+1]-n)}let a=s[n-2],r=s[n-1];return r+(1-r)*(e-a)/(this.frames[t+this.getFrameEntries()]-a)}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=o.getAttachment();if(!l)return;if(!(l instanceof Le)||l.timelineAttachment!=this.attachment)return;let h=o.deform;0==h.length&&(a=Oe.setup);let c=this.vertices,d=c[0].length,u=this.frames;if(s<u[0]){switch(a){case Oe.setup:return void(h.length=0);case Oe.first:if(1==n)return void(h.length=0);h.length=d;let e=l;if(e.bones)for(n=1-n,p=0;p<d;p++)h[p]*=n;else{let t=e.vertices;for(var p=0;p<d;p++)h[p]+=(t[p]-h[p])*n}}return}if(h.length=d,s>=u[u.length-1]){let e=c[u.length-1];if(1==n)if(a==Oe.add){let t=l;if(t.bones)for(let t=0;t<d;t++)h[t]+=e[t];else{let s=t.vertices;for(let t=0;t<d;t++)h[t]+=e[t]-s[t]}}else Me.arrayCopy(e,0,h,0,d);else switch(a){case Oe.setup:{let t=l;if(t.bones)for(let t=0;t<d;t++)h[t]=e[t]*n;else{let s=t.vertices;for(let t=0;t<d;t++){let i=s[t];h[t]=i+(e[t]-i)*n}}break}case Oe.first:case Oe.replace:for(let t=0;t<d;t++)h[t]+=(e[t]-h[t])*n;break;case Oe.add:let t=l;if(t.bones)for(let t=0;t<d;t++)h[t]+=e[t]*n;else{let s=t.vertices;for(let t=0;t<d;t++)h[t]+=(e[t]-s[t])*n}}return}let m=Ne.search1(u,s),g=this.getCurvePercent(s,m),f=c[m],y=c[m+1];if(1==n)if(a==Oe.add){let e=l;if(e.bones)for(let e=0;e<d;e++){let t=f[e];h[e]+=t+(y[e]-t)*g}else{let t=e.vertices;for(let e=0;e<d;e++){let s=f[e];h[e]+=s+(y[e]-s)*g-t[e]}}}else for(let e=0;e<d;e++){let t=f[e];h[e]=t+(y[e]-t)*g}else switch(a){case Oe.setup:{let e=l;if(e.bones)for(let e=0;e<d;e++){let t=f[e];h[e]=(t+(y[e]-t)*g)*n}else{let t=e.vertices;for(let e=0;e<d;e++){let s=f[e],i=t[e];h[e]=i+(s+(y[e]-s)*g-i)*n}}break}case Oe.first:case Oe.replace:for(let e=0;e<d;e++){let t=f[e];h[e]+=(t+(y[e]-t)*g-h[e])*n}break;case Oe.add:let e=l;if(e.bones)for(let e=0;e<d;e++){let t=f[e];h[e]+=(t+(y[e]-t)*g)*n}else{let t=e.vertices;for(let e=0;e<d;e++){let s=f[e];h[e]+=(s+(y[e]-s)*g-t[e])*n}}}}}class ht extends Ne{static propertyIds=[""+Ve.event];events;constructor(e){super(e,ht.propertyIds),this.events=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t){this.frames[e]=t.time,this.events[e]=t}apply(e,t,s,i,n,a,r){if(!i)return;let o=this.frames,l=this.frames.length;if(t>s)this.apply(e,t,Number.MAX_VALUE,i,n,a,r),t=-1;else if(t>=o[l-1])return;if(s<o[0])return;let h=0;if(t<o[0])h=0;else{h=Ne.search1(o,t)+1;let e=o[h];for(;h>0&&o[h-1]==e;)h--}for(;h<l&&s>=o[h];h++)i.push(this.events[h])}}class ct extends Ne{static propertyIds=[""+Ve.drawOrder];drawOrders;constructor(e){super(e,ct.propertyIds),this.drawOrders=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.drawOrders[e]=s}apply(e,t,s,i,n,a,r){if(r==Xe.mixOut)return void(a==Oe.setup&&Me.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length));if(s<this.frames[0])return void(a!=Oe.setup&&a!=Oe.first||Me.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length));let o=Ne.search1(this.frames,s),l=this.drawOrders[o];if(l){let t=e.drawOrder,s=e.slots;for(let e=0,i=l.length;e<i;e++)t[e]=s[l[e]]}else Me.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)}}class dt extends Ue{constraintIndex=0;constructor(e,t,s){super(e,t,[Ve.ikConstraint+"|"+s]),this.constraintIndex=s}getFrameEntries(){return 6}setFrame(e,t,s,i,n,a,r){e*=6,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i,this.frames[e+3]=n,this.frames[e+4]=a?1:0,this.frames[e+5]=r?1:0}apply(e,t,s,i,n,a,r){let o=e.ikConstraints[this.constraintIndex];if(!o.active)return;let l=this.frames;if(s<l[0]){switch(a){case Oe.setup:return o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,void(o.stretch=o.data.stretch);case Oe.first:o.mix+=(o.data.mix-o.mix)*n,o.softness+=(o.data.softness-o.softness)*n,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let h=0,c=0,d=Ne.search(l,s,6),u=this.curves[d/6];switch(u){case 0:let e=l[d];h=l[d+1],c=l[d+2];let t=(s-e)/(l[d+6]-e);h+=(l[d+6+1]-h)*t,c+=(l[d+6+2]-c)*t;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}a==Oe.setup?(o.mix=o.data.mix+(h-o.data.mix)*n,o.softness=o.data.softness+(c-o.data.softness)*n,r==Xe.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[d+3],o.compress=0!=l[d+4],o.stretch=0!=l[d+5])):(o.mix+=(h-o.mix)*n,o.softness+=(c-o.softness)*n,r==Xe.mixIn&&(o.bendDirection=l[d+3],o.compress=0!=l[d+4],o.stretch=0!=l[d+5]))}}class ut extends Ue{constraintIndex=0;constructor(e,t,s){super(e,t,[Ve.transformConstraint+"|"+s]),this.constraintIndex=s}getFrameEntries(){return 7}setFrame(e,t,s,i,n,a,r,o){let l=this.frames;l[e*=7]=t,l[e+1]=s,l[e+2]=i,l[e+3]=n,l[e+4]=a,l[e+5]=r,l[e+6]=o}apply(e,t,s,i,n,a,r){let o=e.transformConstraints[this.constraintIndex];if(!o.active)return;let l,h,c,d,u,p,m=this.frames;if(s<m[0]){let e=o.data;switch(a){case Oe.setup:return o.mixRotate=e.mixRotate,o.mixX=e.mixX,o.mixY=e.mixY,o.mixScaleX=e.mixScaleX,o.mixScaleY=e.mixScaleY,void(o.mixShearY=e.mixShearY);case Oe.first:o.mixRotate+=(e.mixRotate-o.mixRotate)*n,o.mixX+=(e.mixX-o.mixX)*n,o.mixY+=(e.mixY-o.mixY)*n,o.mixScaleX+=(e.mixScaleX-o.mixScaleX)*n,o.mixScaleY+=(e.mixScaleY-o.mixScaleY)*n,o.mixShearY+=(e.mixShearY-o.mixShearY)*n}return}let g=Ne.search(m,s,7),f=this.curves[g/7];switch(f){case 0:let e=m[g];l=m[g+1],h=m[g+2],c=m[g+3],d=m[g+4],u=m[g+5],p=m[g+6];let t=(s-e)/(m[g+7]-e);l+=(m[g+7+1]-l)*t,h+=(m[g+7+2]-h)*t,c+=(m[g+7+3]-c)*t,d+=(m[g+7+4]-d)*t,u+=(m[g+7+5]-u)*t,p+=(m[g+7+6]-p)*t;break;case 1:l=m[g+1],h=m[g+2],c=m[g+3],d=m[g+4],u=m[g+5],p=m[g+6];break;default:l=this.getBezierValue(s,g,1,f-2),h=this.getBezierValue(s,g,2,f+18-2),c=this.getBezierValue(s,g,3,f+36-2),d=this.getBezierValue(s,g,4,f+54-2),u=this.getBezierValue(s,g,5,f+72-2),p=this.getBezierValue(s,g,6,f+90-2)}if(a==Oe.setup){let e=o.data;o.mixRotate=e.mixRotate+(l-e.mixRotate)*n,o.mixX=e.mixX+(h-e.mixX)*n,o.mixY=e.mixY+(c-e.mixY)*n,o.mixScaleX=e.mixScaleX+(d-e.mixScaleX)*n,o.mixScaleY=e.mixScaleY+(u-e.mixScaleY)*n,o.mixShearY=e.mixShearY+(p-e.mixShearY)*n}else o.mixRotate+=(l-o.mixRotate)*n,o.mixX+=(h-o.mixX)*n,o.mixY+=(c-o.mixY)*n,o.mixScaleX+=(d-o.mixScaleX)*n,o.mixScaleY+=(u-o.mixScaleY)*n,o.mixShearY+=(p-o.mixShearY)*n}}class pt extends ze{constraintIndex=0;constructor(e,t,s){super(e,t,Ve.pathConstraintPosition+"|"+s),this.constraintIndex=s}apply(e,t,s,i,n,a,r){let o=e.pathConstraints[this.constraintIndex];o.active&&(o.position=this.getAbsoluteValue(s,n,a,o.position,o.data.position))}}class mt extends ze{constraintIndex=0;constructor(e,t,s){super(e,t,Ve.pathConstraintSpacing+"|"+s),this.constraintIndex=s}apply(e,t,s,i,n,a,r){let o=e.pathConstraints[this.constraintIndex];o.active&&(o.spacing=this.getAbsoluteValue(s,n,a,o.spacing,o.data.spacing))}}class gt extends Ue{constraintIndex=0;constructor(e,t,s){super(e,t,[Ve.pathConstraintMix+"|"+s]),this.constraintIndex=s}getFrameEntries(){return 4}setFrame(e,t,s,i,n){let a=this.frames;a[e<<=2]=t,a[e+1]=s,a[e+2]=i,a[e+3]=n}apply(e,t,s,i,n,a,r){let o=e.pathConstraints[this.constraintIndex];if(!o.active)return;let l,h,c,d=this.frames;if(s<d[0]){switch(a){case Oe.setup:return o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,void(o.mixY=o.data.mixY);case Oe.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*n,o.mixX+=(o.data.mixX-o.mixX)*n,o.mixY+=(o.data.mixY-o.mixY)*n}return}let u=Ne.search(d,s,4),p=this.curves[u>>2];switch(p){case 0:let e=d[u];l=d[u+1],h=d[u+2],c=d[u+3];let t=(s-e)/(d[u+4]-e);l+=(d[u+4+1]-l)*t,h+=(d[u+4+2]-h)*t,c+=(d[u+4+3]-c)*t;break;case 1:l=d[u+1],h=d[u+2],c=d[u+3];break;default:l=this.getBezierValue(s,u,1,p-2),h=this.getBezierValue(s,u,2,p+18-2),c=this.getBezierValue(s,u,3,p+36-2)}if(a==Oe.setup){let e=o.data;o.mixRotate=e.mixRotate+(l-e.mixRotate)*n,o.mixX=e.mixX+(h-e.mixX)*n,o.mixY=e.mixY+(c-e.mixY)*n}else o.mixRotate+=(l-o.mixRotate)*n,o.mixX+=(h-o.mixX)*n,o.mixY+=(c-o.mixY)*n}}class ft extends ze{constraintIndex=0;constructor(e,t,s,i){super(e,t,i+"|"+s),this.constraintIndex=s}apply(e,t,s,i,n,a,r){let o;if(-1==this.constraintIndex){const t=s>=this.frames[0]?this.getCurveValue(s):0;for(const i of e.physicsConstraints)i.active&&this.global(i.data)&&this.set(i,this.getAbsoluteValue2(s,n,a,this.get(i),this.setup(i),t))}else o=e.physicsConstraints[this.constraintIndex],o.active&&this.set(o,this.getAbsoluteValue(s,n,a,this.get(o),this.setup(o)))}}class yt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintInertia)}setup(e){return e.data.inertia}get(e){return e.inertia}set(e,t){e.inertia=t}global(e){return e.inertiaGlobal}}class xt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintStrength)}setup(e){return e.data.strength}get(e){return e.strength}set(e,t){e.strength=t}global(e){return e.strengthGlobal}}class wt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintDamping)}setup(e){return e.data.damping}get(e){return e.damping}set(e,t){e.damping=t}global(e){return e.dampingGlobal}}class bt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintMass)}setup(e){return 1/e.data.massInverse}get(e){return 1/e.massInverse}set(e,t){e.massInverse=1/t}global(e){return e.massGlobal}}class vt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintWind)}setup(e){return e.data.wind}get(e){return e.wind}set(e,t){e.wind=t}global(e){return e.windGlobal}}class St extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintGravity)}setup(e){return e.data.gravity}get(e){return e.gravity}set(e,t){e.gravity=t}global(e){return e.gravityGlobal}}class kt extends ft{constructor(e,t,s){super(e,t,s,Ve.physicsConstraintMix)}setup(e){return e.data.mix}get(e){return e.mix}set(e,t){e.mix=t}global(e){return e.mixGlobal}}class It extends Ne{static propertyIds=[Ve.physicsConstraintReset.toString()];constraintIndex;constructor(e,t){super(e,It.propertyIds),this.constraintIndex=t}getFrameCount(){return this.frames.length}setFrame(e,t){this.frames[e]=t}apply(e,t,s,i,n,a,r){let o;if(-1!=this.constraintIndex&&(o=e.physicsConstraints[this.constraintIndex],!o.active))return;const l=this.frames;if(t>s)this.apply(e,t,Number.MAX_VALUE,[],n,a,r),t=-1;else if(t>=l[l.length-1])return;if(!(s<l[0])&&(t<l[0]||s>=l[Ne.search1(l,t)+1]))if(null!=o)o.reset();else for(const t of e.physicsConstraints)t.active&&t.reset()}}class At extends Ne{static ENTRIES=3;static MODE=1;static DELAY=2;slotIndex;attachment;constructor(e,t,s){super(e,[Ve.sequence+"|"+t+"|"+s.sequence.id]),this.slotIndex=t,this.attachment=s}getFrameEntries(){return At.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(e,t,s,i,n){let a=this.frames;a[e*=At.ENTRIES]=t,a[e+At.MODE]=s|i<<4,a[e+At.DELAY]=n}apply(e,t,s,i,n,a,r){let o=e.slots[this.slotIndex];if(!o.bone.active)return;let l=o.attachment,h=this.attachment;if(!(l==h||l instanceof Le&&l.timelineAttachment==h))return;if(r==Xe.mixOut)return void(a==Oe.setup&&(o.sequenceIndex=-1));let c=this.frames;if(s<c[0])return void(a!=Oe.setup&&a!=Oe.first||(o.sequenceIndex=-1));let d=Ne.search(c,s,At.ENTRIES),u=c[d],p=c[d+At.MODE],m=c[d+At.DELAY];if(!this.attachment.sequence)return;let g=p>>4,f=this.attachment.sequence.regions.length,y=De[15&p];if(y!=Fe.hold)switch(g+=(s-u)/m+1e-5|0,y){case Fe.once:g=Math.min(f-1,g);break;case Fe.loop:g%=f;break;case Fe.pingpong:{let e=(f<<1)-2;g=0==e?0:g%e,g>=f&&(g=e-g);break}case Fe.onceReverse:g=Math.max(f-1-g,0);break;case Fe.loopReverse:g=f-1-g%f;break;case Fe.pingpongReverse:{let e=(f<<1)-2;g=0==e?0:(g+f-1)%e,g>=f&&(g=e-g)}}o.sequenceIndex=g}}class Et{static _emptyAnimation=new Ye("<empty>",[],0);static emptyAnimation(){return Et._emptyAnimation}data;tracks=new Array;timeScale=1;unkeyedState=0;events=new Array;listeners=new Array;queue=new Pt(this);propertyIDs=new Ee;animationsChanged=!1;trackEntryPool=new Te((()=>new Ct));constructor(e){this.data=e}update(e){e*=this.timeScale;let t=this.tracks;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(!i)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let n=e*i.timeScale;if(i.delay>0){if(i.delay-=n,i.delay>0)continue;n=-i.delay,i.delay=0}let a=i.next;if(a){let t=i.trackLast-a.delay;if(t>=0){for(a.delay=0,a.trackTime+=0==i.timeScale?0:(t/i.timeScale+e)*a.timeScale,i.trackTime+=n,this.setCurrent(s,a,!0);a.mixingFrom;)a.mixTime+=e,a=a.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&!i.mixingFrom){t[s]=null,this.queue.end(i),this.clearNext(i);continue}if(i.mixingFrom&&this.updateMixingFrom(i,e)){let e=i.mixingFrom;for(i.mixingFrom=null,e&&(e.mixingTo=null);e;)this.queue.end(e),e=e.mixingFrom}i.trackTime+=n}this.queue.drain()}updateMixingFrom(e,t){let s=e.mixingFrom;if(!s)return!0;let i=this.updateMixingFrom(s,t);if(s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,-1!=e.nextTrackLast){const t=0==e.mixTime&&0==s.mixTime;if(e.mixTime>=e.mixDuration||t)return(0==s.totalAlpha||0==e.mixDuration||t)&&(e.mixingFrom=s.mixingFrom,null!=s.mixingFrom&&(s.mixingFrom.mixingTo=e),e.interruptAlpha=s.interruptAlpha,this.queue.end(s)),i}return s.trackTime+=t*s.timeScale,e.mixTime+=t,!1}apply(e){if(!e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,s=this.tracks,i=!1;for(let a=0,r=s.length;a<r;a++){let r=s[a];if(!r||r.delay>0)continue;i=!0;let o=0==a?Oe.first:r.mixBlend,l=r.alpha;r.mixingFrom?l*=this.applyMixingFrom(r,e,o):r.trackTime>=r.trackEnd&&!r.next&&(l=0);let h=l>=r.alphaAttachmentThreshold,c=r.animationLast,d=r.getAnimationTime(),u=d,p=t;r.reverse&&(u=r.animation.duration-u,p=null);let m=r.animation.timelines,g=m.length;if(0==a&&1==l||o==Oe.add){0==a&&(h=!0);for(let t=0;t<g;t++){Me.webkit602BugfixHelper(l,o);var n=m[t];n instanceof ot?this.applyAttachmentTimeline(n,e,u,o,h):n.apply(e,c,u,p,l,o,Xe.mixIn)}}else{let t=r.timelineMode,s=r.shortestRotation,i=!s&&r.timelinesRotation.length!=g<<1;i&&(r.timelinesRotation.length=g<<1);for(let n=0;n<g;n++){let a=m[n],d=t[n]==Tt?o:Oe.setup;!s&&a instanceof We?this.applyRotateTimeline(a,e,u,l,d,r.timelinesRotation,n<<1,i):a instanceof ot?this.applyAttachmentTimeline(a,e,u,o,h):(Me.webkit602BugfixHelper(l,o),a.apply(e,c,u,p,l,d,Xe.mixIn))}}this.queueEvents(r,d),t.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime}for(var a=this.unkeyedState+Ft,r=e.slots,o=0,l=e.slots.length;o<l;o++){var h=r[o];if(h.attachmentState==a){var c=h.data.attachmentName;h.setAttachment(c?e.getAttachment(h.data.index,c):null)}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(e,t,s){let i=e.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,t,s);let n=0;0==e.mixDuration?(n=1,s==Oe.first&&(s=Oe.setup)):(n=e.mixTime/e.mixDuration,n>1&&(n=1),s!=Oe.first&&(s=i.mixBlend));let a=n<i.mixAttachmentThreshold,r=n<i.mixDrawOrderThreshold,o=i.animation.timelines,l=o.length,h=i.alpha*e.interruptAlpha,c=h*(1-n),d=i.animationLast,u=i.getAnimationTime(),p=u,m=null;if(i.reverse?p=i.animation.duration-p:n<i.eventThreshold&&(m=this.events),s==Oe.add)for(let e=0;e<l;e++)o[e].apply(t,d,p,m,c,s,Xe.mixOut);else{let e=i.timelineMode,n=i.timelineHoldMix,u=i.shortestRotation,g=!u&&i.timelinesRotation.length!=l<<1;g&&(i.timelinesRotation.length=l<<1),i.totalAlpha=0;for(let f=0;f<l;f++){let l,y=o[f],x=Xe.mixOut,w=0;switch(e[f]){case Tt:if(!r&&y instanceof ct)continue;l=s,w=c;break;case Rt:l=Oe.setup,w=c;break;case Bt:l=s,w=h;break;case Lt:l=Oe.setup,w=h;break;default:l=Oe.setup;let e=n[f];w=h*Math.max(0,1-e.mixTime/e.mixDuration)}i.totalAlpha+=w,!u&&y instanceof We?this.applyRotateTimeline(y,t,p,w,l,i.timelinesRotation,f<<1,g):y instanceof ot?this.applyAttachmentTimeline(y,t,p,l,a&&w>=i.alphaAttachmentThreshold):(Me.webkit602BugfixHelper(w,s),r&&y instanceof ct&&l==Oe.setup&&(x=Xe.mixIn),y.apply(t,d,p,m,w,l,x))}}return e.mixDuration>0&&this.queueEvents(i,u),this.events.length=0,i.nextAnimationLast=u,i.nextTrackLast=i.trackTime,n}applyAttachmentTimeline(e,t,s,i,n){var a=t.slots[e.slotIndex];a.bone.active&&(s<e.frames[0]?i!=Oe.setup&&i!=Oe.first||this.setAttachment(t,a,a.data.attachmentName,n):this.setAttachment(t,a,e.attachmentNames[Ne.search1(e.frames,s)],n),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+Ft))}setAttachment(e,t,s,i){t.setAttachment(s?e.getAttachment(t.data.index,s):null),i&&(t.attachmentState=this.unkeyedState+Dt)}applyRotateTimeline(e,t,s,i,n,a,r,o){if(o&&(a[r]=0),1==i)return void e.apply(t,0,s,null,1,n,Xe.mixIn);let l=t.bones[e.boneIndex];if(!l.active)return;let h=0,c=0;if(s<e.frames[0])switch(n){case Oe.setup:l.rotation=l.data.rotation;default:return;case Oe.first:h=l.rotation,c=l.data.rotation}else h=n==Oe.setup?l.data.rotation:l.rotation,c=l.data.rotation+e.getCurveValue(s);let d=0,u=c-h;if(u-=360*Math.ceil(u/360-.5),0==u)d=a[r];else{let e=0,t=0;o?(e=0,t=u):(e=a[r],t=a[r+1]);let s=e-e%360;d=u+s;let i=u>=0,n=e>=0;Math.abs(t)<=90&&Pe.signum(t)!=Pe.signum(u)&&(Math.abs(e-s)>180?(d+=360*Pe.signum(e),n=i):0!=s?d-=360*Pe.signum(e):n=i),n!=i&&(d+=360*Pe.signum(e)),a[r]=d}a[r+1]=u,l.rotation=h+d*i}queueEvents(e,t){let s=e.animationStart,i=e.animationEnd,n=i-s,a=e.trackLast%n,r=this.events,o=0,l=r.length;for(;o<l;o++){let t=r[o];if(t.time<a)break;t.time>i||this.queue.event(e,t)}let h=!1;if(e.loop)if(0==n)h=!0;else{const t=Math.floor(e.trackTime/n);h=t>0&&t>Math.floor(e.trackLast/n)}else h=t>=i&&e.animationLast<i;for(h&&this.queue.complete(e);o<l;o++){let t=r[o];t.time<s||this.queue.event(e,t)}}clearTracks(){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,t=this.tracks.length;e<t;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=e,this.queue.drain()}clearTrack(e){if(e>=this.tracks.length)return;let t=this.tracks[e];if(!t)return;this.queue.end(t),this.clearNext(t);let s=t;for(;;){let e=s.mixingFrom;if(!e)break;this.queue.end(e),s.mixingFrom=null,s.mixingTo=null,s=e}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(e,t,s){let i=this.expandToIndex(e);this.tracks[e]=t,t.previous=null,i&&(s&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(e,t,s=!1){let i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);return this.setAnimationWith(e,i,s)}setAnimationWith(e,t,s=!1){if(!t)throw new Error("animation cannot be null.");let i=!0,n=this.expandToIndex(e);n&&(-1==n.nextTrackLast?(this.tracks[e]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,i=!1):this.clearNext(n));let a=this.trackEntry(e,t,s,n);return this.setCurrent(e,a,i),this.queue.drain(),a}addAnimation(e,t,s=!1,i=0){let n=this.data.skeletonData.findAnimation(t);if(!n)throw new Error("Animation not found: "+t);return this.addAnimationWith(e,n,s,i)}addAnimationWith(e,t,s=!1,i=0){if(!t)throw new Error("animation cannot be null.");let n=this.expandToIndex(e);if(n)for(;n.next;)n=n.next;let a=this.trackEntry(e,t,s,n);return n?(n.next=a,a.previous=n,i<=0&&(i+=n.getTrackComplete()-a.mixDuration)):(this.setCurrent(e,a,!0),this.queue.drain()),a.delay=i,a}setEmptyAnimation(e,t=0){let s=this.setAnimationWith(e,Et.emptyAnimation(),!1);return s.mixDuration=t,s.trackEnd=t,s}addEmptyAnimation(e,t=0,s=0){let i=this.addAnimationWith(e,Et.emptyAnimation(),!1,s);return s<=0&&(i.delay+=i.mixDuration-t),i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(e=0){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,s=this.tracks.length;t<s;t++){let s=this.tracks[t];s&&this.setEmptyAnimation(s.trackIndex,e)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(e){return e<this.tracks.length?this.tracks[e]:(Me.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)}trackEntry(e,t,s,i){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=e,n.animation=t,n.loop=s,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.alphaAttachmentThreshold=0,n.mixAttachmentThreshold=0,n.mixDrawOrderThreshold=0,n.animationStart=0,n.animationEnd=t.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=i?this.data.getMix(i.animation,t):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=Oe.replace,n}clearNext(e){let t=e.next;for(;t;)this.queue.dispose(t),t=t.next;e.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let e=this.tracks;for(let t=0,s=e.length;t<s;t++){let s=e[t];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do{s.mixingTo&&s.mixBlend==Oe.add||this.computeHold(s),s=s.mixingTo}while(s)}}}computeHold(e){let t=e.mixingTo,s=e.animation.timelines,i=e.animation.timelines.length,n=e.timelineMode;n.length=i;let a=e.timelineHoldMix;a.length=0;let r=this.propertyIDs;if(t&&t.holdPrevious)for(let e=0;e<i;e++)n[e]=r.addAll(s[e].getPropertyIds())?Lt:Bt;else e:for(let o=0;o<i;o++){let i=s[o],l=i.getPropertyIds();if(r.addAll(l))if(!t||i instanceof ot||i instanceof ct||i instanceof ht||!t.animation.hasTimeline(l))n[o]=Rt;else{for(let s=t.mixingTo;s;s=s.mixingTo)if(!s.animation.hasTimeline(l)){if(e.mixDuration>0){n[o]=_t,a[o]=s;continue e}break}n[o]=Lt}else n[o]=Tt}}getCurrent(e){return e>=this.tracks.length?null:this.tracks[e]}addListener(e){if(!e)throw new Error("listener cannot be null.");this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class Ct{animation=null;previous=null;next=null;mixingFrom=null;mixingTo=null;listener=null;trackIndex=0;loop=!1;holdPrevious=!1;reverse=!1;shortestRotation=!1;eventThreshold=0;mixAttachmentThreshold=0;alphaAttachmentThreshold=0;mixDrawOrderThreshold=0;animationStart=0;animationEnd=0;animationLast=0;nextAnimationLast=0;delay=0;trackTime=0;trackLast=0;nextTrackLast=0;trackEnd=0;timeScale=0;alpha=0;mixTime=0;_mixDuration=0;interruptAlpha=0;totalAlpha=0;get mixDuration(){return this._mixDuration}set mixDuration(e){this._mixDuration=e}setMixDurationWithDelay(e,t){this._mixDuration=e,null!=this.previous&&t<=0&&(t+=this.previous.getTrackComplete()-e),this.delay=t}mixBlend=Oe.replace;timelineMode=new Array;timelineHoldMix=new Array;timelinesRotation=new Array;reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let e=this.animationEnd-this.animationStart;return 0==e?this.animationStart:this.trackTime%e+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(e){this.animationLast=e,this.nextAnimationLast=e}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let e=this.animationEnd-this.animationStart;if(0!=e){if(this.loop)return e*(1+(this.trackTime/e|0));if(this.trackTime<e)return e}return this.trackTime}wasApplied(){return-1!=this.nextTrackLast}isNextReady(){return null!=this.next&&this.nextTrackLast-this.next.delay>=0}}class Pt{objects=[];drainDisabled=!1;animState;constructor(e){this.animState=e}start(e){this.objects.push(Mt.start),this.objects.push(e),this.animState.animationsChanged=!0}interrupt(e){this.objects.push(Mt.interrupt),this.objects.push(e)}end(e){this.objects.push(Mt.end),this.objects.push(e),this.animState.animationsChanged=!0}dispose(e){this.objects.push(Mt.dispose),this.objects.push(e)}complete(e){this.objects.push(Mt.complete),this.objects.push(e)}event(e,t){this.objects.push(Mt.event),this.objects.push(e),this.objects.push(t)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let e=this.objects,t=this.animState.listeners;for(let s=0;s<e.length;s+=2){let i=e[s],n=e[s+1];switch(i){case Mt.start:n.listener&&n.listener.start&&n.listener.start(n);for(let e=0;e<t.length;e++){let s=t[e];s.start&&s.start(n)}break;case Mt.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let e=0;e<t.length;e++){let s=t[e];s.interrupt&&s.interrupt(n)}break;case Mt.end:n.listener&&n.listener.end&&n.listener.end(n);for(let e=0;e<t.length;e++){let s=t[e];s.end&&s.end(n)}case Mt.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let e=0;e<t.length;e++){let s=t[e];s.dispose&&s.dispose(n)}this.animState.trackEntryPool.free(n);break;case Mt.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let e=0;e<t.length;e++){let s=t[e];s.complete&&s.complete(n)}break;case Mt.event:let i=e[2+s++];n.listener&&n.listener.event&&n.listener.event(n,i);for(let e=0;e<t.length;e++){let s=t[e];s.event&&s.event(n,i)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Mt;!function(e){e[e.start=0]="start",e[e.interrupt=1]="interrupt",e[e.end=2]="end",e[e.dispose=3]="dispose",e[e.complete=4]="complete",e[e.event=5]="event"}(Mt||(Mt={}));const Tt=0,Rt=1,Bt=2,Lt=3,_t=4,Ft=1,Dt=2;class Yt{skeletonData;animationToMixTime={};defaultMix=0;constructor(e){if(!e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}setMix(e,t,s){let i=this.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);let n=this.skeletonData.findAnimation(t);if(!n)throw new Error("Animation not found: "+t);this.setMixWith(i,n,s)}setMixWith(e,t,s){if(!e)throw new Error("from cannot be null.");if(!t)throw new Error("to cannot be null.");let i=e.name+"."+t.name;this.animationToMixTime[i]=s}getMix(e,t){let s=e.name+"."+t.name,i=this.animationToMixTime[s];return void 0===i?this.defaultMix:i}}class Ot extends Le{color=new Ce(1,1,1,1);constructor(e){super(e)}copy(){let e=new Ot(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}}class Xt extends Le{endSlot=null;color=new Ce(.2275,.2275,.8078,1);constructor(e){super(e)}copy(){let e=new Xt(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}}class Vt{_image;constructor(e){this._image=e}getImage(){return this._image}}var Nt,Ut,zt,Gt,Wt,qt,jt,Ht,Jt,$t;!function(e){e[e.Nearest=9728]="Nearest",e[e.Linear=9729]="Linear",e[e.MipMap=9987]="MipMap",e[e.MipMapNearestNearest=9984]="MipMapNearestNearest",e[e.MipMapLinearNearest=9985]="MipMapLinearNearest",e[e.MipMapNearestLinear=9986]="MipMapNearestLinear",e[e.MipMapLinearLinear=9987]="MipMapLinearLinear"}(Nt||(Nt={})),function(e){e[e.MirroredRepeat=33648]="MirroredRepeat",e[e.ClampToEdge=33071]="ClampToEdge",e[e.Repeat=10497]="Repeat"}(Ut||(Ut={}));class Kt{texture;u=0;v=0;u2=0;v2=0;width=0;height=0;degrees=0;offsetX=0;offsetY=0;originalWidth=0;originalHeight=0}class Qt{pages=new Array;regions=new Array;constructor(e){let t=new Zt(e),s=new Array(4),i={size:e=>{e.width=parseInt(s[1]),e.height=parseInt(s[2])},format:()=>{},filter:e=>{e.minFilter=Me.enumValue(Nt,s[1]),e.magFilter=Me.enumValue(Nt,s[2])},repeat:e=>{-1!=s[1].indexOf("x")&&(e.uWrap=Ut.Repeat),-1!=s[1].indexOf("y")&&(e.vWrap=Ut.Repeat)},pma:e=>{e.pma="true"==s[1]}};var n={xy:e=>{e.x=parseInt(s[1]),e.y=parseInt(s[2])},size:e=>{e.width=parseInt(s[1]),e.height=parseInt(s[2])},bounds:e=>{e.x=parseInt(s[1]),e.y=parseInt(s[2]),e.width=parseInt(s[3]),e.height=parseInt(s[4])},offset:e=>{e.offsetX=parseInt(s[1]),e.offsetY=parseInt(s[2])},orig:e=>{e.originalWidth=parseInt(s[1]),e.originalHeight=parseInt(s[2])},offsets:e=>{e.offsetX=parseInt(s[1]),e.offsetY=parseInt(s[2]),e.originalWidth=parseInt(s[3]),e.originalHeight=parseInt(s[4])},rotate:e=>{let t=s[1];"true"==t?e.degrees=90:"false"!=t&&(e.degrees=parseInt(t))},index:e=>{e.index=parseInt(s[1])}};let a=t.readLine();for(;a&&0==a.trim().length;)a=t.readLine();for(;a&&0!=a.trim().length&&0!=t.readEntry(s,a);)a=t.readLine();let r=null,o=null,l=null;for(;null!==a;)if(0==a.trim().length)r=null,a=t.readLine();else if(r){let e=new ts(r,a);for(;;){let i=t.readEntry(s,a=t.readLine());if(0==i)break;let r=n[s[0]];if(r)r(e);else{o||(o=[]),l||(l=[]),o.push(s[0]);let e=[];for(let t=0;t<i;t++)e.push(parseInt(s[t+1]));l.push(e)}}0==e.originalWidth&&0==e.originalHeight&&(e.originalWidth=e.width,e.originalHeight=e.height),o&&o.length>0&&l&&l.length>0&&(e.names=o,e.values=l,o=null,l=null),e.u=e.x/r.width,e.v=e.y/r.height,90==e.degrees?(e.u2=(e.x+e.height)/r.width,e.v2=(e.y+e.width)/r.height):(e.u2=(e.x+e.width)/r.width,e.v2=(e.y+e.height)/r.height),this.regions.push(e)}else{for(r=new es(a.trim());0!=t.readEntry(s,a=t.readLine());){let e=i[s[0]];e&&e(r)}this.pages.push(r)}}findRegion(e){for(let t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null}setTextures(e,t=""){for(let s of this.pages)s.setTexture(e.get(t+s.name))}dispose(){for(let e=0;e<this.pages.length;e++)this.pages[e].texture?.dispose()}}class Zt{lines;index=0;constructor(e){this.lines=e.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(e,t){if(!t)return 0;if(0==(t=t.trim()).length)return 0;let s=t.indexOf(":");if(-1==s)return 0;e[0]=t.substr(0,s).trim();for(let i=1,n=s+1;;i++){let s=t.indexOf(",",n);if(-1==s)return e[i]=t.substr(n).trim(),i;if(e[i]=t.substr(n,s-n).trim(),n=s+1,4==i)return 4}}}class es{name;minFilter=Nt.Nearest;magFilter=Nt.Nearest;uWrap=Ut.ClampToEdge;vWrap=Ut.ClampToEdge;texture=null;width=0;height=0;pma=!1;regions=new Array;constructor(e){this.name=e}setTexture(e){this.texture=e,e.setFilters(this.minFilter,this.magFilter),e.setWraps(this.uWrap,this.vWrap);for(let t of this.regions)t.texture=e}}class ts extends Kt{page;name;x=0;y=0;offsetX=0;offsetY=0;originalWidth=0;originalHeight=0;index=0;degrees=0;names=null;values=null;constructor(e,t){super(),this.page=e,this.name=t,e.regions.push(this)}}class ss extends Le{region=null;path;regionUVs=[];uvs=[];triangles=[];color=new Ce(1,1,1,1);width=0;height=0;hullLength=0;edges=[];parentMesh=null;sequence=null;tempColor=new Ce(0,0,0,0);constructor(e,t){super(e),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.regionUVs;this.uvs&&this.uvs.length==e.length||(this.uvs=Me.newFloatArray(e.length));let t=this.uvs,s=this.uvs.length,i=this.region.u,n=this.region.v,a=0,r=0;if(this.region instanceof ts){let o=this.region,l=o.page,h=l.width,c=l.height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/h,n-=(o.originalWidth-o.offsetX-o.width)/c,a=o.originalHeight/h,r=o.originalWidth/c;for(let o=0;o<s;o+=2)t[o]=i+e[o+1]*a,t[o+1]=n+(1-e[o])*r;return;case 180:i-=(o.originalWidth-o.offsetX-o.width)/h,n-=o.offsetY/c,a=o.originalWidth/h,r=o.originalHeight/c;for(let o=0;o<s;o+=2)t[o]=i+(1-e[o])*a,t[o+1]=n+(1-e[o+1])*r;return;case 270:i-=o.offsetY/h,n-=o.offsetX/c,a=o.originalHeight/h,r=o.originalWidth/c;for(let o=0;o<s;o+=2)t[o]=i+(1-e[o+1])*a,t[o+1]=n+e[o]*r;return}i-=o.offsetX/h,n-=(o.originalHeight-o.offsetY-o.height)/c,a=o.originalWidth/h,r=o.originalHeight/c}else this.region?(a=this.region.u2-i,r=this.region.v2-n):(i=n=0,a=r=1);for(let o=0;o<s;o+=2)t[o]=i+e[o]*a,t[o+1]=n+e[o+1]*r}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let e=new ss(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),Me.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),Me.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),Me.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),Me.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}computeWorldVertices(e,t,s,i,n,a){null!=this.sequence&&this.sequence.apply(e,this),super.computeWorldVertices(e,t,s,i,n,a)}newLinkedMesh(){let e=new ss(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),null!=e.region&&e.updateRegion(),e}}class is extends Le{lengths=[];closed=!1;constantSpeed=!1;color=new Ce(1,1,1,1);constructor(e){super(e)}copy(){let e=new is(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Me.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}}class ns extends Le{x=0;y=0;rotation=0;color=new Ce(.38,.94,0,1);constructor(e){super(e)}computeWorldPosition(e,t){return t.x=this.x*e.a+this.y*e.b+e.worldX,t.y=this.x*e.c+this.y*e.d+e.worldY,t}computeWorldRotation(e){const t=this.rotation*Pe.degRad,s=Math.cos(t),i=Math.sin(t),n=s*e.a+i*e.b,a=s*e.c+i*e.d;return Pe.atan2Deg(a,n)}copy(){let e=new ns(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}}class as extends Be{x=0;y=0;scaleX=1;scaleY=1;rotation=0;width=0;height=0;color=new Ce(1,1,1,1);path;region=null;sequence=null;offset=Me.newFloatArray(8);uvs=Me.newFloatArray(8);tempColor=new Ce(1,1,1,1);constructor(e,t){super(e),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.region,t=this.uvs;if(null==e)return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=1,t[5]=1,t[6]=1,void(t[7]=0);let s=this.width/this.region.originalWidth*this.scaleX,i=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*s,a=-this.height/2*this.scaleY+this.region.offsetY*i,r=n+this.region.width*s,o=a+this.region.height*i,l=this.rotation*Pe.degRad,h=Math.cos(l),c=Math.sin(l),d=this.x,u=this.y,p=n*h+d,m=n*c,g=a*h+u,f=a*c,y=r*h+d,x=r*c,w=o*h+u,b=o*c,v=this.offset;v[0]=p-f,v[1]=g+m,v[2]=p-b,v[3]=w+m,v[4]=y-b,v[5]=w+x,v[6]=y-f,v[7]=g+x,90==e.degrees?(t[0]=e.u2,t[1]=e.v2,t[2]=e.u,t[3]=e.v2,t[4]=e.u,t[5]=e.v,t[6]=e.u2,t[7]=e.v):(t[0]=e.u,t[1]=e.v2,t[2]=e.u,t[3]=e.v,t[4]=e.u2,t[5]=e.v,t[6]=e.u2,t[7]=e.v2)}computeWorldVertices(e,t,s,i){null!=this.sequence&&this.sequence.apply(e,this);let n=e.bone,a=this.offset,r=n.worldX,o=n.worldY,l=n.a,h=n.b,c=n.c,d=n.d,u=0,p=0;u=a[0],p=a[1],t[s]=u*l+p*h+r,t[s+1]=u*c+p*d+o,s+=i,u=a[2],p=a[3],t[s]=u*l+p*h+r,t[s+1]=u*c+p*d+o,s+=i,u=a[4],p=a[5],t[s]=u*l+p*h+r,t[s+1]=u*c+p*d+o,s+=i,u=a[6],p=a[7],t[s]=u*l+p*h+r,t[s+1]=u*c+p*d+o}copy(){let e=new as(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,Me.arrayCopy(this.uvs,0,e.uvs,0,8),Me.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=null!=this.sequence?this.sequence.copy():null,e}static X1=0;static Y1=1;static C1R=2;static C1G=3;static C1B=4;static C1A=5;static U1=6;static V1=7;static X2=8;static Y2=9;static C2R=10;static C2G=11;static C2B=12;static C2A=13;static U2=14;static V2=15;static X3=16;static Y3=17;static C3R=18;static C3G=19;static C3B=20;static C3A=21;static U3=22;static V3=23;static X4=24;static Y4=25;static C4R=26;static C4G=27;static C4B=28;static C4A=29;static U4=30;static V4=31}class rs{atlas;constructor(e){this.atlas=e}loadSequence(e,t,s){let i=s.regions;for(let n=0,a=i.length;n<a;n++){let a=s.getPath(t,n),r=this.atlas.findRegion(a);if(null==r)throw new Error("Region not found in atlas: "+a+" (sequence: "+e+")");i[n]=r}}newRegionAttachment(e,t,s,i){let n=new as(t,s);if(null!=i)this.loadSequence(t,s,i);else{let e=this.atlas.findRegion(s);if(!e)throw new Error("Region not found in atlas: "+s+" (region attachment: "+t+")");n.region=e}return n}newMeshAttachment(e,t,s,i){let n=new ss(t,s);if(null!=i)this.loadSequence(t,s,i);else{let e=this.atlas.findRegion(s);if(!e)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+t+")");n.region=e}return n}newBoundingBoxAttachment(e,t){return new Ot(t)}newPathAttachment(e,t){return new is(t)}newPointAttachment(e,t){return new ns(t)}newClippingAttachment(e,t){return new Xt(t)}}class os{index=0;name;parent=null;length=0;x=0;y=0;rotation=0;scaleX=1;scaleY=1;shearX=0;shearY=0;inherit=zt.Normal;skinRequired=!1;color=new Ce;icon;visible=!1;constructor(e,t,s){if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=s}}!function(e){e[e.Normal=0]="Normal",e[e.OnlyTranslation=1]="OnlyTranslation",e[e.NoRotationOrReflection=2]="NoRotationOrReflection",e[e.NoScale=3]="NoScale",e[e.NoScaleOrReflection=4]="NoScaleOrReflection"}(zt||(zt={}));class ls{data;skeleton;parent=null;children=new Array;x=0;y=0;rotation=0;scaleX=0;scaleY=0;shearX=0;shearY=0;ax=0;ay=0;arotation=0;ascaleX=0;ascaleY=0;ashearX=0;ashearY=0;a=0;b=0;c=0;d=0;worldY=0;worldX=0;inherit=zt.Normal;sorted=!1;active=!1;constructor(e,t,s){if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=t,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(e){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(e,t,s,i,n,a,r){this.ax=e,this.ay=t,this.arotation=s,this.ascaleX=i,this.ascaleY=n,this.ashearX=a,this.ashearY=r;let o=this.parent;if(!o){let o=this.skeleton;const l=o.scaleX,h=o.scaleY,c=(s+a)*Pe.degRad,d=(s+90+r)*Pe.degRad;return this.a=Math.cos(c)*i*l,this.b=Math.cos(d)*n*l,this.c=Math.sin(c)*i*h,this.d=Math.sin(d)*n*h,this.worldX=e*l+o.x,void(this.worldY=t*h+o.y)}let l=o.a,h=o.b,c=o.c,d=o.d;switch(this.worldX=l*e+h*t+o.worldX,this.worldY=c*e+d*t+o.worldY,this.inherit){case zt.Normal:{const e=(s+a)*Pe.degRad,t=(s+90+r)*Pe.degRad,o=Math.cos(e)*i,u=Math.cos(t)*n,p=Math.sin(e)*i,m=Math.sin(t)*n;return this.a=l*o+h*p,this.b=l*u+h*m,this.c=c*o+d*p,void(this.d=c*u+d*m)}case zt.OnlyTranslation:{const e=(s+a)*Pe.degRad,t=(s+90+r)*Pe.degRad;this.a=Math.cos(e)*i,this.b=Math.cos(t)*n,this.c=Math.sin(e)*i,this.d=Math.sin(t)*n;break}case zt.NoRotationOrReflection:{let e=1/this.skeleton.scaleX,t=1/this.skeleton.scaleY;l*=e,c*=t;let o=l*l+c*c,u=0;o>1e-4?(o=Math.abs(l*d*t-h*e*c)/o,h=c*o,d=l*o,u=Math.atan2(c,l)*Pe.radDeg):(l=0,c=0,u=90-Math.atan2(d,h)*Pe.radDeg);const p=(s+a-u)*Pe.degRad,m=(s+r-u+90)*Pe.degRad,g=Math.cos(p)*i,f=Math.cos(m)*n,y=Math.sin(p)*i,x=Math.sin(m)*n;this.a=l*g-h*y,this.b=l*f-h*x,this.c=c*g+d*y,this.d=c*f+d*x;break}case zt.NoScale:case zt.NoScaleOrReflection:{s*=Pe.degRad;const e=Math.cos(s),t=Math.sin(s);let o=(l*e+h*t)/this.skeleton.scaleX,u=(c*e+d*t)/this.skeleton.scaleY,p=Math.sqrt(o*o+u*u);p>1e-5&&(p=1/p),o*=p,u*=p,p=Math.sqrt(o*o+u*u),this.inherit==zt.NoScale&&l*d-h*c<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(p=-p),s=Math.PI/2+Math.atan2(u,o);const m=Math.cos(s)*p,g=Math.sin(s)*p;a*=Pe.degRad,r=(90+r)*Pe.degRad;const f=Math.cos(a)*i,y=Math.cos(r)*n,x=Math.sin(a)*i,w=Math.sin(r)*n;this.a=o*f+m*x,this.b=o*y+m*w,this.c=u*f+g*x,this.d=u*y+g*w;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.shearX=e.shearX,this.shearY=e.shearY,this.inherit=e.inherit}updateAppliedTransform(){let e=this.parent;if(!e)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*Pe.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*Pe.radDeg);let t,s,i,n,a=e.a,r=e.b,o=e.c,l=e.d,h=1/(a*l-r*o),c=l*h,d=r*h,u=o*h,p=a*h,m=this.worldX-e.worldX,g=this.worldY-e.worldY;if(this.ax=m*c-g*d,this.ay=g*p-m*u,this.inherit==zt.OnlyTranslation)t=this.a,s=this.b,i=this.c,n=this.d;else{switch(this.inherit){case zt.NoRotationOrReflection:{let e=Math.abs(a*l-r*o)/(a*a+o*o);r=-o*this.skeleton.scaleX*e/this.skeleton.scaleY,l=a*this.skeleton.scaleY*e/this.skeleton.scaleX,h=1/(a*l-r*o),c=l*h,d=r*h;break}case zt.NoScale:case zt.NoScaleOrReflection:let e=Pe.cosDeg(this.rotation),t=Pe.sinDeg(this.rotation);a=(a*e+r*t)/this.skeleton.scaleX,o=(o*e+l*t)/this.skeleton.scaleY;let s=Math.sqrt(a*a+o*o);s>1e-5&&(s=1/s),a*=s,o*=s,s=Math.sqrt(a*a+o*o),this.inherit==zt.NoScale&&h<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(s=-s);let i=Pe.PI/2+Math.atan2(o,a);r=Math.cos(i)*s,l=Math.sin(i)*s,h=1/(a*l-r*o),c=l*h,d=r*h,u=o*h,p=a*h}t=c*this.a-d*this.c,s=c*this.b-d*this.d,i=p*this.c-u*this.a,n=p*this.d-u*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(t*t+i*i),this.ascaleX>1e-4){let e=t*n-s*i;this.ascaleY=e/this.ascaleX,this.ashearY=-Math.atan2(t*s+i*n,e)*Pe.radDeg,this.arotation=Math.atan2(i,t)*Pe.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(s*s+n*n),this.ashearY=0,this.arotation=90-Math.atan2(n,s)*Pe.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*Pe.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*Pe.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(e){let t=1/(this.a*this.d-this.b*this.c),s=e.x-this.worldX,i=e.y-this.worldY;return e.x=s*this.d*t-i*this.b*t,e.y=i*this.a*t-s*this.c*t,e}localToWorld(e){let t=e.x,s=e.y;return e.x=t*this.a+s*this.b+this.worldX,e.y=t*this.c+s*this.d+this.worldY,e}worldToParent(e){if(null==e)throw new Error("world cannot be null.");return null==this.parent?e:this.parent.worldToLocal(e)}parentToWorld(e){if(null==e)throw new Error("world cannot be null.");return null==this.parent?e:this.parent.localToWorld(e)}worldToLocalRotation(e){let t=Pe.sinDeg(e),s=Pe.cosDeg(e);return Math.atan2(this.a*t-this.c*s,this.d*s-this.b*t)*Pe.radDeg+this.rotation-this.shearX}localToWorldRotation(e){e-=this.rotation-this.shearX;let t=Pe.sinDeg(e),s=Pe.cosDeg(e);return Math.atan2(s*this.c+t*this.d,s*this.a+t*this.b)*Pe.radDeg}rotateWorld(e){e*=Pe.degRad;const t=Math.sin(e),s=Math.cos(e),i=this.a,n=this.b;this.a=s*i-t*this.c,this.b=s*n-t*this.d,this.c=t*i+s*this.c,this.d=t*n+s*this.d}}class hs{data;bones;target;bendDirection=0;compress=!1;stretch=!1;mix=1;softness=0;active=!1;constructor(e,t){if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0;s<e.bones.length;s++){let i=t.findBone(e.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${e.bones[s].name}`);this.bones.push(i)}let s=t.findBone(e.target.name);if(!s)throw new Error(`Couldn't find bone ${e.target.name}`);this.target=s,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}update(e){if(0==this.mix)return;let t=this.target,s=this.bones;switch(s.length){case 1:this.apply1(s[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(s[0],s[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(e,t,s,i,n,a,r){let o=e.parent;if(!o)throw new Error("IK bone must have parent.");let l=o.a,h=o.b,c=o.c,d=o.d,u=-e.ashearX-e.arotation,p=0,m=0;switch(e.inherit){case zt.OnlyTranslation:p=(t-e.worldX)*Pe.signum(e.skeleton.scaleX),m=(s-e.worldY)*Pe.signum(e.skeleton.scaleY);break;case zt.NoRotationOrReflection:let i=Math.abs(l*d-h*c)/Math.max(1e-4,l*l+c*c),n=l/e.skeleton.scaleX,a=c/e.skeleton.scaleY;h=-a*i*e.skeleton.scaleX,d=n*i*e.skeleton.scaleY,u+=Math.atan2(a,n)*Pe.radDeg;default:let r=t-o.worldX,g=s-o.worldY,f=l*d-h*c;Math.abs(f)<=1e-4?(p=0,m=0):(p=(r*d-g*h)/f-e.ax,m=(g*l-r*c)/f-e.ay)}u+=Math.atan2(m,p)*Pe.radDeg,e.ascaleX<0&&(u+=180),u>180?u-=360:u<-180&&(u+=360);let g=e.ascaleX,f=e.ascaleY;if(i||n){switch(e.inherit){case zt.NoScale:case zt.NoScaleOrReflection:p=t-e.worldX,m=s-e.worldY}const o=e.data.length*g;if(o>1e-4){const e=p*p+m*m;if(i&&e<o*o||n&&e>o*o){const t=(Math.sqrt(e)/o-1)*r+1;g*=t,a&&(f*=t)}}}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+u*r,g,f,e.ashearX,e.ashearY)}apply2(e,t,s,i,n,a,r,o,l){if(e.inherit!=zt.Normal||t.inherit!=zt.Normal)return;let h=e.ax,c=e.ay,d=e.ascaleX,u=e.ascaleY,p=d,m=u,g=t.ascaleX,f=0,y=0,x=0;d<0?(d=-d,f=180,x=-1):(f=0,x=1),u<0&&(u=-u,x=-x),g<0?(g=-g,y=180):y=0;let w=t.ax,b=0,v=0,S=0,k=e.a,I=e.b,A=e.c,E=e.d,C=Math.abs(d-u)<=1e-4;!C||a?(b=0,v=k*w+e.worldX,S=A*w+e.worldY):(b=t.ay,v=k*w+I*b+e.worldX,S=A*w+E*b+e.worldY);let P=e.parent;if(!P)throw new Error("IK parent must itself have a parent.");k=P.a,I=P.b,A=P.c,E=P.d;let M=k*E-I*A,T=v-P.worldX,R=S-P.worldY;M=Math.abs(M)<=1e-4?0:1/M;let B,L,_=(T*E-R*I)*M-h,F=(R*k-T*A)*M-c,D=Math.sqrt(_*_+F*F),Y=t.data.length*g;if(D<1e-4)return this.apply1(e,s,i,!1,a,!1,l),void t.updateWorldTransformWith(w,b,0,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY);T=s-P.worldX,R=i-P.worldY;let O=(T*E-R*I)*M-h,X=(R*k-T*A)*M-c,V=O*O+X*X;if(0!=o){o*=d*(g+1)*.5;let e=Math.sqrt(V),t=e-D-Y*d+o;if(t>0){let s=Math.min(1,t/(2*o))-1;s=(t-o*(1-s*s))/e,O-=s*O,X-=s*X,V=O*O+X*X}}e:if(C){Y*=d;let e=(V-D*D-Y*Y)/(2*D*Y);e<-1?(e=-1,L=Math.PI*n):e>1?(e=1,L=0,a&&(k=(Math.sqrt(V)/(D+Y)-1)*l+1,p*=k,r&&(m*=k))):L=Math.acos(e)*n,k=D+Y*e,I=Y*Math.sin(L),B=Math.atan2(X*k-O*I,O*k+X*I)}else{k=d*Y,I=u*Y;let e=k*k,t=I*I,s=Math.atan2(X,O);A=t*D*D+e*V-e*t;let i=-2*t*D,a=t-e;if(E=i*i-4*a*A,E>=0){let e=Math.sqrt(E);i<0&&(e=-e),e=.5*-(i+e);let t=e/a,r=A/e,o=Math.abs(t)<Math.abs(r)?t:r;if(t=V-o*o,t>=0){R=Math.sqrt(t)*n,B=s-Math.atan2(R,o),L=Math.atan2(R/u,(o-D)/d);break e}}let r=Pe.PI,o=D-k,l=o*o,h=0,c=0,p=D+k,m=p*p,g=0;A=-k*D/(e-t),A>=-1&&A<=1&&(A=Math.acos(A),T=k*Math.cos(A)+D,R=I*Math.sin(A),E=T*T+R*R,E<l&&(r=A,l=E,o=T,h=R),E>m&&(c=A,m=E,p=T,g=R)),V<=.5*(l+m)?(B=s-Math.atan2(h*n,o),L=r*n):(B=s-Math.atan2(g*n,p),L=c*n)}let N=Math.atan2(b,w)*x,U=e.arotation;B=(B-N)*Pe.radDeg+f-U,B>180?B-=360:B<-180&&(B+=360),e.updateWorldTransformWith(h,c,U+B*l,p,m,0,0),U=t.arotation,L=((L+N)*Pe.radDeg-t.ashearX)*x+y-U,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(w,b,U+L*l,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)}}class cs{name;order;skinRequired;constructor(e,t,s){this.name=e,this.order=t,this.skinRequired=s}}class ds extends cs{bones=new Array;_target=null;set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}bendDirection=0;compress=!1;stretch=!1;uniform=!1;mix=0;softness=0;constructor(e){super(e,0,!1)}}class us extends cs{bones=new Array;_target=null;set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}positionMode=Gt.Fixed;spacingMode=Wt.Fixed;rotateMode=qt.Chain;offsetRotation=0;position=0;spacing=0;mixRotate=0;mixX=0;mixY=0;constructor(e){super(e,0,!1)}}!function(e){e[e.Fixed=0]="Fixed",e[e.Percent=1]="Percent"}(Gt||(Gt={})),function(e){e[e.Length=0]="Length",e[e.Fixed=1]="Fixed",e[e.Percent=2]="Percent",e[e.Proportional=3]="Proportional"}(Wt||(Wt={})),function(e){e[e.Tangent=0]="Tangent",e[e.Chain=1]="Chain",e[e.ChainScale=2]="ChainScale"}(qt||(qt={}));class ps{static NONE=-1;static BEFORE=-2;static AFTER=-3;static epsilon=1e-5;data;bones;target;position=0;spacing=0;mixRotate=0;mixX=0;mixY=0;spaces=new Array;positions=new Array;world=new Array;curves=new Array;lengths=new Array;segments=new Array;active=!1;constructor(e,t){if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0,i=e.bones.length;s<i;s++){let i=t.findBone(e.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${e.bones[s].name}.`);this.bones.push(i)}let s=t.findSlot(e.target.name);if(!s)throw new Error(`Couldn't find target bone ${e.target.name}`);this.target=s,this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}update(e){let t=this.target.getAttachment();if(!(t instanceof is))return;let s=this.mixRotate,i=this.mixX,n=this.mixY;if(0==s&&0==i&&0==n)return;let a=this.data,r=a.rotateMode==qt.Tangent,o=a.rotateMode==qt.ChainScale,l=this.bones,h=l.length,c=r?h:h+1,d=Me.setArraySize(this.spaces,c),u=o?this.lengths=Me.setArraySize(this.lengths,h):[],p=this.spacing;switch(a.spacingMode){case Wt.Percent:if(o)for(let e=0,t=c-1;e<t;e++){let t=l[e],s=t.data.length,i=s*t.a,n=s*t.c;u[e]=Math.sqrt(i*i+n*n)}Me.arrayFill(d,1,c,p);break;case Wt.Proportional:let e=0;for(let t=0,s=c-1;t<s;){let s=l[t],i=s.data.length;if(i<ps.epsilon)o&&(u[t]=0),d[++t]=p;else{let n=i*s.a,a=i*s.c,r=Math.sqrt(n*n+a*a);o&&(u[t]=r),d[++t]=r,e+=r}}if(e>0){e=c/e*p;for(let t=1;t<c;t++)d[t]*=e}break;default:let t=a.spacingMode==Wt.Length;for(let e=0,s=c-1;e<s;){let s=l[e],i=s.data.length;if(i<ps.epsilon)o&&(u[e]=0),d[++e]=p;else{let n=i*s.a,a=i*s.c,r=Math.sqrt(n*n+a*a);o&&(u[e]=r),d[++e]=(t?i+p:p)*r/i}}}let m=this.computeWorldPositions(t,c,r),g=m[0],f=m[1],y=a.offsetRotation,x=!1;if(0==y)x=a.rotateMode==qt.Chain;else{x=!1;let e=this.target.bone;y*=e.a*e.d-e.b*e.c>0?Pe.degRad:-Pe.degRad}for(let e=0,t=3;e<h;e++,t+=3){let a=l[e];a.worldX+=(g-a.worldX)*i,a.worldY+=(f-a.worldY)*n;let h=m[t],c=m[t+1],p=h-g,w=c-f;if(o){let t=u[e];if(0!=t){let e=(Math.sqrt(p*p+w*w)/t-1)*s+1;a.a*=e,a.c*=e}}if(g=h,f=c,s>0){let i=a.a,n=a.b,o=a.c,l=a.d,h=0,c=0,u=0;if(h=r?m[t-1]:0==d[e+1]?m[t+2]:Math.atan2(w,p),h-=Math.atan2(o,i),x){c=Math.cos(h),u=Math.sin(h);let e=a.data.length;g+=(e*(c*i-u*o)-p)*s,f+=(e*(u*i+c*o)-w)*s}else h+=y;h>Pe.PI?h-=Pe.PI2:h<-Pe.PI&&(h+=Pe.PI2),h*=s,c=Math.cos(h),u=Math.sin(h),a.a=c*i-u*o,a.b=c*n-u*l,a.c=u*i+c*o,a.d=u*n+c*l}a.updateAppliedTransform()}}computeWorldPositions(e,t,s){let i=this.target,n=this.position,a=this.spaces,r=Me.setArraySize(this.positions,3*t+2),o=this.world,l=e.closed,h=e.worldVerticesLength,c=h/6,d=ps.NONE;if(!e.constantSpeed){let u=e.lengths;c-=l?1:2;let p,m=u[c];switch(this.data.positionMode==Gt.Percent&&(n*=m),this.data.spacingMode){case Wt.Percent:p=m;break;case Wt.Proportional:p=m/t;break;default:p=1}o=Me.setArraySize(this.world,8);for(let g=0,f=0,y=0;g<t;g++,f+=3){let t=a[g]*p;n+=t;let x=n;if(l)x%=m,x<0&&(x+=m),y=0;else{if(x<0){d!=ps.BEFORE&&(d=ps.BEFORE,e.computeWorldVertices(i,2,4,o,0,2)),this.addBeforePosition(x,o,0,r,f);continue}if(x>m){d!=ps.AFTER&&(d=ps.AFTER,e.computeWorldVertices(i,h-6,4,o,0,2)),this.addAfterPosition(x-m,o,0,r,f);continue}}for(;;y++){let e=u[y];if(!(x>e)){if(0==y)x/=e;else{let t=u[y-1];x=(x-t)/(e-t)}break}}y!=d&&(d=y,l&&y==c?(e.computeWorldVertices(i,h-4,4,o,0,2),e.computeWorldVertices(i,0,4,o,4,2)):e.computeWorldVertices(i,6*y+2,8,o,0,2)),this.addCurvePosition(x,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],r,f,s||g>0&&0==t)}return r}l?(h+=2,o=Me.setArraySize(this.world,h),e.computeWorldVertices(i,2,h-4,o,0,2),e.computeWorldVertices(i,0,2,o,h-4,2),o[h-2]=o[0],o[h-1]=o[1]):(c--,h-=4,o=Me.setArraySize(this.world,h),e.computeWorldVertices(i,2,h,o,0,2));let u,p=Me.setArraySize(this.curves,c),m=0,g=o[0],f=o[1],y=0,x=0,w=0,b=0,v=0,S=0,k=0,I=0,A=0,E=0,C=0,P=0,M=0,T=0;for(let e=0,t=2;e<c;e++,t+=6)y=o[t],x=o[t+1],w=o[t+2],b=o[t+3],v=o[t+4],S=o[t+5],k=.1875*(g-2*y+w),I=.1875*(f-2*x+b),A=.09375*(3*(y-w)-g+v),E=.09375*(3*(x-b)-f+S),C=2*k+A,P=2*I+E,M=.75*(y-g)+k+.16666667*A,T=.75*(x-f)+I+.16666667*E,m+=Math.sqrt(M*M+T*T),M+=C,T+=P,C+=A,P+=E,m+=Math.sqrt(M*M+T*T),M+=C,T+=P,m+=Math.sqrt(M*M+T*T),M+=C+A,T+=P+E,m+=Math.sqrt(M*M+T*T),p[e]=m,g=v,f=S;switch(this.data.positionMode==Gt.Percent&&(n*=m),this.data.spacingMode){case Wt.Percent:u=m;break;case Wt.Proportional:u=m/t;break;default:u=1}let R=this.segments,B=0;for(let e=0,i=0,c=0,L=0;e<t;e++,i+=3){let t=a[e]*u;n+=t;let _=n;if(l)_%=m,_<0&&(_+=m),c=0;else{if(_<0){this.addBeforePosition(_,o,0,r,i);continue}if(_>m){this.addAfterPosition(_-m,o,h-4,r,i);continue}}for(;;c++){let e=p[c];if(!(_>e)){if(0==c)_/=e;else{let t=p[c-1];_=(_-t)/(e-t)}break}}if(c!=d){d=c;let e=6*c;for(g=o[e],f=o[e+1],y=o[e+2],x=o[e+3],w=o[e+4],b=o[e+5],v=o[e+6],S=o[e+7],k=.03*(g-2*y+w),I=.03*(f-2*x+b),A=.006*(3*(y-w)-g+v),E=.006*(3*(x-b)-f+S),C=2*k+A,P=2*I+E,M=.3*(y-g)+k+.16666667*A,T=.3*(x-f)+I+.16666667*E,B=Math.sqrt(M*M+T*T),R[0]=B,e=1;e<8;e++)M+=C,T+=P,C+=A,P+=E,B+=Math.sqrt(M*M+T*T),R[e]=B;M+=C,T+=P,B+=Math.sqrt(M*M+T*T),R[8]=B,M+=C+A,T+=P+E,B+=Math.sqrt(M*M+T*T),R[9]=B,L=0}for(_*=B;;L++){let e=R[L];if(!(_>e)){if(0==L)_/=e;else{let t=R[L-1];_=L+(_-t)/(e-t)}break}}this.addCurvePosition(.1*_,g,f,y,x,w,b,v,S,r,i,s||e>0&&0==t)}return r}addBeforePosition(e,t,s,i,n){let a=t[s],r=t[s+1],o=t[s+2]-a,l=t[s+3]-r,h=Math.atan2(l,o);i[n]=a+e*Math.cos(h),i[n+1]=r+e*Math.sin(h),i[n+2]=h}addAfterPosition(e,t,s,i,n){let a=t[s+2],r=t[s+3],o=a-t[s],l=r-t[s+1],h=Math.atan2(l,o);i[n]=a+e*Math.cos(h),i[n+1]=r+e*Math.sin(h),i[n+2]=h}addCurvePosition(e,t,s,i,n,a,r,o,l,h,c,d){if(0==e||isNaN(e))return h[c]=t,h[c+1]=s,void(h[c+2]=Math.atan2(n-s,i-t));let u=e*e,p=u*e,m=1-e,g=m*m,f=g*m,y=m*e,x=3*y,w=m*x,b=x*e,v=t*f+i*w+a*b+o*p,S=s*f+n*w+r*b+l*p;h[c]=v,h[c+1]=S,d&&(h[c+2]=e<.001?Math.atan2(n-s,i-t):Math.atan2(S-(s*g+n*y*2+r*u),v-(t*g+i*y*2+a*u)))}}class ms{data;_bone=null;set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}inertia=0;strength=0;damping=0;massInverse=0;wind=0;gravity=0;mix=0;_reset=!0;ux=0;uy=0;cx=0;cy=0;tx=0;ty=0;xOffset=0;xVelocity=0;yOffset=0;yVelocity=0;rotateOffset=0;rotateVelocity=0;scaleOffset=0;scaleVelocity=0;active=!1;skeleton;remaining=0;lastTime=0;constructor(e,t){this.data=e,this.skeleton=t,this.bone=t.bones[e.bone.index],this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const e=this.data;this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}isActive(){return this.active}update(e){const t=this.mix;if(0==t)return;const s=this.data.x>0,i=this.data.y>0,n=this.data.rotate>0||this.data.shearX>0,a=this.data.scaleX>0,r=this.bone,o=r.data.length;switch(e){case jt.none:return;case jt.reset:this.reset();case jt.update:const e=this.skeleton,l=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=l,this.lastTime=e.time;const h=r.worldX,c=r.worldY;if(this._reset)this._reset=!1,this.ux=h,this.uy=c;else{let d=this.remaining,u=this.inertia,p=this.data.step,m=this.skeleton.data.referenceScale,g=-1,f=this.data.limit*l,y=f*Math.abs(e.scaleY);if(f*=Math.abs(e.scaleX),s||i){if(s){const e=(this.ux-h)*u;this.xOffset+=e>f?f:e<-f?-f:e,this.ux=h}if(i){const e=(this.uy-c)*u;this.yOffset+=e>y?y:e<-y?-y:e,this.uy=c}if(d>=p){g=Math.pow(this.damping,60*p);const t=this.massInverse*p,n=this.strength,a=this.wind*m*e.scaleX,r=this.gravity*m*e.scaleY;do{s&&(this.xVelocity+=(a-this.xOffset*n)*t,this.xOffset+=this.xVelocity*p,this.xVelocity*=g),i&&(this.yVelocity-=(r+this.yOffset*n)*t,this.yOffset+=this.yVelocity*p,this.yVelocity*=g),d-=p}while(d>=p)}s&&(r.worldX+=this.xOffset*t*this.data.x),i&&(r.worldY+=this.yOffset*t*this.data.y)}if(n||a){let e=Math.atan2(r.c,r.a),s=0,i=0,l=0,h=this.cx-r.worldX,c=this.cy-r.worldY;if(h>f?h=f:h<-f&&(h=-f),c>y?c=y:c<-y&&(c=-y),n){l=(this.data.rotate+this.data.shearX)*t;let n=Math.atan2(c+this.ty,h+this.tx)-e-this.rotateOffset*l;this.rotateOffset+=(n-Math.ceil(n*Pe.invPI2-.5)*Pe.PI2)*u,n=this.rotateOffset*l+e,s=Math.cos(n),i=Math.sin(n),a&&(n=o*r.getWorldScaleX(),n>0&&(this.scaleOffset+=(h*s+c*i)*u/n))}else{s=Math.cos(e),i=Math.sin(e);const t=o*r.getWorldScaleX();t>0&&(this.scaleOffset+=(h*s+c*i)*u/t)}if(d=this.remaining,d>=p){-1==g&&(g=Math.pow(this.damping,60*p));const t=this.massInverse*p,r=this.strength,h=this.wind,c=ys.yDown?-this.gravity:this.gravity,u=o/m;for(;;)if(d-=p,a&&(this.scaleVelocity+=(h*s-c*i-this.scaleOffset*r)*t,this.scaleOffset+=this.scaleVelocity*p,this.scaleVelocity*=g),n){if(this.rotateVelocity-=((h*i+c*s)*u+this.rotateOffset*r)*t,this.rotateOffset+=this.rotateVelocity*p,this.rotateVelocity*=g,d<p)break;const n=this.rotateOffset*l+e;s=Math.cos(n),i=Math.sin(n)}else if(d<p)break}}this.remaining=d}this.cx=r.worldX,this.cy=r.worldY;break;case jt.pose:s&&(r.worldX+=this.xOffset*t*this.data.x),i&&(r.worldY+=this.yOffset*t*this.data.y)}if(n){let e=this.rotateOffset*t,s=0,i=0,n=0;if(this.data.shearX>0){let t=0;this.data.rotate>0&&(t=e*this.data.rotate,s=Math.sin(t),i=Math.cos(t),n=r.b,r.b=i*n-s*r.d,r.d=s*n+i*r.d),t+=e*this.data.shearX,s=Math.sin(t),i=Math.cos(t),n=r.a,r.a=i*n-s*r.c,r.c=s*n+i*r.c}else e*=this.data.rotate,s=Math.sin(e),i=Math.cos(e),n=r.a,r.a=i*n-s*r.c,r.c=s*n+i*r.c,n=r.b,r.b=i*n-s*r.d,r.d=s*n+i*r.d}if(a){const e=1+this.scaleOffset*t*this.data.scaleX;r.a*=e,r.c*=e}e!=jt.pose&&(this.tx=o*r.a,this.ty=o*r.c),r.updateAppliedTransform()}translate(e,t){this.ux-=e,this.uy-=t,this.cx-=e,this.cy-=t}rotate(e,t,s){const i=s*Pe.degRad,n=Math.cos(i),a=Math.sin(i),r=this.cx-e,o=this.cy-t;this.translate(r*n-o*a-r,r*a+o*n-o)}}class gs{data;bone;color;darkColor=null;attachment=null;attachmentState=0;sequenceIndex=-1;deform=new Array;constructor(e,t){if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new Ce,this.darkColor=e.darkColor?new Ce:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(e){this.attachment!=e&&(e instanceof Le&&this.attachment instanceof Le&&e.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=e,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class fs{data;bones;target;mixRotate=0;mixX=0;mixY=0;mixScaleX=0;mixScaleY=0;mixShearY=0;temp=new Re;active=!1;constructor(e,t){if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0;s<e.bones.length;s++){let i=t.findBone(e.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${e.bones[s].name}.`);this.bones.push(i)}let s=t.findBone(e.target.name);if(!s)throw new Error(`Couldn't find target bone ${e.target.name}.`);this.target=s,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}update(e){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleY&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,r=0!=t||0!=s,o=this.target,l=o.a,h=o.b,c=o.c,d=o.d,u=l*d-h*c>0?Pe.degRad:-Pe.degRad,p=this.data.offsetRotation*u,m=this.data.offsetShearY*u,g=this.bones;for(let u=0,f=g.length;u<f;u++){let f=g[u];if(0!=e){let t=f.a,s=f.b,i=f.c,n=f.d,a=Math.atan2(c,l)-Math.atan2(i,t)+p;a>Pe.PI?a-=Pe.PI2:a<-Pe.PI&&(a+=Pe.PI2),a*=e;let r=Math.cos(a),o=Math.sin(a);f.a=r*t-o*i,f.b=r*s-o*n,f.c=o*t+r*i,f.d=o*s+r*n}if(r){let e=this.temp;o.localToWorld(e.set(this.data.offsetX,this.data.offsetY)),f.worldX+=(e.x-f.worldX)*t,f.worldY+=(e.y-f.worldY)*s}if(0!=i){let e=Math.sqrt(f.a*f.a+f.c*f.c);0!=e&&(e=(e+(Math.sqrt(l*l+c*c)-e+this.data.offsetScaleX)*i)/e),f.a*=e,f.c*=e}if(0!=n){let e=Math.sqrt(f.b*f.b+f.d*f.d);0!=e&&(e=(e+(Math.sqrt(h*h+d*d)-e+this.data.offsetScaleY)*n)/e),f.b*=e,f.d*=e}if(a>0){let e=f.b,t=f.d,s=Math.atan2(t,e),i=Math.atan2(d,h)-Math.atan2(c,l)-(s-Math.atan2(f.c,f.a));i>Pe.PI?i-=Pe.PI2:i<-Pe.PI&&(i+=Pe.PI2),i=s+(i+m)*a;let n=Math.sqrt(e*e+t*t);f.b=Math.cos(i)*n,f.d=Math.sin(i)*n}f.updateAppliedTransform()}}applyRelativeWorld(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,r=0!=t||0!=s,o=this.target,l=o.a,h=o.b,c=o.c,d=o.d,u=l*d-h*c>0?Pe.degRad:-Pe.degRad,p=this.data.offsetRotation*u,m=this.data.offsetShearY*u,g=this.bones;for(let u=0,f=g.length;u<f;u++){let f=g[u];if(0!=e){let t=f.a,s=f.b,i=f.c,n=f.d,a=Math.atan2(c,l)+p;a>Pe.PI?a-=Pe.PI2:a<-Pe.PI&&(a+=Pe.PI2),a*=e;let r=Math.cos(a),o=Math.sin(a);f.a=r*t-o*i,f.b=r*s-o*n,f.c=o*t+r*i,f.d=o*s+r*n}if(r){let e=this.temp;o.localToWorld(e.set(this.data.offsetX,this.data.offsetY)),f.worldX+=e.x*t,f.worldY+=e.y*s}if(0!=i){let e=(Math.sqrt(l*l+c*c)-1+this.data.offsetScaleX)*i+1;f.a*=e,f.c*=e}if(0!=n){let e=(Math.sqrt(h*h+d*d)-1+this.data.offsetScaleY)*n+1;f.b*=e,f.d*=e}if(a>0){let e=Math.atan2(d,h)-Math.atan2(c,l);e>Pe.PI?e-=Pe.PI2:e<-Pe.PI&&(e+=Pe.PI2);let t=f.b,s=f.d;e=Math.atan2(s,t)+(e-Pe.PI/2+m)*a;let i=Math.sqrt(t*t+s*s);f.b=Math.cos(e)*i,f.d=Math.sin(e)*i}f.updateAppliedTransform()}}applyAbsoluteLocal(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,r=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){let h=o[l],c=h.arotation;0!=e&&(c+=(r.arotation-c+this.data.offsetRotation)*e);let d=h.ax,u=h.ay;d+=(r.ax-d+this.data.offsetX)*t,u+=(r.ay-u+this.data.offsetY)*s;let p=h.ascaleX,m=h.ascaleY;0!=i&&0!=p&&(p=(p+(r.ascaleX-p+this.data.offsetScaleX)*i)/p),0!=n&&0!=m&&(m=(m+(r.ascaleY-m+this.data.offsetScaleY)*n)/m);let g=h.ashearY;0!=a&&(g+=(r.ashearY-g+this.data.offsetShearY)*a),h.updateWorldTransformWith(d,u,c,p,m,h.ashearX,g)}}applyRelativeLocal(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,r=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){let h=o[l],c=h.arotation+(r.arotation+this.data.offsetRotation)*e,d=h.ax+(r.ax+this.data.offsetX)*t,u=h.ay+(r.ay+this.data.offsetY)*s,p=h.ascaleX*((r.ascaleX-1+this.data.offsetScaleX)*i+1),m=h.ascaleY*((r.ascaleY-1+this.data.offsetScaleY)*n+1),g=h.ashearY+(r.ashearY+this.data.offsetShearY)*a;h.updateWorldTransformWith(d,u,c,p,m,h.ashearX,g)}}}class ys{static quadTriangles=[0,1,2,2,3,0];static yDown=!1;data;bones;slots;drawOrder;ikConstraints;transformConstraints;pathConstraints;physicsConstraints;_updateCache=new Array;skin=null;color;scaleX=1;_scaleY=1;get scaleY(){return ys.yDown?-this._scaleY:this._scaleY}set scaleY(e){this._scaleY=e}x=0;y=0;time=0;constructor(e){if(!e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(let t=0;t<e.bones.length;t++){let s,i=e.bones[t];if(i.parent){let e=this.bones[i.parent.index];s=new ls(i,this,e),e.children.push(s)}else s=new ls(i,this,null);this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<e.slots.length;t++){let s=e.slots[t],i=this.bones[s.boneData.index],n=new gs(s,i);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let t=0;t<e.ikConstraints.length;t++){let s=e.ikConstraints[t];this.ikConstraints.push(new hs(s,this))}this.transformConstraints=new Array;for(let t=0;t<e.transformConstraints.length;t++){let s=e.transformConstraints[t];this.transformConstraints.push(new fs(s,this))}this.pathConstraints=new Array;for(let t=0;t<e.pathConstraints.length;t++){let s=e.pathConstraints[t];this.pathConstraints.push(new ps(s,this))}this.physicsConstraints=new Array;for(let t=0;t<e.physicsConstraints.length;t++){let s=e.physicsConstraints[t];this.physicsConstraints.push(new ms(s,this))}this.color=new Ce(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let e=this.bones;for(let t=0,s=e.length;t<s;t++){let s=e[t];s.sorted=s.data.skinRequired,s.active=!s.sorted}if(this.skin){let e=this.skin.bones;for(let t=0,s=this.skin.bones.length;t<s;t++){let s=this.bones[e[t].index];do{s.sorted=!1,s.active=!0,s=s.parent}while(s)}}let t=this.ikConstraints,s=this.transformConstraints,i=this.pathConstraints,n=this.physicsConstraints,a=t.length,r=s.length,o=i.length,l=this.physicsConstraints.length,h=a+r+o+l;e:for(let e=0;e<h;e++){for(let s=0;s<a;s++){let i=t[s];if(i.data.order==e){this.sortIkConstraint(i);continue e}}for(let t=0;t<r;t++){let i=s[t];if(i.data.order==e){this.sortTransformConstraint(i);continue e}}for(let t=0;t<o;t++){let s=i[t];if(s.data.order==e){this.sortPathConstraint(s);continue e}}for(let t=0;t<l;t++){const s=n[t];if(s.data.order==e){this.sortPhysicsConstraint(s);continue e}}}for(let t=0,s=e.length;t<s;t++)this.sortBone(e[t])}sortIkConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&Me.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target;this.sortBone(t);let s=e.bones,i=s[0];if(this.sortBone(i),1==s.length)this._updateCache.push(e),this.sortReset(i.children);else{let t=s[s.length-1];this.sortBone(t),this._updateCache.push(e),this.sortReset(i.children),t.sorted=!0}}sortPathConstraint(e){if(e.active=e.target.bone.isActive()&&(!e.data.skinRequired||this.skin&&Me.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target,s=t.data.index,i=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,i);for(let e=0,t=this.data.skins.length;e<t;e++)this.sortPathConstraintAttachment(this.data.skins[e],s,i);let n=t.getAttachment();n instanceof is&&this.sortPathConstraintAttachmentWith(n,i);let a=e.bones,r=a.length;for(let e=0;e<r;e++)this.sortBone(a[e]);this._updateCache.push(e);for(let e=0;e<r;e++)this.sortReset(a[e].children);for(let e=0;e<r;e++)a[e].sorted=!0}sortTransformConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&Me.contains(this.skin.constraints,e.data,!0)),!e.active)return;this.sortBone(e.target);let t=e.bones,s=t.length;if(e.data.local)for(let e=0;e<s;e++){let s=t[e];this.sortBone(s.parent),this.sortBone(s)}else for(let e=0;e<s;e++)this.sortBone(t[e]);this._updateCache.push(e);for(let e=0;e<s;e++)this.sortReset(t[e].children);for(let e=0;e<s;e++)t[e].sorted=!0}sortPathConstraintAttachment(e,t,s){let i=e.attachments[t];if(i)for(let e in i)this.sortPathConstraintAttachmentWith(i[e],s)}sortPathConstraintAttachmentWith(e,t){if(!(e instanceof is))return;let s=e.bones;if(s){let e=this.bones;for(let t=0,i=s.length;t<i;){let i=s[t++];for(i+=t;t<i;)this.sortBone(e[s[t++]])}}else this.sortBone(t)}sortPhysicsConstraint(e){const t=e.bone;e.active=t.active&&(!e.data.skinRequired||null!=this.skin&&Me.contains(this.skin.constraints,e.data,!0)),e.active&&(this.sortBone(t),this._updateCache.push(e),this.sortReset(t.children),t.sorted=!0)}sortBone(e){if(!e)return;if(e.sorted)return;let t=e.parent;t&&this.sortBone(t),e.sorted=!0,this._updateCache.push(e)}sortReset(e){for(let t=0,s=e.length;t<s;t++){let s=e[t];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(e){if(null==e)throw new Error("physics is undefined");let t=this.bones;for(let e=0,s=t.length;e<s;e++){let s=t[e];s.ax=s.x,s.ay=s.y,s.arotation=s.rotation,s.ascaleX=s.scaleX,s.ascaleY=s.scaleY,s.ashearX=s.shearX,s.ashearY=s.shearY}let s=this._updateCache;for(let t=0,i=s.length;t<i;t++)s[t].update(e)}updateWorldTransformWith(e,t){if(!t)throw new Error("parent cannot be null.");let s=this.bones;for(let e=1,t=s.length;e<t;e++){let t=s[e];t.ax=t.x,t.ay=t.y,t.arotation=t.rotation,t.ascaleX=t.scaleX,t.ascaleY=t.scaleY,t.ashearX=t.shearX,t.ashearY=t.shearY}let i=this.getRootBone();if(!i)throw new Error("Root bone must not be null.");let n=t.a,a=t.b,r=t.c,o=t.d;i.worldX=n*this.x+a*this.y+t.worldX,i.worldY=r*this.x+o*this.y+t.worldY;const l=(i.rotation+i.shearX)*Pe.degRad,h=(i.rotation+90+i.shearY)*Pe.degRad,c=Math.cos(l)*i.scaleX,d=Math.cos(h)*i.scaleY,u=Math.sin(l)*i.scaleX,p=Math.sin(h)*i.scaleY;i.a=(n*c+a*u)*this.scaleX,i.b=(n*d+a*p)*this.scaleX,i.c=(r*c+o*u)*this.scaleY,i.d=(r*d+o*p)*this.scaleY;let m=this._updateCache;for(let t=0,s=m.length;t<s;t++){let s=m[t];s!=i&&s.update(e)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const e of this.bones)e.setToSetupPose();for(const e of this.ikConstraints)e.setToSetupPose();for(const e of this.transformConstraints)e.setToSetupPose();for(const e of this.pathConstraints)e.setToSetupPose();for(const e of this.physicsConstraints)e.setToSetupPose()}setSlotsToSetupPose(){let e=this.slots;Me.arrayCopy(e,0,this.drawOrder,0,e.length);for(let t=0,s=e.length;t<s;t++)e[t].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.data.name==e)return i}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.data.name==e)return i}return null}setSkinByName(e){let t=this.data.findSkin(e);if(!t)throw new Error("Skin not found: "+e);this.setSkin(t)}setSkin(e){if(e!=this.skin){if(e)if(this.skin)e.attachAll(this,this.skin);else{let t=this.slots;for(let s=0,i=t.length;s<i;s++){let i=t[s],n=i.data.attachmentName;if(n){let t=e.getAttachment(s,n);t&&i.setAttachment(t)}}}this.skin=e,this.updateCache()}}getAttachmentByName(e,t){let s=this.data.findSlot(e);if(!s)throw new Error(`Can't find slot with name ${e}`);return this.getAttachment(s.index,t)}getAttachment(e,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){let s=this.skin.getAttachment(e,t);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null}setAttachment(e,t){if(!e)throw new Error("slotName cannot be null.");let s=this.slots;for(let i=0,n=s.length;i<n;i++){let n=s[i];if(n.data.name==e){let s=null;if(t&&(s=this.getAttachment(i,t),!s))throw new Error("Attachment not found: "+t+", for slot: "+e);return void n.setAttachment(s)}}throw new Error("Slot not found: "+e)}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.ikConstraints.find((t=>t.data.name==e))??null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.transformConstraints.find((t=>t.data.name==e))??null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.pathConstraints.find((t=>t.data.name==e))??null}findPhysicsConstraint(e){if(null==e)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find((t=>t.data.name==e))??null}getBoundsRect(e){let t=new Re,s=new Re;return this.getBounds(t,s,void 0,e),{x:t.x,y:t.y,width:s.x,height:s.y}}getBounds(e,t,s=new Array(2),i=null){if(!e)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");let n=this.drawOrder,a=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let e=0,t=n.length;e<t;e++){let t=n[e];if(!t.bone.active)continue;let h=0,c=null,d=null,u=t.getAttachment();if(u instanceof as)h=8,c=Me.setArraySize(s,h,0),u.computeWorldVertices(t,c,0,2),d=ys.quadTriangles;else if(u instanceof ss){let e=u;h=e.worldVerticesLength,c=Me.setArraySize(s,h,0),e.computeWorldVertices(t,0,h,c,0,2),d=e.triangles}else if(u instanceof Xt&&null!=i){i.clipStart(t,u);continue}if(c&&d){null!=i&&i.isClipping()&&(i.clipTriangles(c,d,d.length),c=i.clippedVertices,h=i.clippedVertices.length);for(let e=0,t=c.length;e<t;e+=2){let t=c[e],s=c[e+1];a=Math.min(a,t),r=Math.min(r,s),o=Math.max(o,t),l=Math.max(l,s)}}null!=i&&i.clipEndWithSlot(t)}null!=i&&i.clipEnd(),e.set(a,r),t.set(o-a,l-r)}update(e){this.time+=e}physicsTranslate(e,t){const s=this.physicsConstraints;for(let i=0,n=s.length;i<n;i++)s[i].translate(e,t)}physicsRotate(e,t,s){const i=this.physicsConstraints;for(let n=0,a=i.length;n<a;n++)i[n].rotate(e,t,s)}}!function(e){e[e.none=0]="none",e[e.reset=1]="reset",e[e.update=2]="update",e[e.pose=3]="pose"}(jt||(jt={}));class xs{data;intValue=0;floatValue=0;stringValue=null;time=0;volume=0;balance=0;constructor(e,t){if(!t)throw new Error("data cannot be null.");this.time=e,this.data=t}}class ws{name;intValue=0;floatValue=0;stringValue=null;audioPath=null;volume=0;balance=0;constructor(e){this.name=e}}class bs extends cs{_bone=null;set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}x=0;y=0;rotate=0;scaleX=0;shearX=0;limit=0;step=0;inertia=0;strength=0;damping=0;massInverse=0;wind=0;gravity=0;mix=0;inertiaGlobal=!1;strengthGlobal=!1;dampingGlobal=!1;massGlobal=!1;windGlobal=!1;gravityGlobal=!1;mixGlobal=!1;constructor(e){super(e,0,!1)}}class vs{name=null;bones=new Array;slots=new Array;skins=new Array;defaultSkin=null;events=new Array;animations=new Array;ikConstraints=new Array;transformConstraints=new Array;pathConstraints=new Array;physicsConstraints=new Array;x=0;y=0;width=0;height=0;referenceScale=100;version=null;hash=null;fps=0;imagesPath=null;audioPath=null;findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.name==e)return i}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.name==e)return i}return null}findSkin(e){if(!e)throw new Error("skinName cannot be null.");let t=this.skins;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.name==e)return i}return null}findEvent(e){if(!e)throw new Error("eventDataName cannot be null.");let t=this.events;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.name==e)return i}return null}findAnimation(e){if(!e)throw new Error("animationName cannot be null.");let t=this.animations;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i.name==e)return i}return null}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let s=0,i=t.length;s<i;s++){const i=t[s];if(i.name==e)return i}return null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let s=0,i=t.length;s<i;s++){const i=t[s];if(i.name==e)return i}return null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let s=0,i=t.length;s<i;s++){const i=t[s];if(i.name==e)return i}return null}findPhysicsConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.physicsConstraints;for(let s=0,i=t.length;s<i;s++){const i=t[s];if(i.name==e)return i}return null}}class Ss{slotIndex;name;attachment;constructor(e=0,t,s){this.slotIndex=e,this.name=t,this.attachment=s}}class ks{name;attachments=new Array;bones=Array();constraints=new Array;color=new Ce(.99607843,.61960787,.30980393,1);constructor(e){if(!e)throw new Error("name cannot be null.");this.name=e}setAttachment(e,t,s){if(!s)throw new Error("attachment cannot be null.");let i=this.attachments;e>=i.length&&(i.length=e+1),i[e]||(i[e]={}),i[e][t]=s}addSkin(e){for(let t=0;t<e.bones.length;t++){let s=e.bones[t],i=!1;for(let e=0;e<this.bones.length;e++)if(this.bones[e]==s){i=!0;break}i||this.bones.push(s)}for(let t=0;t<e.constraints.length;t++){let s=e.constraints[t],i=!1;for(let e=0;e<this.constraints.length;e++)if(this.constraints[e]==s){i=!0;break}i||this.constraints.push(s)}let t=e.getAttachments();for(let e=0;e<t.length;e++){var s=t[e];this.setAttachment(s.slotIndex,s.name,s.attachment)}}copySkin(e){for(let t=0;t<e.bones.length;t++){let s=e.bones[t],i=!1;for(let e=0;e<this.bones.length;e++)if(this.bones[e]==s){i=!0;break}i||this.bones.push(s)}for(let t=0;t<e.constraints.length;t++){let s=e.constraints[t],i=!1;for(let e=0;e<this.constraints.length;e++)if(this.constraints[e]==s){i=!0;break}i||this.constraints.push(s)}let t=e.getAttachments();for(let e=0;e<t.length;e++){var s=t[e];s.attachment&&(s.attachment instanceof ss?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}}getAttachment(e,t){let s=this.attachments[e];return s?s[t]:null}removeAttachment(e,t){let s=this.attachments[e];s&&delete s[t]}getAttachments(){let e=new Array;for(var t=0;t<this.attachments.length;t++){let s=this.attachments[t];if(s)for(let i in s){let n=s[i];n&&e.push(new Ss(t,i,n))}}return e}getAttachmentsForSlot(e,t){let s=this.attachments[e];if(s)for(let i in s){let n=s[i];n&&t.push(new Ss(e,i,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,t){let s=0;for(let i=0;i<e.slots.length;i++){let n=e.slots[i],a=n.getAttachment();if(a&&s<t.attachments.length){let e=t.attachments[s];for(let t in e)if(a==e[t]){let e=this.getAttachment(s,t);e&&n.setAttachment(e);break}}s++}}}class Is{index=0;name;boneData;color=new Ce(1,1,1,1);darkColor=null;attachmentName=null;blendMode=Ht.Normal;visible=!0;constructor(e,t,s){if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=s}}($t=Ht||(Ht={}))[$t.Normal=0]="Normal",$t[$t.Additive=1]="Additive",$t[$t.Multiply=2]="Multiply",$t[$t.Screen=3]="Screen";class As extends cs{bones=new Array;_target=null;set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}mixRotate=0;mixX=0;mixY=0;mixScaleX=0;mixScaleY=0;mixShearY=0;offsetRotation=0;offsetX=0;offsetY=0;offsetScaleX=0;offsetScaleY=0;offsetShearY=0;relative=!1;local=!1;constructor(e){super(e,0,!1)}}class Es{scale=1;attachmentLoader;linkedMeshes=new Array;constructor(e){this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,s=new vs;s.name="";let i=new Cs(e),n=i.readInt32(),a=i.readInt32();s.hash=0==a&&0==n?null:a.toString(16)+n.toString(16),s.version=i.readString(),s.x=i.readFloat(),s.y=i.readFloat(),s.width=i.readFloat(),s.height=i.readFloat(),s.referenceScale=i.readFloat()*t;let r=i.readBoolean();r&&(s.fps=i.readFloat(),s.imagesPath=i.readString(),s.audioPath=i.readString());let o=0;o=i.readInt(!0);for(let e=0;e<o;e++){let e=i.readString();if(!e)throw new Error("String in string table must not be null.");i.strings.push(e)}o=i.readInt(!0);for(let e=0;e<o;e++){let n=i.readString();if(!n)throw new Error("Bone name must not be null.");let a=0==e?null:s.bones[i.readInt(!0)],o=new os(e,n,a);o.rotation=i.readFloat(),o.x=i.readFloat()*t,o.y=i.readFloat()*t,o.scaleX=i.readFloat(),o.scaleY=i.readFloat(),o.shearX=i.readFloat(),o.shearY=i.readFloat(),o.length=i.readFloat()*t,o.inherit=i.readByte(),o.skinRequired=i.readBoolean(),r&&(Ce.rgba8888ToColor(o.color,i.readInt32()),o.icon=i.readString()??void 0,o.visible=i.readBoolean()),s.bones.push(o)}o=i.readInt(!0);for(let e=0;e<o;e++){let t=i.readString();if(!t)throw new Error("Slot name must not be null.");let n=s.bones[i.readInt(!0)],a=new Is(e,t,n);Ce.rgba8888ToColor(a.color,i.readInt32());let o=i.readInt32();-1!=o&&Ce.rgb888ToColor(a.darkColor=new Ce,o),a.attachmentName=i.readStringRef(),a.blendMode=i.readInt(!0),r&&(a.visible=i.readBoolean()),s.slots.push(a)}o=i.readInt(!0);for(let e,n=0;n<o;n++){let n=i.readString();if(!n)throw new Error("IK constraint data name must not be null.");let a=new ds(n);a.order=i.readInt(!0),e=i.readInt(!0);for(let t=0;t<e;t++)a.bones.push(s.bones[i.readInt(!0)]);a.target=s.bones[i.readInt(!0)];let r=i.readByte();a.skinRequired=!!(1&r),a.bendDirection=2&r?1:-1,a.compress=!!(4&r),a.stretch=!!(8&r),a.uniform=!!(16&r),32&r&&(a.mix=64&r?i.readFloat():1),128&r&&(a.softness=i.readFloat()*t),s.ikConstraints.push(a)}o=i.readInt(!0);for(let e,n=0;n<o;n++){let n=i.readString();if(!n)throw new Error("Transform constraint data name must not be null.");let a=new As(n);a.order=i.readInt(!0),e=i.readInt(!0);for(let t=0;t<e;t++)a.bones.push(s.bones[i.readInt(!0)]);a.target=s.bones[i.readInt(!0)];let r=i.readByte();a.skinRequired=!!(1&r),a.local=!!(2&r),a.relative=!!(4&r),8&r&&(a.offsetRotation=i.readFloat()),16&r&&(a.offsetX=i.readFloat()*t),32&r&&(a.offsetY=i.readFloat()*t),64&r&&(a.offsetScaleX=i.readFloat()),128&r&&(a.offsetScaleY=i.readFloat()),r=i.readByte(),1&r&&(a.offsetShearY=i.readFloat()),2&r&&(a.mixRotate=i.readFloat()),4&r&&(a.mixX=i.readFloat()),8&r&&(a.mixY=i.readFloat()),16&r&&(a.mixScaleX=i.readFloat()),32&r&&(a.mixScaleY=i.readFloat()),64&r&&(a.mixShearY=i.readFloat()),s.transformConstraints.push(a)}o=i.readInt(!0);for(let e,n=0;n<o;n++){let n=i.readString();if(!n)throw new Error("Path constraint data name must not be null.");let a=new us(n);a.order=i.readInt(!0),a.skinRequired=i.readBoolean(),e=i.readInt(!0);for(let t=0;t<e;t++)a.bones.push(s.bones[i.readInt(!0)]);a.target=s.slots[i.readInt(!0)];const r=i.readByte();a.positionMode=1&r,a.spacingMode=r>>1&3,a.rotateMode=r>>3&3,128&r&&(a.offsetRotation=i.readFloat()),a.position=i.readFloat(),a.positionMode==Gt.Fixed&&(a.position*=t),a.spacing=i.readFloat(),a.spacingMode!=Wt.Length&&a.spacingMode!=Wt.Fixed||(a.spacing*=t),a.mixRotate=i.readFloat(),a.mixX=i.readFloat(),a.mixY=i.readFloat(),s.pathConstraints.push(a)}o=i.readInt(!0);for(let e=0;e<o;e++){const e=i.readString();if(!e)throw new Error("Physics constraint data name must not be null.");const n=new bs(e);n.order=i.readInt(!0),n.bone=s.bones[i.readInt(!0)];let a=i.readByte();n.skinRequired=!!(1&a),2&a&&(n.x=i.readFloat()),4&a&&(n.y=i.readFloat()),8&a&&(n.rotate=i.readFloat()),16&a&&(n.scaleX=i.readFloat()),32&a&&(n.shearX=i.readFloat()),n.limit=(64&a?i.readFloat():5e3)*t,n.step=1/i.readUnsignedByte(),n.inertia=i.readFloat(),n.strength=i.readFloat(),n.damping=i.readFloat(),n.massInverse=128&a?i.readFloat():1,n.wind=i.readFloat(),n.gravity=i.readFloat(),a=i.readByte(),1&a&&(n.inertiaGlobal=!0),2&a&&(n.strengthGlobal=!0),4&a&&(n.dampingGlobal=!0),8&a&&(n.massGlobal=!0),16&a&&(n.windGlobal=!0),32&a&&(n.gravityGlobal=!0),64&a&&(n.mixGlobal=!0),n.mix=128&a?i.readFloat():1,s.physicsConstraints.push(n)}let l=this.readSkin(i,s,!0,r);l&&(s.defaultSkin=l,s.skins.push(l));{let e=s.skins.length;for(Me.setArraySize(s.skins,o=e+i.readInt(!0));e<o;e++){let t=this.readSkin(i,s,!1,r);if(!t)throw new Error("readSkin() should not have returned null.");s.skins[e]=t}}o=this.linkedMeshes.length;for(let e=0;e<o;e++){let t=this.linkedMeshes[e];const i=s.skins[t.skinIndex];if(!t.parent)throw new Error("Linked mesh parent must not be null");let n=i.getAttachment(t.slotIndex,t.parent);if(!n)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?n:t.mesh,t.mesh.setParentMesh(n),null!=t.mesh.region&&t.mesh.updateRegion()}this.linkedMeshes.length=0,o=i.readInt(!0);for(let e=0;e<o;e++){let e=i.readString();if(!e)throw new Error("Event data name must not be null");let t=new ws(e);t.intValue=i.readInt(!1),t.floatValue=i.readFloat(),t.stringValue=i.readString(),t.audioPath=i.readString(),t.audioPath&&(t.volume=i.readFloat(),t.balance=i.readFloat()),s.events.push(t)}o=i.readInt(!0);for(let e=0;e<o;e++){let e=i.readString();if(!e)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(i,e,s))}return s}readSkin(e,t,s,i){let n=null,a=0;if(s){if(a=e.readInt(!0),0==a)return null;n=new ks("default")}else{let s=e.readString();if(!s)throw new Error("Skin name must not be null.");n=new ks(s),i&&Ce.rgba8888ToColor(n.color,e.readInt32()),n.bones.length=e.readInt(!0);for(let s=0,i=n.bones.length;s<i;s++)n.bones[s]=t.bones[e.readInt(!0)];for(let s=0,i=e.readInt(!0);s<i;s++)n.constraints.push(t.ikConstraints[e.readInt(!0)]);for(let s=0,i=e.readInt(!0);s<i;s++)n.constraints.push(t.transformConstraints[e.readInt(!0)]);for(let s=0,i=e.readInt(!0);s<i;s++)n.constraints.push(t.pathConstraints[e.readInt(!0)]);for(let s=0,i=e.readInt(!0);s<i;s++)n.constraints.push(t.physicsConstraints[e.readInt(!0)]);a=e.readInt(!0)}for(let s=0;s<a;s++){let s=e.readInt(!0);for(let a=0,r=e.readInt(!0);a<r;a++){let a=e.readStringRef();if(!a)throw new Error("Attachment name must not be null");let r=this.readAttachment(e,t,n,s,a,i);r&&n.setAttachment(s,a,r)}}return n}readAttachment(e,t,s,i,n,a){let r=this.scale,o=e.readByte();const l=8&o?e.readStringRef():n;if(!l)throw new Error("Attachment name must not be null");switch(7&o){case Jt.Region:{let t=16&o?e.readStringRef():null;const i=32&o?e.readInt32():4294967295,n=64&o?this.readSequence(e):null;let a=128&o?e.readFloat():0,h=e.readFloat(),c=e.readFloat(),d=e.readFloat(),u=e.readFloat(),p=e.readFloat(),m=e.readFloat();t||(t=l);let g=this.attachmentLoader.newRegionAttachment(s,l,t,n);return g?(g.path=t,g.x=h*r,g.y=c*r,g.scaleX=d,g.scaleY=u,g.rotation=a,g.width=p*r,g.height=m*r,Ce.rgba8888ToColor(g.color,i),g.sequence=n,null==n&&g.updateRegion(),g):null}case Jt.BoundingBox:{let t=this.readVertices(e,!!(16&o)),i=a?e.readInt32():0,n=this.attachmentLoader.newBoundingBoxAttachment(s,l);return n?(n.worldVerticesLength=t.length,n.vertices=t.vertices,n.bones=t.bones,a&&Ce.rgba8888ToColor(n.color,i),n):null}case Jt.Mesh:{let t=16&o?e.readStringRef():l;const i=32&o?e.readInt32():4294967295,n=64&o?this.readSequence(e):null,h=e.readInt(!0),c=this.readVertices(e,!!(128&o)),d=this.readFloatArray(e,c.length,1),u=this.readShortArray(e,3*(c.length-h-2));let p=[],m=0,g=0;a&&(p=this.readShortArray(e,e.readInt(!0)),m=e.readFloat(),g=e.readFloat()),t||(t=l);let f=this.attachmentLoader.newMeshAttachment(s,l,t,n);return f?(f.path=t,Ce.rgba8888ToColor(f.color,i),f.bones=c.bones,f.vertices=c.vertices,f.worldVerticesLength=c.length,f.triangles=u,f.regionUVs=d,null==n&&f.updateRegion(),f.hullLength=h<<1,f.sequence=n,a&&(f.edges=p,f.width=m*r,f.height=g*r),f):null}case Jt.LinkedMesh:{const t=16&o?e.readStringRef():l;if(null==t)throw new Error("Path of linked mesh must not be null");const n=32&o?e.readInt32():4294967295,h=64&o?this.readSequence(e):null,c=!!(128&o),d=e.readInt(!0),u=e.readStringRef();let p=0,m=0;a&&(p=e.readFloat(),m=e.readFloat());let g=this.attachmentLoader.newMeshAttachment(s,l,t,h);return g?(g.path=t,Ce.rgba8888ToColor(g.color,n),g.sequence=h,a&&(g.width=p*r,g.height=m*r),this.linkedMeshes.push(new Ps(g,d,i,u,c)),g):null}case Jt.Path:{const t=!!(16&o),i=!!(32&o),n=this.readVertices(e,!!(64&o)),h=Me.newArray(n.length/6,0);for(let t=0,s=h.length;t<s;t++)h[t]=e.readFloat()*r;const c=a?e.readInt32():0,d=this.attachmentLoader.newPathAttachment(s,l);return d?(d.closed=t,d.constantSpeed=i,d.worldVerticesLength=n.length,d.vertices=n.vertices,d.bones=n.bones,d.lengths=h,a&&Ce.rgba8888ToColor(d.color,c),d):null}case Jt.Point:{const t=e.readFloat(),i=e.readFloat(),n=e.readFloat(),o=a?e.readInt32():0,h=this.attachmentLoader.newPointAttachment(s,l);return h?(h.x=i*r,h.y=n*r,h.rotation=t,a&&Ce.rgba8888ToColor(h.color,o),h):null}case Jt.Clipping:{const i=e.readInt(!0),n=this.readVertices(e,!!(16&o));let r=a?e.readInt32():0,h=this.attachmentLoader.newClippingAttachment(s,l);return h?(h.endSlot=t.slots[i],h.worldVerticesLength=n.length,h.vertices=n.vertices,h.bones=n.bones,a&&Ce.rgba8888ToColor(h.color,r),h):null}}return null}readSequence(e){let t=new _e(e.readInt(!0));return t.start=e.readInt(!0),t.digits=e.readInt(!0),t.setupIndex=e.readInt(!0),t}readVertices(e,t){const s=this.scale,i=e.readInt(!0),n=new Ms;if(n.length=i<<1,!t)return n.vertices=this.readFloatArray(e,n.length,s),n;let a=new Array,r=new Array;for(let t=0;t<i;t++){let t=e.readInt(!0);r.push(t);for(let i=0;i<t;i++)r.push(e.readInt(!0)),a.push(e.readFloat()*s),a.push(e.readFloat()*s),a.push(e.readFloat())}return n.vertices=Me.toFloatArray(a),n.bones=r,n}readFloatArray(e,t,s){let i=new Array(t);if(1==s)for(let s=0;s<t;s++)i[s]=e.readFloat();else for(let n=0;n<t;n++)i[n]=e.readFloat()*s;return i}readShortArray(e,t){let s=new Array(t);for(let i=0;i<t;i++)s[i]=e.readInt(!0);return s}readAnimation(e,t,s){e.readInt(!0);let i=new Array,n=this.scale;for(let t=0,s=e.readInt(!0);t<s;t++){let t=e.readInt(!0);for(let s=0,n=e.readInt(!0);s<n;s++){let s=e.readByte(),n=e.readInt(!0),a=n-1;switch(s){case Gs:{let s=new ot(n,t);for(let t=0;t<n;t++)s.setFrame(t,e.readFloat(),e.readStringRef());i.push(s);break}case Ws:{let s=e.readInt(!0),r=new st(n,s,t),o=e.readFloat(),l=e.readUnsignedByte()/255,h=e.readUnsignedByte()/255,c=e.readUnsignedByte()/255,d=e.readUnsignedByte()/255;for(let t=0,s=0;r.setFrame(t,o,l,h,c,d),t!=a;t++){let i=e.readFloat(),n=e.readUnsignedByte()/255,a=e.readUnsignedByte()/255,u=e.readUnsignedByte()/255,p=e.readUnsignedByte()/255;switch(e.readByte()){case hi:r.setStepped(t);break;case ci:Bs(e,r,s++,t,0,o,i,l,n,1),Bs(e,r,s++,t,1,o,i,h,a,1),Bs(e,r,s++,t,2,o,i,c,u,1),Bs(e,r,s++,t,3,o,i,d,p,1)}o=i,l=n,h=a,c=u,d=p}i.push(r);break}case qs:{let s=e.readInt(!0),r=new it(n,s,t),o=e.readFloat(),l=e.readUnsignedByte()/255,h=e.readUnsignedByte()/255,c=e.readUnsignedByte()/255;for(let t=0,s=0;r.setFrame(t,o,l,h,c),t!=a;t++){let i=e.readFloat(),n=e.readUnsignedByte()/255,a=e.readUnsignedByte()/255,d=e.readUnsignedByte()/255;switch(e.readByte()){case hi:r.setStepped(t);break;case ci:Bs(e,r,s++,t,0,o,i,l,n,1),Bs(e,r,s++,t,1,o,i,h,a,1),Bs(e,r,s++,t,2,o,i,c,d,1)}o=i,l=n,h=a,c=d}i.push(r);break}case js:{let s=e.readInt(!0),r=new at(n,s,t),o=e.readFloat(),l=e.readUnsignedByte()/255,h=e.readUnsignedByte()/255,c=e.readUnsignedByte()/255,d=e.readUnsignedByte()/255,u=e.readUnsignedByte()/255,p=e.readUnsignedByte()/255,m=e.readUnsignedByte()/255;for(let t=0,s=0;r.setFrame(t,o,l,h,c,d,u,p,m),t!=a;t++){let i=e.readFloat(),n=e.readUnsignedByte()/255,a=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,f=e.readUnsignedByte()/255,y=e.readUnsignedByte()/255,x=e.readUnsignedByte()/255,w=e.readUnsignedByte()/255;switch(e.readByte()){case hi:r.setStepped(t);break;case ci:Bs(e,r,s++,t,0,o,i,l,n,1),Bs(e,r,s++,t,1,o,i,h,a,1),Bs(e,r,s++,t,2,o,i,c,g,1),Bs(e,r,s++,t,3,o,i,d,f,1),Bs(e,r,s++,t,4,o,i,u,y,1),Bs(e,r,s++,t,5,o,i,p,x,1),Bs(e,r,s++,t,6,o,i,m,w,1)}o=i,l=n,h=a,c=g,d=f,u=y,p=x,m=w}i.push(r);break}case Hs:{let s=e.readInt(!0),r=new rt(n,s,t),o=e.readFloat(),l=e.readUnsignedByte()/255,h=e.readUnsignedByte()/255,c=e.readUnsignedByte()/255,d=e.readUnsignedByte()/255,u=e.readUnsignedByte()/255,p=e.readUnsignedByte()/255;for(let t=0,s=0;r.setFrame(t,o,l,h,c,d,u,p),t!=a;t++){let i=e.readFloat(),n=e.readUnsignedByte()/255,a=e.readUnsignedByte()/255,m=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,f=e.readUnsignedByte()/255,y=e.readUnsignedByte()/255;switch(e.readByte()){case hi:r.setStepped(t);break;case ci:Bs(e,r,s++,t,0,o,i,l,n,1),Bs(e,r,s++,t,1,o,i,h,a,1),Bs(e,r,s++,t,2,o,i,c,m,1),Bs(e,r,s++,t,3,o,i,d,g,1),Bs(e,r,s++,t,4,o,i,u,f,1),Bs(e,r,s++,t,5,o,i,p,y,1)}o=i,l=n,h=a,c=m,d=g,u=f,p=y}i.push(r);break}case Js:{let s=new nt(n,e.readInt(!0),t),r=e.readFloat(),o=e.readUnsignedByte()/255;for(let t=0,i=0;s.setFrame(t,r,o),t!=a;t++){let n=e.readFloat(),a=e.readUnsignedByte()/255;switch(e.readByte()){case hi:s.setStepped(t);break;case ci:Bs(e,s,i++,t,0,r,n,o,a,1)}r=n,o=a}i.push(s)}}}}for(let t=0,s=e.readInt(!0);t<s;t++){let t=e.readInt(!0);for(let s=0,a=e.readInt(!0);s<a;s++){let s=e.readByte(),a=e.readInt(!0);if(s==zs){let s=new tt(a,t);for(let t=0;t<a;t++)s.setFrame(t,e.readFloat(),e.readByte());i.push(s);continue}let r=e.readInt(!0);switch(s){case Ls:i.push(Ts(e,new We(a,r,t),1));break;case _s:i.push(Rs(e,new qe(a,r,t),n));break;case Fs:i.push(Ts(e,new je(a,r,t),n));break;case Ds:i.push(Ts(e,new He(a,r,t),n));break;case Ys:i.push(Rs(e,new Je(a,r,t),1));break;case Os:i.push(Ts(e,new $e(a,r,t),1));break;case Xs:i.push(Ts(e,new Ke(a,r,t),1));break;case Vs:i.push(Rs(e,new Qe(a,r,t),1));break;case Ns:i.push(Ts(e,new Ze(a,r,t),1));break;case Us:i.push(Ts(e,new et(a,r,t),1))}}}for(let t=0,s=e.readInt(!0);t<s;t++){let t=e.readInt(!0),s=e.readInt(!0),a=s-1,r=new dt(s,e.readInt(!0),t),o=e.readByte(),l=e.readFloat(),h=1&o?2&o?e.readFloat():1:0,c=4&o?e.readFloat()*n:0;for(let t=0,s=0;r.setFrame(t,l,h,c,8&o?1:-1,!!(16&o),!!(32&o)),t!=a;t++){o=e.readByte();const i=e.readFloat(),a=1&o?2&o?e.readFloat():1:0,d=4&o?e.readFloat()*n:0;64&o?r.setStepped(t):128&o&&(Bs(e,r,s++,t,0,l,i,h,a,1),Bs(e,r,s++,t,1,l,i,c,d,n)),l=i,h=a,c=d}i.push(r)}for(let t=0,s=e.readInt(!0);t<s;t++){let t=e.readInt(!0),s=e.readInt(!0),n=s-1,a=new ut(s,e.readInt(!0),t),r=e.readFloat(),o=e.readFloat(),l=e.readFloat(),h=e.readFloat(),c=e.readFloat(),d=e.readFloat(),u=e.readFloat();for(let t=0,s=0;a.setFrame(t,r,o,l,h,c,d,u),t!=n;t++){let i=e.readFloat(),n=e.readFloat(),p=e.readFloat(),m=e.readFloat(),g=e.readFloat(),f=e.readFloat(),y=e.readFloat();switch(e.readByte()){case hi:a.setStepped(t);break;case ci:Bs(e,a,s++,t,0,r,i,o,n,1),Bs(e,a,s++,t,1,r,i,l,p,1),Bs(e,a,s++,t,2,r,i,h,m,1),Bs(e,a,s++,t,3,r,i,c,g,1),Bs(e,a,s++,t,4,r,i,d,f,1),Bs(e,a,s++,t,5,r,i,u,y,1)}r=i,o=n,l=p,h=m,c=g,d=f,u=y}i.push(a)}for(let t=0,a=e.readInt(!0);t<a;t++){let t=e.readInt(!0),a=s.pathConstraints[t];for(let s=0,r=e.readInt(!0);s<r;s++){const s=e.readByte(),r=e.readInt(!0),o=e.readInt(!0);switch(s){case Qs:i.push(Ts(e,new pt(r,o,t),a.positionMode==Gt.Fixed?n:1));break;case Zs:i.push(Ts(e,new mt(r,o,t),a.spacingMode==Wt.Length||a.spacingMode==Wt.Fixed?n:1));break;case ei:let s=new gt(r,o,t),l=e.readFloat(),h=e.readFloat(),c=e.readFloat(),d=e.readFloat();for(let t=0,i=0,n=s.getFrameCount()-1;s.setFrame(t,l,h,c,d),t!=n;t++){let n=e.readFloat(),a=e.readFloat(),r=e.readFloat(),o=e.readFloat();switch(e.readByte()){case hi:s.setStepped(t);break;case ci:Bs(e,s,i++,t,0,l,n,h,a,1),Bs(e,s,i++,t,1,l,n,c,r,1),Bs(e,s,i++,t,2,l,n,d,o,1)}l=n,h=a,c=r,d=o}i.push(s)}}}for(let t=0,s=e.readInt(!0);t<s;t++){const t=e.readInt(!0)-1;for(let s=0,n=e.readInt(!0);s<n;s++){const s=e.readByte(),n=e.readInt(!0);if(s==li){const s=new It(n,t);for(let t=0;t<n;t++)s.setFrame(t,e.readFloat());i.push(s);continue}const a=e.readInt(!0);switch(s){case ti:i.push(Ts(e,new yt(n,a,t),1));break;case si:i.push(Ts(e,new xt(n,a,t),1));break;case ii:i.push(Ts(e,new wt(n,a,t),1));break;case ni:i.push(Ts(e,new bt(n,a,t),1));break;case ai:i.push(Ts(e,new vt(n,a,t),1));break;case ri:i.push(Ts(e,new St(n,a,t),1));break;case oi:i.push(Ts(e,new kt(n,a,t),1))}}}for(let t=0,a=e.readInt(!0);t<a;t++){let t=s.skins[e.readInt(!0)];for(let s=0,a=e.readInt(!0);s<a;s++){let s=e.readInt(!0);for(let a=0,r=e.readInt(!0);a<r;a++){let a=e.readStringRef();if(!a)throw new Error("attachmentName must not be null.");let r=t.getAttachment(s,a),o=e.readByte(),l=e.readInt(!0),h=l-1;switch(o){case $s:{let t=r,a=t.bones,o=t.vertices,c=a?o.length/3*2:o.length,d=e.readInt(!0),u=new lt(l,d,s,t),p=e.readFloat();for(let t=0,s=0;;t++){let i,r=e.readInt(!0);if(0==r)i=a?Me.newFloatArray(c):o;else{i=Me.newFloatArray(c);let t=e.readInt(!0);if(r+=t,1==n)for(let s=t;s<r;s++)i[s]=e.readFloat();else for(let s=t;s<r;s++)i[s]=e.readFloat()*n;if(!a)for(let e=0,t=i.length;e<t;e++)i[e]+=o[e]}if(u.setFrame(t,p,i),t==h)break;let l=e.readFloat();switch(e.readByte()){case hi:u.setStepped(t);break;case ci:Bs(e,u,s++,t,0,p,l,0,1,1)}p=l}i.push(u);break}case Ks:{let t=new At(l,s,r);for(let s=0;s<l;s++){let i=e.readFloat(),n=e.readInt32();t.setFrame(s,i,De[15&n],n>>4,e.readFloat())}i.push(t);break}}}}}let a=e.readInt(!0);if(a>0){let t=new ct(a),n=s.slots.length;for(let s=0;s<a;s++){let i=e.readFloat(),a=e.readInt(!0),r=Me.newArray(n,0);for(let e=n-1;e>=0;e--)r[e]=-1;let o=Me.newArray(n-a,0),l=0,h=0;for(let t=0;t<a;t++){let t=e.readInt(!0);for(;l!=t;)o[h++]=l++;r[l+e.readInt(!0)]=l++}for(;l<n;)o[h++]=l++;for(let e=n-1;e>=0;e--)-1==r[e]&&(r[e]=o[--h]);t.setFrame(s,i,r)}i.push(t)}let r=e.readInt(!0);if(r>0){let t=new ht(r);for(let i=0;i<r;i++){let n=e.readFloat(),a=s.events[e.readInt(!0)],r=new xs(n,a);r.intValue=e.readInt(!1),r.floatValue=e.readFloat(),r.stringValue=e.readString(),null==r.stringValue&&(r.stringValue=a.stringValue),r.data.audioPath&&(r.volume=e.readFloat(),r.balance=e.readFloat()),t.setFrame(i,r)}i.push(t)}let o=0;for(let e=0,t=i.length;e<t;e++)o=Math.max(o,i[e].getDuration());return new Ye(t,i,o)}}class Cs{strings;index;buffer;constructor(e,t=new Array,s=0,i=new DataView(e instanceof ArrayBuffer?e:e.buffer)){this.strings=t,this.index=s,this.buffer=i}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let e=this.buffer.getInt16(this.index);return this.index+=2,e}readInt32(){let e=this.buffer.getInt32(this.index);return this.index+=4,e}readInt(e){let t=this.readByte(),s=127&t;return 128&t&&(t=this.readByte(),s|=(127&t)<<7,128&t&&(t=this.readByte(),s|=(127&t)<<14,128&t&&(t=this.readByte(),s|=(127&t)<<21,128&t&&(t=this.readByte(),s|=(127&t)<<28)))),e?s:s>>>1^-(1&s)}readStringRef(){let e=this.readInt(!0);return 0==e?null:this.strings[e-1]}readString(){let e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;let t="";for(let s=0;s<e;){let e=this.readUnsignedByte();switch(e>>4){case 12:case 13:t+=String.fromCharCode((31&e)<<6|63&this.readByte()),s+=2;break;case 14:t+=String.fromCharCode((15&e)<<12|(63&this.readByte())<<6|63&this.readByte()),s+=3;break;default:t+=String.fromCharCode(e),s++}}return t}readFloat(){let e=this.buffer.getFloat32(this.index);return this.index+=4,e}readBoolean(){return 0!=this.readByte()}}class Ps{parent;skinIndex;slotIndex;mesh;inheritTimeline;constructor(e,t,s,i,n){this.mesh=e,this.skinIndex=t,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}}class Ms{bones;vertices;length;constructor(e=null,t=null,s=0){this.bones=e,this.vertices=t,this.length=s}}function Ts(e,t,s){let i=e.readFloat(),n=e.readFloat()*s;for(let a=0,r=0,o=t.getFrameCount()-1;t.setFrame(a,i,n),a!=o;a++){let o=e.readFloat(),l=e.readFloat()*s;switch(e.readByte()){case hi:t.setStepped(a);break;case ci:Bs(e,t,r++,a,0,i,o,n,l,s)}i=o,n=l}return t}function Rs(e,t,s){let i=e.readFloat(),n=e.readFloat()*s,a=e.readFloat()*s;for(let r=0,o=0,l=t.getFrameCount()-1;t.setFrame(r,i,n,a),r!=l;r++){let l=e.readFloat(),h=e.readFloat()*s,c=e.readFloat()*s;switch(e.readByte()){case hi:t.setStepped(r);break;case ci:Bs(e,t,o++,r,0,i,l,n,h,s),Bs(e,t,o++,r,1,i,l,a,c,s)}i=l,n=h,a=c}return t}function Bs(e,t,s,i,n,a,r,o,l,h){t.setBezier(s,i,n,a,o,e.readFloat(),e.readFloat()*h,e.readFloat(),e.readFloat()*h,r,l)}!function(e){e[e.Region=0]="Region",e[e.BoundingBox=1]="BoundingBox",e[e.Mesh=2]="Mesh",e[e.LinkedMesh=3]="LinkedMesh",e[e.Path=4]="Path",e[e.Point=5]="Point",e[e.Clipping=6]="Clipping"}(Jt||(Jt={}));const Ls=0,_s=1,Fs=2,Ds=3,Ys=4,Os=5,Xs=6,Vs=7,Ns=8,Us=9,zs=10,Gs=0,Ws=1,qs=2,js=3,Hs=4,Js=5,$s=0,Ks=1,Qs=0,Zs=1,ei=2,ti=0,si=1,ii=2,ni=4,ai=5,ri=6,oi=7,li=8,hi=1,ci=2;class di{minX=0;minY=0;maxX=0;maxY=0;boundingBoxes=new Array;polygons=new Array;polygonPool=new Te((()=>Me.newFloatArray(16)));update(e,t){if(!e)throw new Error("skeleton cannot be null.");let s=this.boundingBoxes,i=this.polygons,n=this.polygonPool,a=e.slots,r=a.length;s.length=0,n.freeAll(i),i.length=0;for(let e=0;e<r;e++){let t=a[e];if(!t.bone.active)continue;let r=t.getAttachment();if(r instanceof Ot){let e=r;s.push(e);let a=n.obtain();a.length!=e.worldVerticesLength&&(a=Me.newFloatArray(e.worldVerticesLength)),i.push(a),e.computeWorldVertices(t,0,e.worldVerticesLength,a,0,2)}}t?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons;for(let a=0,r=n.length;a<r;a++){let r=n[a],o=r;for(let n=0,a=r.length;n<a;n+=2){let a=o[n],r=o[n+1];e=Math.min(e,a),t=Math.min(t,r),s=Math.max(s,a),i=Math.max(i,r)}}this.minX=e,this.minY=t,this.maxX=s,this.maxY=i}aabbContainsPoint(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY}aabbIntersectsSegment(e,t,s,i){let n=this.minX,a=this.minY,r=this.maxX,o=this.maxY;if(e<=n&&s<=n||t<=a&&i<=a||e>=r&&s>=r||t>=o&&i>=o)return!1;let l=(i-t)/(s-e),h=l*(n-e)+t;if(h>a&&h<o)return!0;if(h=l*(r-e)+t,h>a&&h<o)return!0;let c=(a-t)/l+e;return c>n&&c<r||(c=(o-t)/l+e,c>n&&c<r)}aabbIntersectsSkeleton(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY}containsPoint(e,t){let s=this.polygons;for(let i=0,n=s.length;i<n;i++)if(this.containsPointPolygon(s[i],e,t))return this.boundingBoxes[i];return null}containsPointPolygon(e,t,s){let i=e,n=e.length,a=n-2,r=!1;for(let e=0;e<n;e+=2){let n=i[e+1],o=i[a+1];if(n<s&&o>=s||o<s&&n>=s){let l=i[e];l+(s-n)/(o-n)*(i[a]-l)<t&&(r=!r)}a=e}return r}intersectsSegment(e,t,s,i){let n=this.polygons;for(let a=0,r=n.length;a<r;a++)if(this.intersectsSegmentPolygon(n[a],e,t,s,i))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(e,t,s,i,n){let a=e,r=e.length,o=t-i,l=s-n,h=t*n-s*i,c=a[r-2],d=a[r-1];for(let e=0;e<r;e+=2){let r=a[e],u=a[e+1],p=c*u-d*r,m=c-r,g=d-u,f=o*g-l*m,y=(h*m-o*p)/f;if((y>=c&&y<=r||y>=r&&y<=c)&&(y>=t&&y<=i||y>=i&&y<=t)){let e=(h*g-l*p)/f;if((e>=d&&e<=u||e>=u&&e<=d)&&(e>=s&&e<=n||e>=n&&e<=s))return!0}c=r,d=u}return!1}getPolygon(e){if(!e)throw new Error("boundingBox cannot be null.");let t=this.boundingBoxes.indexOf(e);return-1==t?null:this.polygons[t]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class ui{convexPolygons=new Array;convexPolygonsIndices=new Array;indicesArray=new Array;isConcaveArray=new Array;triangles=new Array;polygonPool=new Te((()=>new Array));polygonIndicesPool=new Te((()=>new Array));triangulate(e){let t=e,s=e.length>>1,i=this.indicesArray;i.length=0;for(let e=0;e<s;e++)i[e]=e;let n=this.isConcaveArray;n.length=0;for(let e=0,a=s;e<a;++e)n[e]=ui.isConcave(e,s,t,i);let a=this.triangles;for(a.length=0;s>3;){let e=s-1,r=0,o=1;for(;;){e:if(!n[r]){let a=i[e]<<1,l=i[r]<<1,h=i[o]<<1,c=t[a],d=t[a+1],u=t[l],p=t[l+1],m=t[h],g=t[h+1];for(let a=(o+1)%s;a!=e;a=(a+1)%s){if(!n[a])continue;let e=i[a]<<1,s=t[e],r=t[e+1];if(ui.positiveArea(m,g,c,d,s,r)&&ui.positiveArea(c,d,u,p,s,r)&&ui.positiveArea(u,p,m,g,s,r))break e}break}if(0==o){do{if(!n[r])break;r--}while(r>0);break}e=r,r=o,o=(o+1)%s}a.push(i[(s+r-1)%s]),a.push(i[r]),a.push(i[(r+1)%s]),i.splice(r,1),n.splice(r,1),s--;let l=(s+r-1)%s,h=r==s?0:r;n[l]=ui.isConcave(l,s,t,i),n[h]=ui.isConcave(h,s,t,i)}return 3==s&&(a.push(i[2]),a.push(i[0]),a.push(i[1])),a}decompose(e,t){let s=e,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let a=this.polygonIndicesPool.obtain();a.length=0;let r=this.polygonPool.obtain();r.length=0;let o=-1,l=0;for(let e=0,h=t.length;e<h;e+=3){let h=t[e]<<1,c=t[e+1]<<1,d=t[e+2]<<1,u=s[h],p=s[h+1],m=s[c],g=s[c+1],f=s[d],y=s[d+1],x=!1;if(o==h){let e=r.length-4,t=ui.winding(r[e],r[e+1],r[e+2],r[e+3],f,y),s=ui.winding(f,y,r[0],r[1],r[2],r[3]);t==l&&s==l&&(r.push(f),r.push(y),a.push(d),x=!0)}x||(r.length>0?(i.push(r),n.push(a)):(this.polygonPool.free(r),this.polygonIndicesPool.free(a)),r=this.polygonPool.obtain(),r.length=0,r.push(u),r.push(p),r.push(m),r.push(g),r.push(f),r.push(y),a=this.polygonIndicesPool.obtain(),a.length=0,a.push(h),a.push(c),a.push(d),l=ui.winding(u,p,m,g,f,y),o=h)}r.length>0&&(i.push(r),n.push(a));for(let e=0,t=i.length;e<t;e++){if(a=n[e],0==a.length)continue;let s=a[0],o=a[a.length-1];r=i[e];let l=r.length-4,h=r[l],c=r[l+1],d=r[l+2],u=r[l+3],p=r[0],m=r[1],g=r[2],f=r[3],y=ui.winding(h,c,d,u,p,m);for(let l=0;l<t;l++){if(l==e)continue;let t=n[l];if(3!=t.length)continue;let x=t[0],w=t[1],b=t[2],v=i[l],S=v[v.length-2],k=v[v.length-1];if(x!=s||w!=o)continue;let I=ui.winding(h,c,d,u,S,k),A=ui.winding(S,k,p,m,g,f);I==y&&A==y&&(v.length=0,t.length=0,r.push(S),r.push(k),a.push(b),h=d,c=u,d=S,u=k,l=0)}}for(let e=i.length-1;e>=0;e--)r=i[e],0==r.length&&(i.splice(e,1),this.polygonPool.free(r),a=n[e],n.splice(e,1),this.polygonIndicesPool.free(a));return i}static isConcave(e,t,s,i){let n=i[(t+e-1)%t]<<1,a=i[e]<<1,r=i[(e+1)%t]<<1;return!this.positiveArea(s[n],s[n+1],s[a],s[a+1],s[r],s[r+1])}static positiveArea(e,t,s,i,n,a){return e*(a-i)+s*(t-a)+n*(i-t)>=0}static winding(e,t,s,i,n,a){let r=s-e,o=i-t;return n*o-a*r+r*t-e*o>=0?1:-1}}class pi{triangulator=new ui;clippingPolygon=new Array;clipOutput=new Array;clippedVertices=new Array;clippedUVs=new Array;clippedTriangles=new Array;scratch=new Array;clipAttachment=null;clippingPolygons=null;clipStart(e,t){if(this.clipAttachment)return 0;this.clipAttachment=t;let s=t.worldVerticesLength,i=Me.setArraySize(this.clippingPolygon,s);t.computeWorldVertices(e,0,s,i,0,2);let n=this.clippingPolygon;pi.makeClockwise(n);let a=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let e=0,t=a.length;e<t;e++){let t=a[e];pi.makeClockwise(t),t.push(t[0]),t.push(t[1])}return a.length}clipEndWithSlot(e){this.clipAttachment&&this.clipAttachment.endSlot==e.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(e,t,s,i,n,a,r,o){let l,h,c,d,u,p;"number"==typeof t?(l=s,h=i,c=n,d=a,u=r,p=o):(l=t,h=s,c=i,d=n,u=a,p=r),c&&d&&u&&"boolean"==typeof p?this.clipTrianglesRender(e,l,h,c,d,u,p):this.clipTrianglesNoRender(e,l,h)}clipTrianglesNoRender(e,t,s){let i=this.clipOutput,n=this.clippedVertices,a=this.clippedTriangles,r=this.clippingPolygons,o=r.length,l=0;n.length=0,a.length=0;for(let h=0;h<s;h+=3){let s=t[h]<<1,c=e[s],d=e[s+1];s=t[h+1]<<1;let u=e[s],p=e[s+1];s=t[h+2]<<1;let m=e[s],g=e[s+1];for(let e=0;e<o;e++){let t=n.length;if(!this.clip(c,d,u,p,m,g,r[e],i)){let e=Me.setArraySize(n,t+6);e[t]=c,e[t+1]=d,e[t+2]=u,e[t+3]=p,e[t+4]=m,e[t+5]=g,t=a.length;let s=Me.setArraySize(a,t+3);s[t]=l,s[t+1]=l+1,s[t+2]=l+2,l+=3;break}{let e=i.length;if(0==e)continue;let s=e>>1,r=this.clipOutput,o=Me.setArraySize(n,t+2*s);for(let s=0;s<e;s+=2,t+=2){let e=r[s],i=r[s+1];o[t]=e,o[t+1]=i}t=a.length;let h=Me.setArraySize(a,t+3*(s-2));s--;for(let e=1;e<s;e++,t+=3)h[t]=l,h[t+1]=l+e,h[t+2]=l+e+1;l+=s+1}}}}clipTrianglesRender(e,t,s,i,n,a,r){let o=this.clipOutput,l=this.clippedVertices,h=this.clippedTriangles,c=this.clippingPolygons,d=c.length,u=r?12:8,p=0;l.length=0,h.length=0;for(let m=0;m<s;m+=3){let s=t[m]<<1,g=e[s],f=e[s+1],y=i[s],x=i[s+1];s=t[m+1]<<1;let w=e[s],b=e[s+1],v=i[s],S=i[s+1];s=t[m+2]<<1;let k=e[s],I=e[s+1],A=i[s],E=i[s+1];for(let e=0;e<d;e++){let t=l.length;if(!this.clip(g,f,w,b,k,I,c[e],o)){let e=Me.setArraySize(l,t+3*u);e[t]=g,e[t+1]=f,e[t+2]=n.r,e[t+3]=n.g,e[t+4]=n.b,e[t+5]=n.a,r?(e[t+6]=y,e[t+7]=x,e[t+8]=a.r,e[t+9]=a.g,e[t+10]=a.b,e[t+11]=a.a,e[t+12]=w,e[t+13]=b,e[t+14]=n.r,e[t+15]=n.g,e[t+16]=n.b,e[t+17]=n.a,e[t+18]=v,e[t+19]=S,e[t+20]=a.r,e[t+21]=a.g,e[t+22]=a.b,e[t+23]=a.a,e[t+24]=k,e[t+25]=I,e[t+26]=n.r,e[t+27]=n.g,e[t+28]=n.b,e[t+29]=n.a,e[t+30]=A,e[t+31]=E,e[t+32]=a.r,e[t+33]=a.g,e[t+34]=a.b,e[t+35]=a.a):(e[t+6]=y,e[t+7]=x,e[t+8]=w,e[t+9]=b,e[t+10]=n.r,e[t+11]=n.g,e[t+12]=n.b,e[t+13]=n.a,e[t+14]=v,e[t+15]=S,e[t+16]=k,e[t+17]=I,e[t+18]=n.r,e[t+19]=n.g,e[t+20]=n.b,e[t+21]=n.a,e[t+22]=A,e[t+23]=E),t=h.length;let s=Me.setArraySize(h,t+3);s[t]=p,s[t+1]=p+1,s[t+2]=p+2,p+=3;break}{let e=o.length;if(0==e)continue;let s=b-I,i=k-w,c=g-k,d=I-f,m=1/(s*c+i*(f-I)),C=e>>1,P=this.clipOutput,M=Me.setArraySize(l,t+C*u);for(let o=0;o<e;o+=2,t+=u){let e=P[o],l=P[o+1];M[t]=e,M[t+1]=l,M[t+2]=n.r,M[t+3]=n.g,M[t+4]=n.b,M[t+5]=n.a;let h=e-k,u=l-I,p=(s*h+i*u)*m,g=(d*h+c*u)*m,f=1-p-g;M[t+6]=y*p+v*g+A*f,M[t+7]=x*p+S*g+E*f,r&&(M[t+8]=a.r,M[t+9]=a.g,M[t+10]=a.b,M[t+11]=a.a)}t=h.length;let T=Me.setArraySize(h,t+3*(C-2));C--;for(let e=1;e<C;e++,t+=3)T[t]=p,T[t+1]=p+e,T[t+2]=p+e+1;p+=C+1}}}}clipTrianglesUnpacked(e,t,s,i){let n=this.clipOutput,a=this.clippedVertices,r=this.clippedUVs,o=this.clippedTriangles,l=this.clippingPolygons,h=l.length,c=0;a.length=0,r.length=0,o.length=0;for(let d=0;d<s;d+=3){let s=t[d]<<1,u=e[s],p=e[s+1],m=i[s],g=i[s+1];s=t[d+1]<<1;let f=e[s],y=e[s+1],x=i[s],w=i[s+1];s=t[d+2]<<1;let b=e[s],v=e[s+1],S=i[s],k=i[s+1];for(let e=0;e<h;e++){let t=a.length;if(!this.clip(u,p,f,y,b,v,l[e],n)){let e=Me.setArraySize(a,t+6);e[t]=u,e[t+1]=p,e[t+2]=f,e[t+3]=y,e[t+4]=b,e[t+5]=v;let s=Me.setArraySize(r,t+6);s[t]=m,s[t+1]=g,s[t+2]=x,s[t+3]=w,s[t+4]=S,s[t+5]=k,t=o.length;let i=Me.setArraySize(o,t+3);i[t]=c,i[t+1]=c+1,i[t+2]=c+2,c+=3;break}{let e=n.length;if(0==e)continue;let s=y-v,i=b-f,l=u-b,h=v-p,d=1/(s*l+i*(p-v)),I=e>>1,A=this.clipOutput,E=Me.setArraySize(a,t+2*I),C=Me.setArraySize(r,t+2*I);for(let n=0;n<e;n+=2,t+=2){let e=A[n],a=A[n+1];E[t]=e,E[t+1]=a;let r=e-b,o=a-v,c=(s*r+i*o)*d,u=(h*r+l*o)*d,p=1-c-u;C[t]=m*c+x*u+S*p,C[t+1]=g*c+w*u+k*p}t=o.length;let P=Me.setArraySize(o,t+3*(I-2));I--;for(let e=1;e<I;e++,t+=3)P[t]=c,P[t+1]=c+e,P[t+2]=c+e+1;c+=I+1}}}}clip(e,t,s,i,n,a,r,o){let l,h=o,c=!1;r.length%4>=2?(l=o,o=this.scratch):l=this.scratch,l.length=0,l.push(e),l.push(t),l.push(s),l.push(i),l.push(n),l.push(a),l.push(e),l.push(t),o.length=0;let d=r.length-4,u=r;for(let e=0;;e+=2){let t=u[e],s=u[e+1],i=t-u[e+2],n=s-u[e+3],a=o.length,r=l;for(let e=0,a=l.length-2;e<a;){let a=r[e],l=r[e+1];e+=2;let h=r[e],d=r[e+1],u=n*(t-h)>i*(s-d),p=n*(t-a)-i*(s-l);if(p>0){if(u){o.push(h),o.push(d);continue}let e=h-a,t=d-l,s=p/(e*n-t*i);if(!(s>=0&&s<=1)){o.push(h),o.push(d);continue}o.push(a+e*s),o.push(l+t*s)}else if(u){let e=h-a,t=d-l,s=p/(e*n-t*i);if(!(s>=0&&s<=1)){o.push(h),o.push(d);continue}o.push(a+e*s),o.push(l+t*s),o.push(h),o.push(d)}c=!0}if(a==o.length)return h.length=0,!0;if(o.push(o[0]),o.push(o[1]),e==d)break;let p=o;(o=l).length=0,l=p}if(h!=o){h.length=0;for(let e=0,t=o.length-2;e<t;e++)h[e]=o[e]}else h.length=h.length-2;return c}static makeClockwise(e){let t=e,s=e.length,i=t[s-2]*t[1]-t[0]*t[s-1],n=0,a=0,r=0,o=0;for(let e=0,l=s-3;e<l;e+=2)n=t[e],a=t[e+1],r=t[e+2],o=t[e+3],i+=n*o-r*a;if(!(i<0))for(let e=0,i=s-2,n=s>>1;e<n;e+=2){let s=t[e],n=t[e+1],a=i-e;t[e]=t[a],t[e+1]=t[a+1],t[a]=s,t[a+1]=n}}}class mi{attachmentLoader;scale=1;linkedMeshes=new Array;constructor(e){this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,s=new vs,i="string"==typeof e?JSON.parse(e):e,n=i.skeleton;if(n&&(s.hash=n.hash,s.version=n.spine,s.x=n.x,s.y=n.y,s.width=n.width,s.height=n.height,s.referenceScale=wi(n,"referenceScale",100)*t,s.fps=n.fps,s.imagesPath=n.images??null,s.audioPath=n.audio??null),i.bones)for(let e=0;e<i.bones.length;e++){let n=i.bones[e],a=null,r=wi(n,"parent",null);r&&(a=s.findBone(r));let o=new os(s.bones.length,n.name,a);o.length=wi(n,"length",0)*t,o.x=wi(n,"x",0)*t,o.y=wi(n,"y",0)*t,o.rotation=wi(n,"rotation",0),o.scaleX=wi(n,"scaleX",1),o.scaleY=wi(n,"scaleY",1),o.shearX=wi(n,"shearX",0),o.shearY=wi(n,"shearY",0),o.inherit=Me.enumValue(zt,wi(n,"inherit","Normal")),o.skinRequired=wi(n,"skin",!1);let l=wi(n,"color",null);l&&o.color.setFromString(l),s.bones.push(o)}if(i.slots)for(let e=0;e<i.slots.length;e++){let t=i.slots[e],n=t.name,a=s.findBone(t.bone);if(!a)throw new Error(`Couldn't find bone ${t.bone} for slot ${n}`);let r=new Is(s.slots.length,n,a),o=wi(t,"color",null);o&&r.color.setFromString(o);let l=wi(t,"dark",null);l&&(r.darkColor=Ce.fromString(l)),r.attachmentName=wi(t,"attachment",null),r.blendMode=Me.enumValue(Ht,wi(t,"blend","normal")),r.visible=wi(t,"visible",!0),s.slots.push(r)}if(i.ik)for(let e=0;e<i.ik.length;e++){let n=i.ik[e],a=new ds(n.name);a.order=wi(n,"order",0),a.skinRequired=wi(n,"skin",!1);for(let e=0;e<n.bones.length;e++){let t=s.findBone(n.bones[e]);if(!t)throw new Error(`Couldn't find bone ${n.bones[e]} for IK constraint ${n.name}.`);a.bones.push(t)}let r=s.findBone(n.target);if(!r)throw new Error(`Couldn't find target bone ${n.target} for IK constraint ${n.name}.`);a.target=r,a.mix=wi(n,"mix",1),a.softness=wi(n,"softness",0)*t,a.bendDirection=wi(n,"bendPositive",!0)?1:-1,a.compress=wi(n,"compress",!1),a.stretch=wi(n,"stretch",!1),a.uniform=wi(n,"uniform",!1),s.ikConstraints.push(a)}if(i.transform)for(let e=0;e<i.transform.length;e++){let n=i.transform[e],a=new As(n.name);a.order=wi(n,"order",0),a.skinRequired=wi(n,"skin",!1);for(let e=0;e<n.bones.length;e++){let t=n.bones[e],i=s.findBone(t);if(!i)throw new Error(`Couldn't find bone ${t} for transform constraint ${n.name}.`);a.bones.push(i)}let r=n.target,o=s.findBone(r);if(!o)throw new Error(`Couldn't find target bone ${r} for transform constraint ${n.name}.`);a.target=o,a.local=wi(n,"local",!1),a.relative=wi(n,"relative",!1),a.offsetRotation=wi(n,"rotation",0),a.offsetX=wi(n,"x",0)*t,a.offsetY=wi(n,"y",0)*t,a.offsetScaleX=wi(n,"scaleX",0),a.offsetScaleY=wi(n,"scaleY",0),a.offsetShearY=wi(n,"shearY",0),a.mixRotate=wi(n,"mixRotate",1),a.mixX=wi(n,"mixX",1),a.mixY=wi(n,"mixY",a.mixX),a.mixScaleX=wi(n,"mixScaleX",1),a.mixScaleY=wi(n,"mixScaleY",a.mixScaleX),a.mixShearY=wi(n,"mixShearY",1),s.transformConstraints.push(a)}if(i.path)for(let e=0;e<i.path.length;e++){let n=i.path[e],a=new us(n.name);a.order=wi(n,"order",0),a.skinRequired=wi(n,"skin",!1);for(let e=0;e<n.bones.length;e++){let t=n.bones[e],i=s.findBone(t);if(!i)throw new Error(`Couldn't find bone ${t} for path constraint ${n.name}.`);a.bones.push(i)}let r=n.target,o=s.findSlot(r);if(!o)throw new Error(`Couldn't find target slot ${r} for path constraint ${n.name}.`);a.target=o,a.positionMode=Me.enumValue(Gt,wi(n,"positionMode","Percent")),a.spacingMode=Me.enumValue(Wt,wi(n,"spacingMode","Length")),a.rotateMode=Me.enumValue(qt,wi(n,"rotateMode","Tangent")),a.offsetRotation=wi(n,"rotation",0),a.position=wi(n,"position",0),a.positionMode==Gt.Fixed&&(a.position*=t),a.spacing=wi(n,"spacing",0),a.spacingMode!=Wt.Length&&a.spacingMode!=Wt.Fixed||(a.spacing*=t),a.mixRotate=wi(n,"mixRotate",1),a.mixX=wi(n,"mixX",1),a.mixY=wi(n,"mixY",a.mixX),s.pathConstraints.push(a)}if(i.physics)for(let e=0;e<i.physics.length;e++){const n=i.physics[e],a=new bs(n.name);a.order=wi(n,"order",0),a.skinRequired=wi(n,"skin",!1);const r=n.bone,o=s.findBone(r);if(null==o)throw new Error("Physics bone not found: "+r);a.bone=o,a.x=wi(n,"x",0),a.y=wi(n,"y",0),a.rotate=wi(n,"rotate",0),a.scaleX=wi(n,"scaleX",0),a.shearX=wi(n,"shearX",0),a.limit=wi(n,"limit",5e3)*t,a.step=1/wi(n,"fps",60),a.inertia=wi(n,"inertia",1),a.strength=wi(n,"strength",100),a.damping=wi(n,"damping",1),a.massInverse=1/wi(n,"mass",1),a.wind=wi(n,"wind",0),a.gravity=wi(n,"gravity",0),a.mix=wi(n,"mix",1),a.inertiaGlobal=wi(n,"inertiaGlobal",!1),a.strengthGlobal=wi(n,"strengthGlobal",!1),a.dampingGlobal=wi(n,"dampingGlobal",!1),a.massGlobal=wi(n,"massGlobal",!1),a.windGlobal=wi(n,"windGlobal",!1),a.gravityGlobal=wi(n,"gravityGlobal",!1),a.mixGlobal=wi(n,"mixGlobal",!1),s.physicsConstraints.push(a)}if(i.skins)for(let e=0;e<i.skins.length;e++){let t=i.skins[e],n=new ks(t.name);if(t.bones)for(let e=0;e<t.bones.length;e++){let i=t.bones[e],a=s.findBone(i);if(!a)throw new Error(`Couldn't find bone ${i} for skin ${t.name}.`);n.bones.push(a)}if(t.ik)for(let e=0;e<t.ik.length;e++){let i=t.ik[e],a=s.findIkConstraint(i);if(!a)throw new Error(`Couldn't find IK constraint ${i} for skin ${t.name}.`);n.constraints.push(a)}if(t.transform)for(let e=0;e<t.transform.length;e++){let i=t.transform[e],a=s.findTransformConstraint(i);if(!a)throw new Error(`Couldn't find transform constraint ${i} for skin ${t.name}.`);n.constraints.push(a)}if(t.path)for(let e=0;e<t.path.length;e++){let i=t.path[e],a=s.findPathConstraint(i);if(!a)throw new Error(`Couldn't find path constraint ${i} for skin ${t.name}.`);n.constraints.push(a)}if(t.physics)for(let e=0;e<t.physics.length;e++){let i=t.physics[e],a=s.findPhysicsConstraint(i);if(!a)throw new Error(`Couldn't find physics constraint ${i} for skin ${t.name}.`);n.constraints.push(a)}for(let e in t.attachments){let i=s.findSlot(e);if(!i)throw new Error(`Couldn't find slot ${e} for skin ${t.name}.`);let a=t.attachments[e];for(let e in a){let t=this.readAttachment(a[e],n,i.index,e,s);t&&n.setAttachment(i.index,e,t)}}s.skins.push(n),"default"==n.name&&(s.defaultSkin=n)}for(let e=0,t=this.linkedMeshes.length;e<t;e++){let t=this.linkedMeshes[e],i=t.skin?s.findSkin(t.skin):s.defaultSkin;if(!i)throw new Error(`Skin not found: ${t.skin}`);let n=i.getAttachment(t.slotIndex,t.parent);if(!n)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?n:t.mesh,t.mesh.setParentMesh(n),null!=t.mesh.region&&t.mesh.updateRegion()}if(this.linkedMeshes.length=0,i.events)for(let e in i.events){let t=i.events[e],n=new ws(e);n.intValue=wi(t,"int",0),n.floatValue=wi(t,"float",0),n.stringValue=wi(t,"string",""),n.audioPath=wi(t,"audio",null),n.audioPath&&(n.volume=wi(t,"volume",1),n.balance=wi(t,"balance",0)),s.events.push(n)}if(i.animations)for(let e in i.animations){let t=i.animations[e];this.readAnimation(t,e,s)}return s}readAttachment(e,t,s,i,n){let a=this.scale;switch(i=wi(e,"name",i),wi(e,"type","region")){case"region":{let s=wi(e,"path",i),n=this.readSequence(wi(e,"sequence",null)),r=this.attachmentLoader.newRegionAttachment(t,i,s,n);if(!r)return null;r.path=s,r.x=wi(e,"x",0)*a,r.y=wi(e,"y",0)*a,r.scaleX=wi(e,"scaleX",1),r.scaleY=wi(e,"scaleY",1),r.rotation=wi(e,"rotation",0),r.width=e.width*a,r.height=e.height*a,r.sequence=n;let o=wi(e,"color",null);return o&&r.color.setFromString(o),null!=r.region&&r.updateRegion(),r}case"boundingbox":{let s=this.attachmentLoader.newBoundingBoxAttachment(t,i);if(!s)return null;this.readVertices(e,s,e.vertexCount<<1);let n=wi(e,"color",null);return n&&s.color.setFromString(n),s}case"mesh":case"linkedmesh":{let n=wi(e,"path",i),r=this.readSequence(wi(e,"sequence",null)),o=this.attachmentLoader.newMeshAttachment(t,i,n,r);if(!o)return null;o.path=n;let l=wi(e,"color",null);l&&o.color.setFromString(l),o.width=wi(e,"width",0)*a,o.height=wi(e,"height",0)*a,o.sequence=r;let h=wi(e,"parent",null);if(h)return this.linkedMeshes.push(new gi(o,wi(e,"skin",null),s,h,wi(e,"timelines",!0))),o;let c=e.uvs;return this.readVertices(e,o,c.length),o.triangles=e.triangles,o.regionUVs=c,null!=o.region&&o.updateRegion(),o.edges=wi(e,"edges",null),o.hullLength=2*wi(e,"hull",0),o}case"path":{let s=this.attachmentLoader.newPathAttachment(t,i);if(!s)return null;s.closed=wi(e,"closed",!1),s.constantSpeed=wi(e,"constantSpeed",!0);let n=e.vertexCount;this.readVertices(e,s,n<<1);let r=Me.newArray(n/3,0);for(let t=0;t<e.lengths.length;t++)r[t]=e.lengths[t]*a;s.lengths=r;let o=wi(e,"color",null);return o&&s.color.setFromString(o),s}case"point":{let s=this.attachmentLoader.newPointAttachment(t,i);if(!s)return null;s.x=wi(e,"x",0)*a,s.y=wi(e,"y",0)*a,s.rotation=wi(e,"rotation",0);let n=wi(e,"color",null);return n&&s.color.setFromString(n),s}case"clipping":{let s=this.attachmentLoader.newClippingAttachment(t,i);if(!s)return null;let a=wi(e,"end",null);a&&(s.endSlot=n.findSlot(a));let r=e.vertexCount;this.readVertices(e,s,r<<1);let o=wi(e,"color",null);return o&&s.color.setFromString(o),s}}return null}readSequence(e){if(null==e)return null;let t=new _e(wi(e,"count",0));return t.start=wi(e,"start",1),t.digits=wi(e,"digits",0),t.setupIndex=wi(e,"setup",0),t}readVertices(e,t,s){let i=this.scale;t.worldVerticesLength=s;let n=e.vertices;if(s==n.length){let e=Me.toFloatArray(n);if(1!=i)for(let t=0,s=n.length;t<s;t++)e[t]*=i;return void(t.vertices=e)}let a=new Array,r=new Array;for(let e=0,t=n.length;e<t;){let t=n[e++];r.push(t);for(let s=e+4*t;e<s;e+=4)r.push(n[e]),a.push(n[e+1]*i),a.push(n[e+2]*i),a.push(n[e+3])}t.bones=r,t.vertices=Me.toFloatArray(a)}readAnimation(e,t,s){let i=this.scale,n=new Array;if(e.slots)for(let t in e.slots){let i=e.slots[t],a=s.findSlot(t);if(!a)throw new Error("Slot not found: "+t);let r=a.index;for(let e in i){let t=i[e];if(!t)continue;let s=t.length;if("attachment"==e){let e=new ot(s,r);for(let i=0;i<s;i++){let s=t[i];e.setFrame(i,wi(s,"time",0),wi(s,"name",null))}n.push(e)}else if("rgba"==e){let e=new st(s,s<<2,r),i=t[0],a=wi(i,"time",0),o=Ce.fromString(i.color);for(let s=0,n=0;;s++){e.setFrame(s,a,o.r,o.g,o.b,o.a);let r=t[s+1];if(!r){e.shrink(n);break}let l=wi(r,"time",0),h=Ce.fromString(r.color),c=i.curve;c&&(n=xi(c,e,n,s,0,a,l,o.r,h.r,1),n=xi(c,e,n,s,1,a,l,o.g,h.g,1),n=xi(c,e,n,s,2,a,l,o.b,h.b,1),n=xi(c,e,n,s,3,a,l,o.a,h.a,1)),a=l,o=h,i=r}n.push(e)}else if("rgb"==e){let e=new it(s,3*s,r),i=t[0],a=wi(i,"time",0),o=Ce.fromString(i.color);for(let s=0,n=0;;s++){e.setFrame(s,a,o.r,o.g,o.b);let r=t[s+1];if(!r){e.shrink(n);break}let l=wi(r,"time",0),h=Ce.fromString(r.color),c=i.curve;c&&(n=xi(c,e,n,s,0,a,l,o.r,h.r,1),n=xi(c,e,n,s,1,a,l,o.g,h.g,1),n=xi(c,e,n,s,2,a,l,o.b,h.b,1)),a=l,o=h,i=r}n.push(e)}else if("alpha"==e)n.push(fi(t,new nt(s,s,r),0,1));else if("rgba2"==e){let e=new at(s,7*s,r),i=t[0],a=wi(i,"time",0),o=Ce.fromString(i.light),l=Ce.fromString(i.dark);for(let s=0,n=0;;s++){e.setFrame(s,a,o.r,o.g,o.b,o.a,l.r,l.g,l.b);let r=t[s+1];if(!r){e.shrink(n);break}let h=wi(r,"time",0),c=Ce.fromString(r.light),d=Ce.fromString(r.dark),u=i.curve;u&&(n=xi(u,e,n,s,0,a,h,o.r,c.r,1),n=xi(u,e,n,s,1,a,h,o.g,c.g,1),n=xi(u,e,n,s,2,a,h,o.b,c.b,1),n=xi(u,e,n,s,3,a,h,o.a,c.a,1),n=xi(u,e,n,s,4,a,h,l.r,d.r,1),n=xi(u,e,n,s,5,a,h,l.g,d.g,1),n=xi(u,e,n,s,6,a,h,l.b,d.b,1)),a=h,o=c,l=d,i=r}n.push(e)}else if("rgb2"==e){let e=new rt(s,6*s,r),i=t[0],a=wi(i,"time",0),o=Ce.fromString(i.light),l=Ce.fromString(i.dark);for(let s=0,n=0;;s++){e.setFrame(s,a,o.r,o.g,o.b,l.r,l.g,l.b);let r=t[s+1];if(!r){e.shrink(n);break}let h=wi(r,"time",0),c=Ce.fromString(r.light),d=Ce.fromString(r.dark),u=i.curve;u&&(n=xi(u,e,n,s,0,a,h,o.r,c.r,1),n=xi(u,e,n,s,1,a,h,o.g,c.g,1),n=xi(u,e,n,s,2,a,h,o.b,c.b,1),n=xi(u,e,n,s,3,a,h,l.r,d.r,1),n=xi(u,e,n,s,4,a,h,l.g,d.g,1),n=xi(u,e,n,s,5,a,h,l.b,d.b,1)),a=h,o=c,l=d,i=r}n.push(e)}}}if(e.bones)for(let t in e.bones){let a=e.bones[t],r=s.findBone(t);if(!r)throw new Error("Bone not found: "+t);let o=r.index;for(let e in a){let t=a[e],s=t.length;if(0!=s)if("rotate"===e)n.push(fi(t,new We(s,s,o),0,1));else if("translate"===e){let e=new qe(s,s<<1,o);n.push(yi(t,e,"x","y",0,i))}else if("translatex"===e){let e=new je(s,s,o);n.push(fi(t,e,0,i))}else if("translatey"===e){let e=new He(s,s,o);n.push(fi(t,e,0,i))}else if("scale"===e){let e=new Je(s,s<<1,o);n.push(yi(t,e,"x","y",1,1))}else if("scalex"===e){let e=new $e(s,s,o);n.push(fi(t,e,1,1))}else if("scaley"===e){let e=new Ke(s,s,o);n.push(fi(t,e,1,1))}else if("shear"===e){let e=new Qe(s,s<<1,o);n.push(yi(t,e,"x","y",0,1))}else if("shearx"===e){let e=new Ze(s,s,o);n.push(fi(t,e,0,1))}else if("sheary"===e){let e=new et(s,s,o);n.push(fi(t,e,0,1))}else if("inherit"===e){let e=new tt(s,r.index);for(let s=0;s<t.length;s++){let i=t[s];e.setFrame(s,wi(i,"time",0),Me.enumValue(zt,wi(i,"inherit","Normal")))}n.push(e)}}}if(e.ik)for(let t in e.ik){let a=e.ik[t],r=a[0];if(!r)continue;let o=s.findIkConstraint(t);if(!o)throw new Error("IK Constraint not found: "+t);let l=s.ikConstraints.indexOf(o),h=new dt(a.length,a.length<<1,l),c=wi(r,"time",0),d=wi(r,"mix",1),u=wi(r,"softness",0)*i;for(let e=0,t=0;;e++){h.setFrame(e,c,d,u,wi(r,"bendPositive",!0)?1:-1,wi(r,"compress",!1),wi(r,"stretch",!1));let s=a[e+1];if(!s){h.shrink(t);break}let n=wi(s,"time",0),o=wi(s,"mix",1),l=wi(s,"softness",0)*i,p=r.curve;p&&(t=xi(p,h,t,e,0,c,n,d,o,1),t=xi(p,h,t,e,1,c,n,u,l,i)),c=n,d=o,u=l,r=s}n.push(h)}if(e.transform)for(let t in e.transform){let i=e.transform[t],a=i[0];if(!a)continue;let r=s.findTransformConstraint(t);if(!r)throw new Error("Transform constraint not found: "+t);let o=s.transformConstraints.indexOf(r),l=new ut(i.length,6*i.length,o),h=wi(a,"time",0),c=wi(a,"mixRotate",1),d=wi(a,"mixX",1),u=wi(a,"mixY",d),p=wi(a,"mixScaleX",1),m=wi(a,"mixScaleY",p),g=wi(a,"mixShearY",1);for(let e=0,t=0;;e++){l.setFrame(e,h,c,d,u,p,m,g);let s=i[e+1];if(!s){l.shrink(t);break}let n=wi(s,"time",0),r=wi(s,"mixRotate",1),o=wi(s,"mixX",1),f=wi(s,"mixY",o),y=wi(s,"mixScaleX",1),x=wi(s,"mixScaleY",y),w=wi(s,"mixShearY",1),b=a.curve;b&&(t=xi(b,l,t,e,0,h,n,c,r,1),t=xi(b,l,t,e,1,h,n,d,o,1),t=xi(b,l,t,e,2,h,n,u,f,1),t=xi(b,l,t,e,3,h,n,p,y,1),t=xi(b,l,t,e,4,h,n,m,x,1),t=xi(b,l,t,e,5,h,n,g,w,1)),h=n,c=r,d=o,u=f,p=y,m=x,p=y,a=s}n.push(l)}if(e.path)for(let t in e.path){let a=e.path[t],r=s.findPathConstraint(t);if(!r)throw new Error("Path constraint not found: "+t);let o=s.pathConstraints.indexOf(r);for(let e in a){let t=a[e],s=t[0];if(!s)continue;let l=t.length;if("position"===e){let e=new pt(l,l,o);n.push(fi(t,e,0,r.positionMode==Gt.Fixed?i:1))}else if("spacing"===e){let e=new mt(l,l,o);n.push(fi(t,e,0,r.spacingMode==Wt.Length||r.spacingMode==Wt.Fixed?i:1))}else if("mix"===e){let e=new gt(l,3*l,o),i=wi(s,"time",0),a=wi(s,"mixRotate",1),r=wi(s,"mixX",1),h=wi(s,"mixY",r);for(let n=0,o=0;;n++){e.setFrame(n,i,a,r,h);let l=t[n+1];if(!l){e.shrink(o);break}let c=wi(l,"time",0),d=wi(l,"mixRotate",1),u=wi(l,"mixX",1),p=wi(l,"mixY",u),m=s.curve;m&&(o=xi(m,e,o,n,0,i,c,a,d,1),o=xi(m,e,o,n,1,i,c,r,u,1),o=xi(m,e,o,n,2,i,c,h,p,1)),i=c,a=d,r=u,h=p,s=l}n.push(e)}}}if(e.physics)for(let t in e.physics){let i=e.physics[t],a=-1;if(t.length>0){let e=s.findPhysicsConstraint(t);if(!e)throw new Error("Physics constraint not found: "+t);a=s.physicsConstraints.indexOf(e)}for(let e in i){let t=i[e],s=t[0];if(!s)continue;let r,o=t.length;if("reset"!=e){if("inertia"==e)r=new yt(o,o,a);else if("strength"==e)r=new xt(o,o,a);else if("damping"==e)r=new wt(o,o,a);else if("mass"==e)r=new bt(o,o,a);else if("wind"==e)r=new vt(o,o,a);else if("gravity"==e)r=new St(o,o,a);else{if("mix"!=e)continue;r=new kt(o,o,a)}n.push(fi(t,r,0,1))}else{const e=new It(o,a);for(let i=0;null!=s;s=t[i+1],i++)e.setFrame(i,wi(s,"time",0));n.push(e)}}}if(e.attachments)for(let t in e.attachments){let a=e.attachments[t],r=s.findSkin(t);if(!r)throw new Error("Skin not found: "+t);for(let e in a){let t=a[e],o=s.findSlot(e);if(!o)throw new Error("Slot not found: "+e);let l=o.index;for(let e in t){let s=t[e],a=r.getAttachment(l,e);for(let e in s){let t=s[e],r=t[0];if(r)if("deform"==e){let e=a.bones,s=a.vertices,o=e?s.length/3*2:s.length,h=new lt(t.length,t.length,l,a),c=wi(r,"time",0);for(let n=0,a=0;;n++){let l,d=wi(r,"vertices",null);if(d){l=Me.newFloatArray(o);let t=wi(r,"offset",0);if(Me.arrayCopy(d,0,l,t,d.length),1!=i)for(let e=t,s=e+d.length;e<s;e++)l[e]*=i;if(!e)for(let e=0;e<o;e++)l[e]+=s[e]}else l=e?Me.newFloatArray(o):s;h.setFrame(n,c,l);let u=t[n+1];if(!u){h.shrink(a);break}let p=wi(u,"time",0),m=r.curve;m&&(a=xi(m,h,a,n,0,c,p,0,1,1)),c=p,r=u}n.push(h)}else if("sequence"==e){let e=new At(t.length,l,a),s=0;for(let i=0;i<t.length;i++){let n=wi(r,"delay",s),a=wi(r,"time",0),o=Fe[wi(r,"mode","hold")],l=wi(r,"index",0);e.setFrame(i,a,o,l,n),s=n,r=t[i+1]}n.push(e)}}}}}if(e.drawOrder){let t=new ct(e.drawOrder.length),i=s.slots.length,a=0;for(let n=0;n<e.drawOrder.length;n++,a++){let r=e.drawOrder[n],o=null,l=wi(r,"offsets",null);if(l){o=Me.newArray(i,-1);let e=Me.newArray(i-l.length,0),t=0,n=0;for(let i=0;i<l.length;i++){let a=l[i],r=s.findSlot(a.slot);if(!r)throw new Error("Slot not found: "+r);let h=r.index;for(;t!=h;)e[n++]=t++;o[t+a.offset]=t++}for(;t<i;)e[n++]=t++;for(let t=i-1;t>=0;t--)-1==o[t]&&(o[t]=e[--n])}t.setFrame(a,wi(r,"time",0),o)}n.push(t)}if(e.events){let t=new ht(e.events.length),i=0;for(let n=0;n<e.events.length;n++,i++){let a=e.events[n],r=s.findEvent(a.name);if(!r)throw new Error("Event not found: "+a.name);let o=new xs(Me.toSinglePrecision(wi(a,"time",0)),r);o.intValue=wi(a,"int",r.intValue),o.floatValue=wi(a,"float",r.floatValue),o.stringValue=wi(a,"string",r.stringValue),o.data.audioPath&&(o.volume=wi(a,"volume",1),o.balance=wi(a,"balance",0)),t.setFrame(i,o)}n.push(t)}let a=0;for(let e=0,t=n.length;e<t;e++)a=Math.max(a,n[e].getDuration());s.animations.push(new Ye(t,n,a))}}class gi{parent;skin;slotIndex;mesh;inheritTimeline;constructor(e,t,s,i,n){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}}function fi(e,t,s,i){let n=e[0],a=wi(n,"time",0),r=wi(n,"value",s)*i,o=0;for(let l=0;;l++){t.setFrame(l,a,r);let h=e[l+1];if(!h)return t.shrink(o),t;let c=wi(h,"time",0),d=wi(h,"value",s)*i;n.curve&&(o=xi(n.curve,t,o,l,0,a,c,r,d,i)),a=c,r=d,n=h}}function yi(e,t,s,i,n,a){let r=e[0],o=wi(r,"time",0),l=wi(r,s,n)*a,h=wi(r,i,n)*a,c=0;for(let d=0;;d++){t.setFrame(d,o,l,h);let u=e[d+1];if(!u)return t.shrink(c),t;let p=wi(u,"time",0),m=wi(u,s,n)*a,g=wi(u,i,n)*a,f=r.curve;f&&(c=xi(f,t,c,d,0,o,p,l,m,a),c=xi(f,t,c,d,1,o,p,h,g,a)),o=p,l=m,h=g,r=u}}function xi(e,t,s,i,n,a,r,o,l,h){if("stepped"==e)return t.setStepped(i),s;let c=n<<2,d=e[c],u=e[c+1]*h,p=e[c+2],m=e[c+3]*h;return t.setBezier(s,i,n,a,o,d,u,p,m,r,l),s+1}function wi(e,t,s){return void 0!==e[t]?e[t]:s}var bi;void 0===Math.fround&&(Math.fround=(bi=new Float32Array(1),function(e){return bi[0]=e,bi[0]}));class vi{canvas;gl;restorables=new Array;constructor(e,t={alpha:"true"}){if(e instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)this.gl=e,this.canvas=this.gl.canvas;else{let s=e;this.gl=s.getContext("webgl2",t)||s.getContext("webgl",t),this.canvas=s,s.addEventListener("webglcontextlost",(e=>{e&&e.preventDefault()})),s.addEventListener("webglcontextrestored",(e=>{for(let e=0,t=this.restorables.length;e<t;e++)this.restorables[e].restore()}))}}addRestorable(e){this.restorables.push(e)}removeRestorable(e){let t=this.restorables.indexOf(e);t>-1&&this.restorables.splice(t,1)}}class Si extends Vt{context;texture=null;boundUnit=0;useMipMaps=!1;static DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1;constructor(e,t,s=!1){super(t),this.context=e instanceof vi?e:new vi(e),this.useMipMaps=s,this.restore(),this.context.addRestorable(this)}setFilters(e,t){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,Si.validateMagFilter(t)),this.useMipMaps=Si.usesMipMaps(e),this.useMipMaps&&s.generateMipmap(s.TEXTURE_2D)}static validateMagFilter(e){switch(e){case Nt.MipMapLinearLinear:case Nt.MipMapLinearNearest:case Nt.MipMapNearestLinear:case Nt.MipMapNearestNearest:return Nt.Linear;default:return e}}static usesMipMaps(e){switch(e){case Nt.MipMapLinearLinear:case Nt.MipMapLinearNearest:case Nt.MipMapNearestLinear:case Nt.MipMapNearestNearest:return!0;default:return!1}}setWraps(e,t){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t)}update(e){let t=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),Si.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this._image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR_MIPMAP_LINEAR:t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e&&t.generateMipmap(t.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(e=0){let t=this.context.gl;this.boundUnit=e,t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)}unbind(){let e=this.context.gl;e.activeTexture(e.TEXTURE0+this.boundUnit),e.bindTexture(e.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}}class ki{x=0;y=0;z=0;constructor(e=0,t=0,s=0){this.x=e,this.y=t,this.z=s}setFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}set(e,t,s){return this.x=e,this.y=t,this.z=s,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}scale(e){return this.x*=e,this.y*=e,this.z*=e,this}normalize(){let e=this.length();return 0==e||(e=1/e,this.x*=e,this.y*=e,this.z*=e),this}cross(e){return this.set(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}multiply(e){let t=e.values;return this.set(this.x*t[Ii]+this.y*t[Ai]+this.z*t[Ei]+t[Ci],this.x*t[Pi]+this.y*t[Mi]+this.z*t[Ti]+t[Ri],this.x*t[Bi]+this.y*t[Li]+this.z*t[_i]+t[Fi])}project(e){let t=e.values,s=1/(this.x*t[Di]+this.y*t[Yi]+this.z*t[Oi]+t[Xi]);return this.set((this.x*t[Ii]+this.y*t[Ai]+this.z*t[Ei]+t[Ci])*s,(this.x*t[Pi]+this.y*t[Mi]+this.z*t[Ti]+t[Ri])*s,(this.x*t[Bi]+this.y*t[Li]+this.z*t[_i]+t[Fi])*s)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(e){let t=e.x-this.x,s=e.y-this.y,i=e.z-this.z;return Math.sqrt(t*t+s*s+i*i)}}const Ii=0,Ai=4,Ei=8,Ci=12,Pi=1,Mi=5,Ti=9,Ri=13,Bi=2,Li=6,_i=10,Fi=14,Di=3,Yi=7,Oi=11,Xi=15;class Vi{temp=new Float32Array(16);values=new Float32Array(16);static xAxis=new ki;static yAxis=new ki;static zAxis=new ki;static tmpMatrix=new Vi;constructor(){let e=this.values;e[Ii]=1,e[Mi]=1,e[_i]=1,e[Xi]=1}set(e){return this.values.set(e),this}transpose(){let e=this.temp,t=this.values;return e[Ii]=t[Ii],e[Ai]=t[Pi],e[Ei]=t[Bi],e[Ci]=t[Di],e[Pi]=t[Ai],e[Mi]=t[Mi],e[Ti]=t[Li],e[Ri]=t[Yi],e[Bi]=t[Ei],e[Li]=t[Ti],e[_i]=t[_i],e[Fi]=t[Oi],e[Di]=t[Ci],e[Yi]=t[Ri],e[Oi]=t[Fi],e[Xi]=t[Xi],this.set(e)}identity(){let e=this.values;return e[Ii]=1,e[Ai]=0,e[Ei]=0,e[Ci]=0,e[Pi]=0,e[Mi]=1,e[Ti]=0,e[Ri]=0,e[Bi]=0,e[Li]=0,e[_i]=1,e[Fi]=0,e[Di]=0,e[Yi]=0,e[Oi]=0,e[Xi]=1,this}invert(){let e=this.values,t=this.temp,s=e[Di]*e[Li]*e[Ti]*e[Ci]-e[Bi]*e[Yi]*e[Ti]*e[Ci]-e[Di]*e[Mi]*e[_i]*e[Ci]+e[Pi]*e[Yi]*e[_i]*e[Ci]+e[Bi]*e[Mi]*e[Oi]*e[Ci]-e[Pi]*e[Li]*e[Oi]*e[Ci]-e[Di]*e[Li]*e[Ei]*e[Ri]+e[Bi]*e[Yi]*e[Ei]*e[Ri]+e[Di]*e[Ai]*e[_i]*e[Ri]-e[Ii]*e[Yi]*e[_i]*e[Ri]-e[Bi]*e[Ai]*e[Oi]*e[Ri]+e[Ii]*e[Li]*e[Oi]*e[Ri]+e[Di]*e[Mi]*e[Ei]*e[Fi]-e[Pi]*e[Yi]*e[Ei]*e[Fi]-e[Di]*e[Ai]*e[Ti]*e[Fi]+e[Ii]*e[Yi]*e[Ti]*e[Fi]+e[Pi]*e[Ai]*e[Oi]*e[Fi]-e[Ii]*e[Mi]*e[Oi]*e[Fi]-e[Bi]*e[Mi]*e[Ei]*e[Xi]+e[Pi]*e[Li]*e[Ei]*e[Xi]+e[Bi]*e[Ai]*e[Ti]*e[Xi]-e[Ii]*e[Li]*e[Ti]*e[Xi]-e[Pi]*e[Ai]*e[_i]*e[Xi]+e[Ii]*e[Mi]*e[_i]*e[Xi];if(0==s)throw new Error("non-invertible matrix");let i=1/s;return t[Ii]=e[Ti]*e[Fi]*e[Yi]-e[Ri]*e[_i]*e[Yi]+e[Ri]*e[Li]*e[Oi]-e[Mi]*e[Fi]*e[Oi]-e[Ti]*e[Li]*e[Xi]+e[Mi]*e[_i]*e[Xi],t[Ai]=e[Ci]*e[_i]*e[Yi]-e[Ei]*e[Fi]*e[Yi]-e[Ci]*e[Li]*e[Oi]+e[Ai]*e[Fi]*e[Oi]+e[Ei]*e[Li]*e[Xi]-e[Ai]*e[_i]*e[Xi],t[Ei]=e[Ei]*e[Ri]*e[Yi]-e[Ci]*e[Ti]*e[Yi]+e[Ci]*e[Mi]*e[Oi]-e[Ai]*e[Ri]*e[Oi]-e[Ei]*e[Mi]*e[Xi]+e[Ai]*e[Ti]*e[Xi],t[Ci]=e[Ci]*e[Ti]*e[Li]-e[Ei]*e[Ri]*e[Li]-e[Ci]*e[Mi]*e[_i]+e[Ai]*e[Ri]*e[_i]+e[Ei]*e[Mi]*e[Fi]-e[Ai]*e[Ti]*e[Fi],t[Pi]=e[Ri]*e[_i]*e[Di]-e[Ti]*e[Fi]*e[Di]-e[Ri]*e[Bi]*e[Oi]+e[Pi]*e[Fi]*e[Oi]+e[Ti]*e[Bi]*e[Xi]-e[Pi]*e[_i]*e[Xi],t[Mi]=e[Ei]*e[Fi]*e[Di]-e[Ci]*e[_i]*e[Di]+e[Ci]*e[Bi]*e[Oi]-e[Ii]*e[Fi]*e[Oi]-e[Ei]*e[Bi]*e[Xi]+e[Ii]*e[_i]*e[Xi],t[Ti]=e[Ci]*e[Ti]*e[Di]-e[Ei]*e[Ri]*e[Di]-e[Ci]*e[Pi]*e[Oi]+e[Ii]*e[Ri]*e[Oi]+e[Ei]*e[Pi]*e[Xi]-e[Ii]*e[Ti]*e[Xi],t[Ri]=e[Ei]*e[Ri]*e[Bi]-e[Ci]*e[Ti]*e[Bi]+e[Ci]*e[Pi]*e[_i]-e[Ii]*e[Ri]*e[_i]-e[Ei]*e[Pi]*e[Fi]+e[Ii]*e[Ti]*e[Fi],t[Bi]=e[Mi]*e[Fi]*e[Di]-e[Ri]*e[Li]*e[Di]+e[Ri]*e[Bi]*e[Yi]-e[Pi]*e[Fi]*e[Yi]-e[Mi]*e[Bi]*e[Xi]+e[Pi]*e[Li]*e[Xi],t[Li]=e[Ci]*e[Li]*e[Di]-e[Ai]*e[Fi]*e[Di]-e[Ci]*e[Bi]*e[Yi]+e[Ii]*e[Fi]*e[Yi]+e[Ai]*e[Bi]*e[Xi]-e[Ii]*e[Li]*e[Xi],t[_i]=e[Ai]*e[Ri]*e[Di]-e[Ci]*e[Mi]*e[Di]+e[Ci]*e[Pi]*e[Yi]-e[Ii]*e[Ri]*e[Yi]-e[Ai]*e[Pi]*e[Xi]+e[Ii]*e[Mi]*e[Xi],t[Fi]=e[Ci]*e[Mi]*e[Bi]-e[Ai]*e[Ri]*e[Bi]-e[Ci]*e[Pi]*e[Li]+e[Ii]*e[Ri]*e[Li]+e[Ai]*e[Pi]*e[Fi]-e[Ii]*e[Mi]*e[Fi],t[Di]=e[Ti]*e[Li]*e[Di]-e[Mi]*e[_i]*e[Di]-e[Ti]*e[Bi]*e[Yi]+e[Pi]*e[_i]*e[Yi]+e[Mi]*e[Bi]*e[Oi]-e[Pi]*e[Li]*e[Oi],t[Yi]=e[Ai]*e[_i]*e[Di]-e[Ei]*e[Li]*e[Di]+e[Ei]*e[Bi]*e[Yi]-e[Ii]*e[_i]*e[Yi]-e[Ai]*e[Bi]*e[Oi]+e[Ii]*e[Li]*e[Oi],t[Oi]=e[Ei]*e[Mi]*e[Di]-e[Ai]*e[Ti]*e[Di]-e[Ei]*e[Pi]*e[Yi]+e[Ii]*e[Ti]*e[Yi]+e[Ai]*e[Pi]*e[Oi]-e[Ii]*e[Mi]*e[Oi],t[Xi]=e[Ai]*e[Ti]*e[Bi]-e[Ei]*e[Mi]*e[Bi]+e[Ei]*e[Pi]*e[Li]-e[Ii]*e[Ti]*e[Li]-e[Ai]*e[Pi]*e[_i]+e[Ii]*e[Mi]*e[_i],e[Ii]=t[Ii]*i,e[Ai]=t[Ai]*i,e[Ei]=t[Ei]*i,e[Ci]=t[Ci]*i,e[Pi]=t[Pi]*i,e[Mi]=t[Mi]*i,e[Ti]=t[Ti]*i,e[Ri]=t[Ri]*i,e[Bi]=t[Bi]*i,e[Li]=t[Li]*i,e[_i]=t[_i]*i,e[Fi]=t[Fi]*i,e[Di]=t[Di]*i,e[Yi]=t[Yi]*i,e[Oi]=t[Oi]*i,e[Xi]=t[Xi]*i,this}determinant(){let e=this.values;return e[Di]*e[Li]*e[Ti]*e[Ci]-e[Bi]*e[Yi]*e[Ti]*e[Ci]-e[Di]*e[Mi]*e[_i]*e[Ci]+e[Pi]*e[Yi]*e[_i]*e[Ci]+e[Bi]*e[Mi]*e[Oi]*e[Ci]-e[Pi]*e[Li]*e[Oi]*e[Ci]-e[Di]*e[Li]*e[Ei]*e[Ri]+e[Bi]*e[Yi]*e[Ei]*e[Ri]+e[Di]*e[Ai]*e[_i]*e[Ri]-e[Ii]*e[Yi]*e[_i]*e[Ri]-e[Bi]*e[Ai]*e[Oi]*e[Ri]+e[Ii]*e[Li]*e[Oi]*e[Ri]+e[Di]*e[Mi]*e[Ei]*e[Fi]-e[Pi]*e[Yi]*e[Ei]*e[Fi]-e[Di]*e[Ai]*e[Ti]*e[Fi]+e[Ii]*e[Yi]*e[Ti]*e[Fi]+e[Pi]*e[Ai]*e[Oi]*e[Fi]-e[Ii]*e[Mi]*e[Oi]*e[Fi]-e[Bi]*e[Mi]*e[Ei]*e[Xi]+e[Pi]*e[Li]*e[Ei]*e[Xi]+e[Bi]*e[Ai]*e[Ti]*e[Xi]-e[Ii]*e[Li]*e[Ti]*e[Xi]-e[Pi]*e[Ai]*e[_i]*e[Xi]+e[Ii]*e[Mi]*e[_i]*e[Xi]}translate(e,t,s){let i=this.values;return i[Ci]+=e,i[Ri]+=t,i[Fi]+=s,this}copy(){return(new Vi).set(this.values)}projection(e,t,s,i){this.identity();let n=1/Math.tan(s*(Math.PI/180)/2),a=(t+e)/(e-t),r=2*t*e/(e-t),o=this.values;return o[Ii]=n/i,o[Pi]=0,o[Bi]=0,o[Di]=0,o[Ai]=0,o[Mi]=n,o[Li]=0,o[Yi]=0,o[Ei]=0,o[Ti]=0,o[_i]=a,o[Oi]=-1,o[Ci]=0,o[Ri]=0,o[Fi]=r,o[Xi]=0,this}ortho2d(e,t,s,i){return this.ortho(e,e+s,t,t+i,0,1)}ortho(e,t,s,i,n,a){this.identity();let r=2/(t-e),o=2/(i-s),l=-2/(a-n),h=-(t+e)/(t-e),c=-(i+s)/(i-s),d=-(a+n)/(a-n),u=this.values;return u[Ii]=r,u[Pi]=0,u[Bi]=0,u[Di]=0,u[Ai]=0,u[Mi]=o,u[Li]=0,u[Yi]=0,u[Ei]=0,u[Ti]=0,u[_i]=l,u[Oi]=0,u[Ci]=h,u[Ri]=c,u[Fi]=d,u[Xi]=1,this}multiply(e){let t=this.temp,s=this.values,i=e.values;return t[Ii]=s[Ii]*i[Ii]+s[Ai]*i[Pi]+s[Ei]*i[Bi]+s[Ci]*i[Di],t[Ai]=s[Ii]*i[Ai]+s[Ai]*i[Mi]+s[Ei]*i[Li]+s[Ci]*i[Yi],t[Ei]=s[Ii]*i[Ei]+s[Ai]*i[Ti]+s[Ei]*i[_i]+s[Ci]*i[Oi],t[Ci]=s[Ii]*i[Ci]+s[Ai]*i[Ri]+s[Ei]*i[Fi]+s[Ci]*i[Xi],t[Pi]=s[Pi]*i[Ii]+s[Mi]*i[Pi]+s[Ti]*i[Bi]+s[Ri]*i[Di],t[Mi]=s[Pi]*i[Ai]+s[Mi]*i[Mi]+s[Ti]*i[Li]+s[Ri]*i[Yi],t[Ti]=s[Pi]*i[Ei]+s[Mi]*i[Ti]+s[Ti]*i[_i]+s[Ri]*i[Oi],t[Ri]=s[Pi]*i[Ci]+s[Mi]*i[Ri]+s[Ti]*i[Fi]+s[Ri]*i[Xi],t[Bi]=s[Bi]*i[Ii]+s[Li]*i[Pi]+s[_i]*i[Bi]+s[Fi]*i[Di],t[Li]=s[Bi]*i[Ai]+s[Li]*i[Mi]+s[_i]*i[Li]+s[Fi]*i[Yi],t[_i]=s[Bi]*i[Ei]+s[Li]*i[Ti]+s[_i]*i[_i]+s[Fi]*i[Oi],t[Fi]=s[Bi]*i[Ci]+s[Li]*i[Ri]+s[_i]*i[Fi]+s[Fi]*i[Xi],t[Di]=s[Di]*i[Ii]+s[Yi]*i[Pi]+s[Oi]*i[Bi]+s[Xi]*i[Di],t[Yi]=s[Di]*i[Ai]+s[Yi]*i[Mi]+s[Oi]*i[Li]+s[Xi]*i[Yi],t[Oi]=s[Di]*i[Ei]+s[Yi]*i[Ti]+s[Oi]*i[_i]+s[Xi]*i[Oi],t[Xi]=s[Di]*i[Ci]+s[Yi]*i[Ri]+s[Oi]*i[Fi]+s[Xi]*i[Xi],this.set(this.temp)}multiplyLeft(e){let t=this.temp,s=this.values,i=e.values;return t[Ii]=i[Ii]*s[Ii]+i[Ai]*s[Pi]+i[Ei]*s[Bi]+i[Ci]*s[Di],t[Ai]=i[Ii]*s[Ai]+i[Ai]*s[Mi]+i[Ei]*s[Li]+i[Ci]*s[Yi],t[Ei]=i[Ii]*s[Ei]+i[Ai]*s[Ti]+i[Ei]*s[_i]+i[Ci]*s[Oi],t[Ci]=i[Ii]*s[Ci]+i[Ai]*s[Ri]+i[Ei]*s[Fi]+i[Ci]*s[Xi],t[Pi]=i[Pi]*s[Ii]+i[Mi]*s[Pi]+i[Ti]*s[Bi]+i[Ri]*s[Di],t[Mi]=i[Pi]*s[Ai]+i[Mi]*s[Mi]+i[Ti]*s[Li]+i[Ri]*s[Yi],t[Ti]=i[Pi]*s[Ei]+i[Mi]*s[Ti]+i[Ti]*s[_i]+i[Ri]*s[Oi],t[Ri]=i[Pi]*s[Ci]+i[Mi]*s[Ri]+i[Ti]*s[Fi]+i[Ri]*s[Xi],t[Bi]=i[Bi]*s[Ii]+i[Li]*s[Pi]+i[_i]*s[Bi]+i[Fi]*s[Di],t[Li]=i[Bi]*s[Ai]+i[Li]*s[Mi]+i[_i]*s[Li]+i[Fi]*s[Yi],t[_i]=i[Bi]*s[Ei]+i[Li]*s[Ti]+i[_i]*s[_i]+i[Fi]*s[Oi],t[Fi]=i[Bi]*s[Ci]+i[Li]*s[Ri]+i[_i]*s[Fi]+i[Fi]*s[Xi],t[Di]=i[Di]*s[Ii]+i[Yi]*s[Pi]+i[Oi]*s[Bi]+i[Xi]*s[Di],t[Yi]=i[Di]*s[Ai]+i[Yi]*s[Mi]+i[Oi]*s[Li]+i[Xi]*s[Yi],t[Oi]=i[Di]*s[Ei]+i[Yi]*s[Ti]+i[Oi]*s[_i]+i[Xi]*s[Oi],t[Xi]=i[Di]*s[Ci]+i[Yi]*s[Ri]+i[Oi]*s[Fi]+i[Xi]*s[Xi],this.set(this.temp)}lookAt(e,t,s){let i=Vi.xAxis,n=Vi.yAxis,a=Vi.zAxis;a.setFrom(t).normalize(),i.setFrom(t).normalize(),i.cross(s).normalize(),n.setFrom(i).cross(a).normalize(),this.identity();let r=this.values;return r[Ii]=i.x,r[Ai]=i.y,r[Ei]=i.z,r[Pi]=n.x,r[Mi]=n.y,r[Ti]=n.z,r[Bi]=-a.x,r[Li]=-a.y,r[_i]=-a.z,Vi.tmpMatrix.identity(),Vi.tmpMatrix.values[Ci]=-e.x,Vi.tmpMatrix.values[Ri]=-e.y,Vi.tmpMatrix.values[Fi]=-e.z,this.multiply(Vi.tmpMatrix),this}}class Ni{position=new ki(0,0,0);direction=new ki(0,0,-1);up=new ki(0,1,0);near=0;far=100;zoom=1;viewportWidth=0;viewportHeight=0;projectionView=new Vi;inverseProjectionView=new Vi;projection=new Vi;view=new Vi;constructor(e,t){this.viewportWidth=e,this.viewportHeight=t,this.update()}update(){let e=this.projection,t=this.view,s=this.projectionView,i=this.inverseProjectionView,n=this.zoom,a=this.viewportWidth,r=this.viewportHeight;e.ortho(n*(-a/2),n*(a/2),n*(-r/2),n*(r/2),this.near,this.far),t.lookAt(this.position,this.direction,this.up),s.set(e.values),s.multiply(t),i.set(s.values).invert()}screenToWorld(e,t,s){let i=e.x,n=s-e.y-1;return e.x=2*i/t-1,e.y=2*n/s-1,e.z=2*e.z-1,e.project(this.inverseProjectionView),e}worldToScreen(e,t,s){return e.project(this.projectionView),e.x=t*(e.x+1)/2,e.y=s*(e.y+1)/2,e.z=(e.z+1)/2,e}setViewport(e,t){this.viewportWidth=e,this.viewportHeight=t}}class Ui{vertexShader;fragmentShader;static MVP_MATRIX="u_projTrans";static POSITION="a_position";static COLOR="a_color";static COLOR2="a_color2";static TEXCOORDS="a_texCoords";static SAMPLER="u_texture";context;vs=null;vsSource;fs=null;fsSource;program=null;tmp2x2=new Float32Array(4);tmp3x3=new Float32Array(9);tmp4x4=new Float32Array(16);getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}constructor(e,t,s){this.vertexShader=t,this.fragmentShader=s,this.vsSource=t,this.fsSource=s,this.context=e instanceof vi?e:new vi(e),this.context.addRestorable(this),this.compile()}compile(){let e=this.context.gl;try{if(this.vs=this.compileShader(e.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(e.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}compileShader(e,t){let s=this.context.gl,i=s.createShader(e);if(!i)throw new Error("Couldn't create shader.");if(s.shaderSource(i,t),s.compileShader(i),!s.getShaderParameter(i,s.COMPILE_STATUS)){let e="Couldn't compile shader: "+s.getShaderInfoLog(i);if(s.deleteShader(i),!s.isContextLost())throw new Error(e)}return i}compileProgram(e,t){let s=this.context.gl,i=s.createProgram();if(!i)throw new Error("Couldn't compile program.");if(s.attachShader(i,e),s.attachShader(i,t),s.linkProgram(i),!s.getProgramParameter(i,s.LINK_STATUS)){let e="Couldn't compile shader program: "+s.getProgramInfoLog(i);if(s.deleteProgram(i),!s.isContextLost())throw new Error(e)}return i}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(e,t){this.context.gl.uniform1i(this.getUniformLocation(e),t)}setUniformf(e,t){this.context.gl.uniform1f(this.getUniformLocation(e),t)}setUniform2f(e,t,s){this.context.gl.uniform2f(this.getUniformLocation(e),t,s)}setUniform3f(e,t,s,i){this.context.gl.uniform3f(this.getUniformLocation(e),t,s,i)}setUniform4f(e,t,s,i,n){this.context.gl.uniform4f(this.getUniformLocation(e),t,s,i,n)}setUniform2x2f(e,t){let s=this.context.gl;this.tmp2x2.set(t),s.uniformMatrix2fv(this.getUniformLocation(e),!1,this.tmp2x2)}setUniform3x3f(e,t){let s=this.context.gl;this.tmp3x3.set(t),s.uniformMatrix3fv(this.getUniformLocation(e),!1,this.tmp3x3)}setUniform4x4f(e,t){let s=this.context.gl;this.tmp4x4.set(t),s.uniformMatrix4fv(this.getUniformLocation(e),!1,this.tmp4x4)}getUniformLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=t.getUniformLocation(this.program,e);if(!s&&!t.isContextLost())throw new Error(`Couldn't find location for uniform ${e}`);return s}getAttributeLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=t.getAttribLocation(this.program,e);if(-1==s&&!t.isContextLost())throw new Error(`Couldn't find location for attribute ${e}`);return s}dispose(){this.context.removeRestorable(this);let e=this.context.gl;this.vs&&(e.deleteShader(this.vs),this.vs=null),this.fs&&(e.deleteShader(this.fs),this.fs=null),this.program&&(e.deleteProgram(this.program),this.program=null)}static newColoredTextured(e){let t=`\nattribute vec4 ${Ui.POSITION};\nattribute vec4 ${Ui.COLOR};\nattribute vec2 ${Ui.TEXCOORDS};\nuniform mat4 ${Ui.MVP_MATRIX};\nvarying vec4 v_color;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_color = ${Ui.COLOR};\n\tv_texCoords = ${Ui.TEXCOORDS};\n\tgl_Position = ${Ui.MVP_MATRIX} * ${Ui.POSITION};\n}\n`;return new Ui(e,t,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n}\n")}static newTwoColoredTextured(e){let t=`\nattribute vec4 ${Ui.POSITION};\nattribute vec4 ${Ui.COLOR};\nattribute vec4 ${Ui.COLOR2};\nattribute vec2 ${Ui.TEXCOORDS};\nuniform mat4 ${Ui.MVP_MATRIX};\nvarying vec4 v_light;\nvarying vec4 v_dark;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_light = ${Ui.COLOR};\n\tv_dark = ${Ui.COLOR2};\n\tv_texCoords = ${Ui.TEXCOORDS};\n\tgl_Position = ${Ui.MVP_MATRIX} * ${Ui.POSITION};\n}\n`;return new Ui(e,t,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_light;\nvarying LOWP vec4 v_dark;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\tgl_FragColor.a = texColor.a * v_light.a;\n\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n}\n")}static newColored(e){let t=`\nattribute vec4 ${Ui.POSITION};\nattribute vec4 ${Ui.COLOR};\nuniform mat4 ${Ui.MVP_MATRIX};\nvarying vec4 v_color;\n\nvoid main () {\n\tv_color = ${Ui.COLOR};\n\tgl_Position = ${Ui.MVP_MATRIX} * ${Ui.POSITION};\n}\n`;return new Ui(e,t,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\n\nvoid main () {\n\tgl_FragColor = v_color;\n}\n")}}class zi{attributes;context;vertices;verticesBuffer=null;verticesLength=0;dirtyVertices=!1;indices;indicesBuffer=null;indicesLength=0;dirtyIndices=!1;elementsPerVertex=0;getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(e){this.dirtyVertices=!0,this.verticesLength=e}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(e){this.dirtyIndices=!0,this.indicesLength=e}getIndices(){return this.indices}getVertexSizeInFloats(){let e=0;for(var t=0;t<this.attributes.length;t++)e+=this.attributes[t].numElements;return e}constructor(e,t,s,i){this.attributes=t,this.context=e instanceof vi?e:new vi(e),this.elementsPerVertex=0;for(let e=0;e<t.length;e++)this.elementsPerVertex+=t[e].numElements;this.vertices=new Float32Array(s*this.elementsPerVertex),this.indices=new Uint16Array(i),this.context.addRestorable(this)}setVertices(e){if(this.dirtyVertices=!0,e.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(e,0),this.verticesLength=e.length}setIndices(e){if(this.dirtyIndices=!0,e.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(e,0),this.indicesLength=e.length}draw(e,t){this.drawWithOffset(e,t,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(e,t,s,i){let n=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(e),this.indicesLength>0?n.drawElements(t,i,n.UNSIGNED_SHORT,2*s):n.drawArrays(t,s,i),this.unbind(e)}bind(e){let t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer);let s=0;for(let i=0;i<this.attributes.length;i++){let n=this.attributes[i],a=e.getAttributeLocation(n.name);t.enableVertexAttribArray(a),t.vertexAttribPointer(a,n.numElements,t.FLOAT,!1,4*this.elementsPerVertex,4*s),s+=n.numElements}this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(e){let t=this.context.gl;for(let s=0;s<this.attributes.length;s++){let i=this.attributes[s],n=e.getAttributeLocation(i.name);t.disableVertexAttribArray(n)}t.bindBuffer(t.ARRAY_BUFFER,null),this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}update(){let e=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),e.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),e.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let e=this.context.gl;e.deleteBuffer(this.verticesBuffer),e.deleteBuffer(this.indicesBuffer)}}class Gi{name;type;numElements;constructor(e,t,s){this.name=e,this.type=t,this.numElements=s}}class Wi extends Gi{constructor(){super(Ui.POSITION,Ji.Float,2)}}class qi extends Gi{constructor(e=0){super(Ui.TEXCOORDS+(0==e?"":e),Ji.Float,2)}}class ji extends Gi{constructor(){super(Ui.COLOR,Ji.Float,4)}}class Hi extends Gi{constructor(){super(Ui.COLOR2,Ji.Float,4)}}var Ji,$i;!function(e){e[e.Float=0]="Float"}(Ji||(Ji={}));class Ki{static disableCulling=!1;context;drawCalls=0;static globalDrawCalls=0;isDrawing=!1;mesh;shader=null;lastTexture=null;verticesLength=0;indicesLength=0;srcColorBlend;srcAlphaBlend;dstBlend;cullWasEnabled=!1;constructor(e,t=!0,s=10920){if(s>10920)throw new Error("Can't have more than 10920 triangles per batch: "+s);this.context=e instanceof vi?e:new vi(e);let i=t?[new Wi,new ji,new qi,new Hi]:[new Wi,new ji,new qi];this.mesh=new zi(e,i,s,3*s);let n=this.context.gl;this.srcColorBlend=n.SRC_ALPHA,this.srcAlphaBlend=n.ONE,this.dstBlend=n.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=e,this.lastTexture=null,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend),Ki.disableCulling&&(this.cullWasEnabled=t.isEnabled(t.CULL_FACE),this.cullWasEnabled&&t.disable(t.CULL_FACE))}static blendModesGL=[{srcRgb:770,srcRgbPma:1,dstRgb:771,srcAlpha:1},{srcRgb:770,srcRgbPma:1,dstRgb:1,srcAlpha:1},{srcRgb:774,srcRgbPma:774,dstRgb:771,srcAlpha:1},{srcRgb:1,srcRgbPma:1,dstRgb:769,srcAlpha:1}];setBlendMode(e,t){const s=Ki.blendModesGL[e],i=t?s.srcRgbPma:s.srcRgb,n=s.srcAlpha,a=s.dstRgb;this.srcColorBlend==i&&this.srcAlphaBlend==n&&this.dstBlend==a||(this.srcColorBlend=i,this.srcAlphaBlend=n,this.dstBlend=a,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(i,a,n,a))}draw(e,t,s){e!=this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+t.length>this.mesh.getVertices().length||this.indicesLength+s.length>this.mesh.getIndices().length)&&this.flush();let i=this.mesh.numVertices();this.mesh.getVertices().set(t,this.verticesLength),this.verticesLength+=t.length,this.mesh.setVerticesLength(this.verticesLength);let n=this.mesh.getIndices();for(let e=this.indicesLength,t=0;t<s.length;e++,t++)n[e]=s[t]+i;this.indicesLength+=s.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(0!=this.verticesLength){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,Ki.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let e=this.context.gl;e.disable(e.BLEND),Ki.disableCulling&&this.cullWasEnabled&&e.enable(e.CULL_FACE)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let e=Ki.globalDrawCalls;return Ki.globalDrawCalls=0,e}dispose(){this.mesh.dispose()}}class Qi{context;isDrawing=!1;mesh;shapeType=$i.Filled;color=new Ce(1,1,1,1);shader=null;vertexIndex=0;tmp=new Re;srcColorBlend;srcAlphaBlend;dstBlend;constructor(e,t=10920){if(t>10920)throw new Error("Can't have more than 10920 triangles per batch: "+t);this.context=e instanceof vi?e:new vi(e),this.mesh=new zi(e,[new Wi,new ji],t,0);let s=this.context.gl;this.srcColorBlend=s.SRC_ALPHA,this.srcAlphaBlend=s.ONE,this.dstBlend=s.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=e,this.vertexIndex=0,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,t,s){this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=s,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(e,s,t,s))}setColor(e){this.color.setFromColor(e)}setColorWith(e,t,s,i){this.color.set(e,t,s,i)}point(e,t,s){this.check($i.Point,1),s||(s=this.color),this.vertex(e,t,s)}line(e,t,s,i,n){this.check($i.Line,2),this.mesh.getVertices(),this.vertexIndex,n||(n=this.color),this.vertex(e,t,n),this.vertex(s,i,n)}triangle(e,t,s,i,n,a,r,o,l,h){this.check(e?$i.Filled:$i.Line,3),this.mesh.getVertices(),this.vertexIndex,o||(o=this.color),l||(l=this.color),h||(h=this.color),e?(this.vertex(t,s,o),this.vertex(i,n,l),this.vertex(a,r,h)):(this.vertex(t,s,o),this.vertex(i,n,l),this.vertex(i,n,o),this.vertex(a,r,l),this.vertex(a,r,o),this.vertex(t,s,l))}quad(e,t,s,i,n,a,r,o,l,h,c,d,u){this.check(e?$i.Filled:$i.Line,3),this.mesh.getVertices(),this.vertexIndex,h||(h=this.color),c||(c=this.color),d||(d=this.color),u||(u=this.color),e?(this.vertex(t,s,h),this.vertex(i,n,c),this.vertex(a,r,d),this.vertex(a,r,d),this.vertex(o,l,u),this.vertex(t,s,h)):(this.vertex(t,s,h),this.vertex(i,n,c),this.vertex(i,n,c),this.vertex(a,r,d),this.vertex(a,r,d),this.vertex(o,l,u),this.vertex(o,l,u),this.vertex(t,s,h))}rect(e,t,s,i,n,a){this.quad(e,t,s,t+i,s,t+i,s+n,t,s+n,a,a,a,a)}rectLine(e,t,s,i,n,a,r){this.check(e?$i.Filled:$i.Line,8),r||(r=this.color);let o=this.tmp.set(n-s,t-i);o.normalize(),a*=.5;let l=o.x*a,h=o.y*a;e?(this.vertex(t+l,s+h,r),this.vertex(t-l,s-h,r),this.vertex(i+l,n+h,r),this.vertex(i-l,n-h,r),this.vertex(i+l,n+h,r),this.vertex(t-l,s-h,r)):(this.vertex(t+l,s+h,r),this.vertex(t-l,s-h,r),this.vertex(i+l,n+h,r),this.vertex(i-l,n-h,r),this.vertex(i+l,n+h,r),this.vertex(t+l,s+h,r),this.vertex(i-l,n-h,r),this.vertex(t-l,s-h,r))}x(e,t,s){this.line(e-s,t-s,e+s,t+s),this.line(e-s,t+s,e+s,t-s)}polygon(e,t,s,i){if(s<3)throw new Error("Polygon must contain at least 3 vertices");this.check($i.Line,2*s),i||(i=this.color),this.mesh.getVertices(),this.vertexIndex,s<<=1;let n=e[t<<=1],a=e[t+1],r=t+s;for(let o=t,l=t+s-2;o<l;o+=2){let t=e[o],s=e[o+1],l=0,h=0;o+2>=r?(l=n,h=a):(l=e[o+2],h=e[o+3]),this.vertex(t,s,i),this.vertex(l,h,i)}}circle(e,t,s,i,n,a=0){if(0==a&&(a=Math.max(1,6*Pe.cbrt(i)|0)),a<=0)throw new Error("segments must be > 0.");n||(n=this.color);let r=2*Pe.PI/a,o=Math.cos(r),l=Math.sin(r),h=i,c=0;if(e){this.check($i.Filled,3*a+3),a--;for(let e=0;e<a;e++){this.vertex(t,s,n),this.vertex(t+h,s+c,n);let e=h;h=o*h-l*c,c=l*e+o*c,this.vertex(t+h,s+c,n)}this.vertex(t,s,n),this.vertex(t+h,s+c,n)}else{this.check($i.Line,2*a+2);for(let e=0;e<a;e++){this.vertex(t+h,s+c,n);let e=h;h=o*h-l*c,c=l*e+o*c,this.vertex(t+h,s+c,n)}this.vertex(t+h,s+c,n)}h=i,c=0,this.vertex(t+h,s+c,n)}curve(e,t,s,i,n,a,r,o,l,h){this.check($i.Line,2*l+2),h||(h=this.color);let c=1/l,d=c*c,u=c*c*c,p=3*c,m=3*d,g=6*d,f=6*u,y=e-2*s+n,x=t-2*i+a,w=3*(s-n)-e+r,b=3*(i-a)-t+o,v=e,S=t,k=(s-e)*p+y*m+w*u,I=(i-t)*p+x*m+b*u,A=y*g+w*f,E=x*g+b*f,C=w*f,P=b*f;for(;l-- >0;)this.vertex(v,S,h),v+=k,S+=I,k+=A,I+=E,A+=C,E+=P,this.vertex(v,S,h);this.vertex(v,S,h),this.vertex(r,o,h)}vertex(e,t,s){let i=this.vertexIndex,n=this.mesh.getVertices();n[i++]=e,n[i++]=t,n[i++]=s.r,n[i++]=s.g,n[i++]=s.b,n[i++]=s.a,this.vertexIndex=i}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let e=this.context.gl;e.disable(e.BLEND),this.isDrawing=!1}flush(){if(0!=this.vertexIndex){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(e,t){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==e){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<t))return;this.flush()}else this.flush(),this.shapeType=e}dispose(){this.mesh.dispose()}}!function(e){e[e.Point=0]="Point",e[e.Line=1]="Line",e[e.Filled=4]="Filled"}($i||($i={}));class Zi{boneLineColor=new Ce(1,0,0,1);boneOriginColor=new Ce(0,1,0,1);attachmentLineColor=new Ce(0,0,1,.5);triangleLineColor=new Ce(1,.64,0,.5);pathColor=(new Ce).setFromString("FF7F00");clipColor=new Ce(.8,0,0,2);aabbColor=new Ce(0,1,0,.5);drawBones=!0;drawRegionAttachments=!0;drawBoundingBoxes=!0;drawMeshHull=!0;drawMeshTriangles=!0;drawPaths=!0;drawSkeletonXY=!1;drawClipping=!0;premultipliedAlpha=!1;scale=1;boneWidth=2;context;bounds=new di;temp=new Array;vertices=Me.newFloatArray(2048);static LIGHT_GRAY=new Ce(192/255,192/255,192/255,1);static GREEN=new Ce(0,1,0,1);constructor(e){this.context=e instanceof vi?e:new vi(e)}draw(e,t,s){let i=t.x,n=t.y,a=this.context.gl,r=this.premultipliedAlpha?a.ONE:a.SRC_ALPHA;e.setBlendMode(r,a.ONE,a.ONE_MINUS_SRC_ALPHA);let o=t.bones;if(this.drawBones){e.setColor(this.boneLineColor);for(let t=0,i=o.length;t<i;t++){let i=o[t];if(s&&s.indexOf(i.data.name)>-1)continue;if(!i.parent)continue;let n=i.data.length*i.a+i.worldX,a=i.data.length*i.c+i.worldY;e.rectLine(!0,i.worldX,i.worldY,n,a,this.boneWidth*this.scale)}this.drawSkeletonXY&&e.x(i,n,4*this.scale)}if(this.drawRegionAttachments){e.setColor(this.attachmentLineColor);let s=t.slots;for(let t=0,i=s.length;t<i;t++){let i=s[t],n=i.getAttachment();if(n instanceof as){let t=n,s=this.vertices;t.computeWorldVertices(i,s,0,2),e.line(s[0],s[1],s[2],s[3]),e.line(s[2],s[3],s[4],s[5]),e.line(s[4],s[5],s[6],s[7]),e.line(s[6],s[7],s[0],s[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let s=t.slots;for(let t=0,i=s.length;t<i;t++){let i=s[t];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof ss))continue;let a=n,r=this.vertices;a.computeWorldVertices(i,0,a.worldVerticesLength,r,0,2);let o=a.triangles,l=a.hullLength;if(this.drawMeshTriangles){e.setColor(this.triangleLineColor);for(let t=0,s=o.length;t<s;t+=3){let s=2*o[t],i=2*o[t+1],n=2*o[t+2];e.triangle(!1,r[s],r[s+1],r[i],r[i+1],r[n],r[n+1])}}if(this.drawMeshHull&&l>0){e.setColor(this.attachmentLineColor),l=2*(l>>1);let t=r[l-2],s=r[l-1];for(let i=0,n=l;i<n;i+=2){let n=r[i],a=r[i+1];e.line(n,a,t,s),t=n,s=a}}}}if(this.drawBoundingBoxes){let s=this.bounds;s.update(t,!0),e.setColor(this.aabbColor),e.rect(!1,s.minX,s.minY,s.getWidth(),s.getHeight());let i=s.polygons,n=s.boundingBoxes;for(let t=0,s=i.length;t<s;t++){let s=i[t];e.setColor(n[t].color),e.polygon(s,0,s.length)}}if(this.drawPaths){let s=t.slots;for(let t=0,i=s.length;t<i;t++){let i=s[t];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof is))continue;let a=n,r=a.worldVerticesLength,o=this.temp=Me.setArraySize(this.temp,r,0);a.computeWorldVertices(i,0,r,o,0,2);let l=this.pathColor,h=o[2],c=o[3],d=0,u=0;if(a.closed){e.setColor(l);let t=o[0],s=o[1],i=o[r-2],n=o[r-1];d=o[r-4],u=o[r-3],e.curve(h,c,t,s,i,n,d,u,32),e.setColor(Zi.LIGHT_GRAY),e.line(h,c,t,s),e.line(d,u,i,n)}r-=4;for(let t=4;t<r;t+=6){let s=o[t],i=o[t+1],n=o[t+2],a=o[t+3];d=o[t+4],u=o[t+5],e.setColor(l),e.curve(h,c,s,i,n,a,d,u,32),e.setColor(Zi.LIGHT_GRAY),e.line(h,c,s,i),e.line(d,u,n,a),h=d,c=u}}}if(this.drawBones){e.setColor(this.boneOriginColor);for(let t=0,i=o.length;t<i;t++){let i=o[t];s&&s.indexOf(i.data.name)>-1||e.circle(!0,i.worldX,i.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let s=t.slots;e.setColor(this.clipColor);for(let t=0,i=s.length;t<i;t++){let i=s[t];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof Xt))continue;let a=n,r=a.worldVerticesLength,o=this.temp=Me.setArraySize(this.temp,r,0);a.computeWorldVertices(i,0,r,o,0,2);for(let t=0,s=o.length;t<s;t+=2){let s=o[t],i=o[t+1],n=o[(t+2)%o.length],a=o[(t+3)%o.length];e.line(s,i,n,a)}}}}dispose(){}}class en{vertices;numVertices;numFloats;constructor(e,t,s){this.vertices=e,this.numVertices=t,this.numFloats=s}}class tn{static QUAD_TRIANGLES=[0,1,2,2,3,0];premultipliedAlpha=!1;tempColor=new Ce;tempColor2=new Ce;vertices;vertexSize=8;twoColorTint=!1;renderable=new en([],0,0);clipper=new pi;temp=new Re;temp2=new Re;temp3=new Ce;temp4=new Ce;constructor(e,t=!0){this.twoColorTint=t,t&&(this.vertexSize+=4),this.vertices=Me.newFloatArray(1024*this.vertexSize)}draw(e,t,s=-1,i=-1,n=null){let a,r,o,l=this.clipper,h=this.premultipliedAlpha,c=this.twoColorTint,d=null,u=this.renderable,p=t.drawOrder,m=t.color,g=c?12:8,f=!1;-1==s&&(f=!0);for(let t=0,y=p.length;t<y;t++){let y=l.isClipping()?2:g,x=p[t];if(!x.bone.active){l.clipEndWithSlot(x);continue}if(s>=0&&s==x.data.index&&(f=!0),!f){l.clipEndWithSlot(x);continue}i>=0&&i==x.data.index&&(f=!1);let w,b=x.getAttachment();if(b instanceof as){let e=b;u.vertices=this.vertices,u.numVertices=4,u.numFloats=y<<2,e.computeWorldVertices(x,u.vertices,0,y),r=tn.QUAD_TRIANGLES,a=e.uvs,w=e.region.texture,o=e.color}else{if(!(b instanceof ss)){if(b instanceof Xt){let e=b;l.clipStart(x,e);continue}l.clipEndWithSlot(x);continue}{let e=b;u.vertices=this.vertices,u.numVertices=e.worldVerticesLength>>1,u.numFloats=u.numVertices*y,u.numFloats>u.vertices.length&&(u.vertices=this.vertices=Me.newFloatArray(u.numFloats)),e.computeWorldVertices(x,0,e.worldVerticesLength,u.vertices,0,y),r=e.triangles,w=e.region.texture,a=e.uvs,o=e.color}}if(w){let t=x.color,s=this.tempColor;s.r=m.r*t.r*o.r,s.g=m.g*t.g*o.g,s.b=m.b*t.b*o.b,s.a=m.a*t.a*o.a,h&&(s.r*=s.a,s.g*=s.a,s.b*=s.a);let i=this.tempColor2;x.darkColor?(h?(i.r=x.darkColor.r*s.a,i.g=x.darkColor.g*s.a,i.b=x.darkColor.b*s.a):i.setFromColor(x.darkColor),i.a=h?1:0):i.set(0,0,0,1);let p=x.data.blendMode;if(p!=d&&(d=p,e.setBlendMode(d,h)),l.isClipping()){l.clipTriangles(u.vertices,r,r.length,a,s,i,c);let t=new Float32Array(l.clippedVertices),o=l.clippedTriangles;n&&n(t,t.length,g),e.draw(w,t,o)}else{let t=u.vertices;if(c)for(let e=2,n=0,r=u.numFloats;e<r;e+=g,n+=2)t[e]=s.r,t[e+1]=s.g,t[e+2]=s.b,t[e+3]=s.a,t[e+4]=a[n],t[e+5]=a[n+1],t[e+6]=i.r,t[e+7]=i.g,t[e+8]=i.b,t[e+9]=i.a;else for(let e=2,i=0,n=u.numFloats;e<n;e+=g,i+=2)t[e]=s.r,t[e+1]=s.g,t[e+2]=s.b,t[e+3]=s.a,t[e+4]=a[i],t[e+5]=a[i+1];let o=u.vertices.subarray(0,u.numFloats);n&&n(u.vertices,u.numFloats,g),e.draw(w,o,r)}}l.clipEndWithSlot(x)}l.clipEnd()}getSkeletonClipping(){return this.clipper}}const sn=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],nn=[0,1,2,2,3,0],an=new Ce(1,1,1,1);class rn{context;canvas;camera;batcher;twoColorTint=!1;batcherShader;shapes;shapesShader;activeRenderer=null;skeletonRenderer;skeletonDebugRenderer;constructor(e,t,s=!0){this.canvas=e,this.context=t instanceof vi?t:new vi(t),this.twoColorTint=s,this.camera=new Ni(e.width,e.height),this.batcherShader=s?Ui.newTwoColoredTextured(this.context):Ui.newColoredTextured(this.context),this.batcher=new Ki(this.context,s),this.shapesShader=Ui.newColored(this.context),this.shapes=new Qi(this.context),this.skeletonRenderer=new tn(this.context,s),this.skeletonDebugRenderer=new Zi(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(e,t=!1,s=-1,i=-1,n=null){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=t,this.skeletonRenderer.draw(this.batcher,e,s,i,n)}drawSkeletonDebug(e,t=!1,s){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=t,this.skeletonDebugRenderer.draw(this.shapes,e,s)}drawTexture(e,t,s,i,n,a){this.enableRenderer(this.batcher),a||(a=an);var r=0;sn[r++]=t,sn[r++]=s,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=0,sn[r++]=1,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t+i,sn[r++]=s,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=1,sn[r++]=1,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t+i,sn[r++]=s+n,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=1,sn[r++]=0,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t,sn[r++]=s+n,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=0,sn[r++]=0,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r]=0),this.batcher.draw(e,sn,nn)}drawTextureUV(e,t,s,i,n,a,r,o,l,h){this.enableRenderer(this.batcher),h||(h=an);var c=0;sn[c++]=t,sn[c++]=s,sn[c++]=h.r,sn[c++]=h.g,sn[c++]=h.b,sn[c++]=h.a,sn[c++]=a,sn[c++]=r,this.twoColorTint&&(sn[c++]=0,sn[c++]=0,sn[c++]=0,sn[c++]=0),sn[c++]=t+i,sn[c++]=s,sn[c++]=h.r,sn[c++]=h.g,sn[c++]=h.b,sn[c++]=h.a,sn[c++]=o,sn[c++]=r,this.twoColorTint&&(sn[c++]=0,sn[c++]=0,sn[c++]=0,sn[c++]=0),sn[c++]=t+i,sn[c++]=s+n,sn[c++]=h.r,sn[c++]=h.g,sn[c++]=h.b,sn[c++]=h.a,sn[c++]=o,sn[c++]=l,this.twoColorTint&&(sn[c++]=0,sn[c++]=0,sn[c++]=0,sn[c++]=0),sn[c++]=t,sn[c++]=s+n,sn[c++]=h.r,sn[c++]=h.g,sn[c++]=h.b,sn[c++]=h.a,sn[c++]=a,sn[c++]=l,this.twoColorTint&&(sn[c++]=0,sn[c++]=0,sn[c++]=0,sn[c]=0),this.batcher.draw(e,sn,nn)}drawTextureRotated(e,t,s,i,n,a,r,o,l){this.enableRenderer(this.batcher),l||(l=an);let h=t+a,c=s+r,d=-a,u=-r,p=i-a,m=n-r,g=d,f=u,y=d,x=m,w=p,b=m,v=p,S=u,k=0,I=0,A=0,E=0,C=0,P=0,M=0,T=0;if(0!=o){let e=Pe.cosDeg(o),t=Pe.sinDeg(o);k=e*g-t*f,I=t*g+e*f,M=e*y-t*x,T=t*y+e*x,C=e*w-t*b,P=t*w+e*b,A=C+(k-M),E=P+(I-T)}else k=g,I=f,M=y,T=x,C=w,P=b,A=v,E=S;k+=h,I+=c,A+=h,E+=c,C+=h,P+=c,M+=h,T+=c;var R=0;sn[R++]=k,sn[R++]=I,sn[R++]=l.r,sn[R++]=l.g,sn[R++]=l.b,sn[R++]=l.a,sn[R++]=0,sn[R++]=1,this.twoColorTint&&(sn[R++]=0,sn[R++]=0,sn[R++]=0,sn[R++]=0),sn[R++]=A,sn[R++]=E,sn[R++]=l.r,sn[R++]=l.g,sn[R++]=l.b,sn[R++]=l.a,sn[R++]=1,sn[R++]=1,this.twoColorTint&&(sn[R++]=0,sn[R++]=0,sn[R++]=0,sn[R++]=0),sn[R++]=C,sn[R++]=P,sn[R++]=l.r,sn[R++]=l.g,sn[R++]=l.b,sn[R++]=l.a,sn[R++]=1,sn[R++]=0,this.twoColorTint&&(sn[R++]=0,sn[R++]=0,sn[R++]=0,sn[R++]=0),sn[R++]=M,sn[R++]=T,sn[R++]=l.r,sn[R++]=l.g,sn[R++]=l.b,sn[R++]=l.a,sn[R++]=0,sn[R++]=0,this.twoColorTint&&(sn[R++]=0,sn[R++]=0,sn[R++]=0,sn[R]=0),this.batcher.draw(e,sn,nn)}drawRegion(e,t,s,i,n,a){this.enableRenderer(this.batcher),a||(a=an);var r=0;sn[r++]=t,sn[r++]=s,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=e.u,sn[r++]=e.v2,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t+i,sn[r++]=s,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=e.u2,sn[r++]=e.v2,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t+i,sn[r++]=s+n,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=e.u2,sn[r++]=e.v,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r++]=0),sn[r++]=t,sn[r++]=s+n,sn[r++]=a.r,sn[r++]=a.g,sn[r++]=a.b,sn[r++]=a.a,sn[r++]=e.u,sn[r++]=e.v,this.twoColorTint&&(sn[r++]=0,sn[r++]=0,sn[r++]=0,sn[r]=0),this.batcher.draw(e.page.texture,sn,nn)}line(e,t,s,i,n,a){this.enableRenderer(this.shapes),this.shapes.line(e,t,s,i,n)}triangle(e,t,s,i,n,a,r,o,l,h){this.enableRenderer(this.shapes),this.shapes.triangle(e,t,s,i,n,a,r,o,l,h)}quad(e,t,s,i,n,a,r,o,l,h,c,d,u){this.enableRenderer(this.shapes),this.shapes.quad(e,t,s,i,n,a,r,o,l,h,c,d,u)}rect(e,t,s,i,n,a){this.enableRenderer(this.shapes),this.shapes.rect(e,t,s,i,n,a)}rectLine(e,t,s,i,n,a,r){this.enableRenderer(this.shapes),this.shapes.rectLine(e,t,s,i,n,a,r)}polygon(e,t,s,i){this.enableRenderer(this.shapes),this.shapes.polygon(e,t,s,i)}circle(e,t,s,i,n,a=0){this.enableRenderer(this.shapes),this.shapes.circle(e,t,s,i,n,a)}curve(e,t,s,i,n,a,r,o,l,h){this.enableRenderer(this.shapes),this.shapes.curve(e,t,s,i,n,a,r,o,l,h)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(e){let t=this.canvas;var s=window.devicePixelRatio||1,i=Math.round(t.clientWidth*s),n=Math.round(t.clientHeight*s);if(t.width==i&&t.height==n||(t.width=i,t.height=n),this.context.gl.viewport(0,0,t.width,t.height),e===on.Expand)this.camera.setViewport(i,n);else if(e===on.Fit){let e=t.width,s=t.height,i=this.camera.viewportWidth,n=this.camera.viewportHeight,a=n/i<s/e?i/e:n/s;this.camera.setViewport(e*a,s*a)}this.camera.update()}enableRenderer(e){this.activeRenderer!==e&&(this.end(),e instanceof Ki?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Ui.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):e instanceof Qi?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Ui.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var on,ln;(ln=on||(on={}))[ln.Stretch=0]="Stretch",ln[ln.Expand=1]="Expand",ln[ln.Fit=2]="Fit";let hn=Phaser.GameObjects.Components;const cn=hn.ComputedSize,dn=hn.Depth,un=hn.Flip,pn=hn.ScrollFactor,mn=hn.Transform,gn=hn.Visible,fn=hn.Origin,yn=hn.Alpha;function xn(...e){return t=>(Phaser.Class.mixin(t,e),t)}const wn=xn(cn),bn=xn(dn),vn=xn(un),Sn=xn(pn),kn=xn(mn),In=xn(gn),An=xn(fn),En=xn(yn);class Cn extends Phaser.GameObjects.GameObject{constructor(e,t){super(e,t)}}class Pn{clipping;constructor(e=!1){this.clipping=e}calculateBounds(e){if(!e.skeleton)return{x:0,y:0,width:0,height:0};const t=new ys(e.skeleton.data);t.setToSetupPose(),t.updateWorldTransform(jt.update);const s=t.getBoundsRect(this.clipping?new pi:void 0);return s.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:s}}class Mn{animation;skins;timeStep;clipping;constructor(e,t=[],s=.05,i=!1){this.animation=e,this.skins=t,this.timeStep=s,this.clipping=i}calculateBounds(e){if(!e.skeleton||!e.animationState)return{x:0,y:0,width:0,height:0};const t=new Et(e.animationState.data),s=new ys(e.skeleton.data),i=this.clipping?new pi:void 0,n=s.data;if(this.skins.length>0){let e=new ks("custom-skin");for(const t of this.skins){const s=n.findSkin(t);null!=s&&e.addSkin(s)}s.setSkin(e)}s.setToSetupPose();const a=null!=this.animation?n.findAnimation(this.animation):null;if(null==a){s.updateWorldTransform(jt.update);const e=s.getBoundsRect(i);return e.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:e}{let e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;t.clearTracks(),t.setAnimationWith(0,a,!1);const l=Math.max(a.duration/this.timeStep,1);for(let a=0;a<l;a++){const l=a>0?this.timeStep:0;t.update(l),t.apply(s),s.update(l),s.updateWorldTransform(jt.update);const h=s.getBoundsRect(i);e=Math.min(e,h.x),n=Math.min(n,h.y),r=Math.max(r,h.x+h.width),o=Math.max(o,h.y+h.height)}const h={x:e,y:n,width:r-e,height:o-n};return h.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:h}}}class Tn extends(bn(An(wn(vn(Sn(kn(In(En(Cn))))))))){plugin;boundsProvider;blendMode=-1;skeleton;animationStateData;animationState;beforeUpdateWorldTransforms=()=>{};afterUpdateWorldTransforms=()=>{};premultipliedAlpha=!1;constructor(e,t,s,i,n,a,r=new Pn){super(e,window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:Ae),this.plugin=t,this.boundsProvider=r,this.setPosition(s,i),this.premultipliedAlpha=this.plugin.isAtlasPremultiplied(a),this.skeleton=this.plugin.createSkeleton(n,a),this.animationStateData=new Yt(this.skeleton.data),this.animationState=new Et(this.animationStateData),this.skeleton.updateWorldTransform(jt.update),this.updateSize()}updateSize(){if(!this.skeleton)return;let e=this.boundsProvider.calculateBounds(this);this.width=e.width,this.height=e.height,this.displayOriginX=-e.x,this.displayOriginY=-e.y}skeletonToPhaserWorldCoordinates(e){let t=this.getWorldTransformMatrix(),s=t.a,i=t.b,n=t.c,a=t.d,r=t.tx,o=t.ty,l=e.x,h=e.y;e.x=l*s+h*n+r,e.y=l*i+h*a+o}phaserWorldCoordinatesToSkeleton(e){let t=this.getWorldTransformMatrix();t=t.invert();let s=t.a,i=t.b,n=t.c,a=t.d,r=t.tx,o=t.ty,l=e.x,h=e.y;e.x=l*s+h*n+r,e.y=l*i+h*a+o}phaserWorldCoordinatesToBone(e,t){this.phaserWorldCoordinatesToSkeleton(e),t.parent?t.parent.worldToLocal(e):t.worldToLocal(e)}updatePose(e){this.animationState.update(e/1e3),this.animationState.apply(this.skeleton),this.beforeUpdateWorldTransforms(this),this.skeleton.update(e/1e3),this.skeleton.updateWorldTransform(jt.update),this.afterUpdateWorldTransforms(this)}preUpdate(e,t){this.skeleton&&this.animationState&&this.updatePose(t)}preDestroy(){}willRender(e){var t=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&e.id);if(this.visible||(t=!1),!t&&this.parentContainer&&this.plugin.webGLRenderer){var s=this.plugin.webGLRenderer;this.plugin.gl&&this.plugin.phaserRenderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&s.batcher.isDrawing&&(s.end(),this.plugin.phaserRenderer.pipelines.rebind())}return t}renderWebGL(e,t,s,i){if(!this.skeleton||!this.animationState||!this.plugin.webGLRenderer)return;let n=this.plugin.webGLRenderer;e.newType&&(e.pipelines.clear(),n.begin()),s.addToRenderList(t);let a=Phaser.GameObjects.GetCalcMatrix(t,s,i).calc,r=a.a,o=a.b,l=a.c,h=a.d,c=a.tx,d=a.ty;n.drawSkeleton(this.skeleton,this.premultipliedAlpha,-1,-1,((e,t,s)=>{for(let i=0;i<t;i+=s){let t=e[i],s=e[i+1];e[i]=t*r+s*l+c,e[i+1]=t*o+s*h+d}})),e.nextTypeMatch||(n.end(),e.pipelines.rebind())}renderCanvas(e,t,s,i){if(!this.skeleton||!this.animationState||!this.plugin.canvasRenderer)return;let n=e.currentContext,a=this.plugin.canvasRenderer;a.ctx=n,s.addToRenderList(t);let r=Phaser.GameObjects.GetCalcMatrix(t,s,i).calc,o=this.skeleton;o.x=r.tx,o.y=r.ty,o.scaleX=r.scaleX,o.scaleY=r.scaleY,o.getRootBone().rotation=-Pe.radiansToDegrees*r.rotationNormalized,this.skeleton.updateWorldTransform(jt.update),n.save(),a.draw(o),n.restore()}}class Rn extends Vt{constructor(e){super(e)}setFilters(e,t){}setWraps(e,t){}dispose(){}}const Bn=Me.newFloatArray(8);class Ln{static QUAD_TRIANGLES=[0,1,2,2,3,0];static VERTEX_SIZE=8;ctx;triangleRendering=!1;debugRendering=!1;vertices=Me.newFloatArray(8192);tempColor=new Ce;constructor(e){this.ctx=e}draw(e){this.triangleRendering?this.drawTriangles(e):this.drawImages(e)}drawImages(e){let t=this.ctx,s=this.tempColor,i=e.color,n=e.drawOrder;this.debugRendering&&(t.strokeStyle="green");for(let e=0,a=n.length;e<a;e++){let a=n[e],r=a.bone;if(!r.active)continue;let o=a.getAttachment();if(!(o instanceof as))continue;o.computeWorldVertices(a,Bn,0,2);let l=o.region,h=l.texture.getImage(),c=a.color,d=o.color;s.set(i.r*c.r*d.r,i.g*c.g*d.g,i.b*c.b*d.b,i.a*c.a*d.a),t.save(),t.transform(r.a,r.c,r.b,r.d,r.worldX,r.worldY),t.translate(o.offset[0],o.offset[1]),t.rotate(o.rotation*Math.PI/180);let u=o.width/l.originalWidth;t.scale(u*o.scaleX,u*o.scaleY);let p=l.width,m=l.height;if(t.translate(p/2,m/2),90==o.region.degrees){let e=p;p=m,m=e,t.rotate(-Math.PI/2)}t.scale(1,-1),t.translate(-p/2,-m/2),t.globalAlpha=s.a,t.drawImage(h,h.width*l.u,h.height*l.v,p,m,0,0,p,m),this.debugRendering&&t.strokeRect(0,0,p,m),t.restore()}}drawTriangles(e){let t=this.ctx,s=this.tempColor,i=e.color,n=e.drawOrder,a=null,r=this.vertices,o=null;for(let e=0,h=n.length;e<h;e++){let h,c=n[e],d=c.getAttachment();if(d instanceof as){let e=d;r=this.computeRegionVertices(c,e,!1),o=Ln.QUAD_TRIANGLES,h=e.region.texture.getImage()}else{if(!(d instanceof ss))continue;{let e=d;r=this.computeMeshVertices(c,e,!1),o=e.triangles,h=e.region.texture.getImage()}}if(h){c.data.blendMode!=a&&(a=c.data.blendMode);let e=c.color,n=d.color;s.set(i.r*e.r*n.r,i.g*e.g*n.g,i.b*e.b*n.b,i.a*e.a*n.a),t.globalAlpha=s.a;for(var l=0;l<o.length;l+=3){let e=8*o[l],s=8*o[l+1],i=8*o[l+2],n=r[e],a=r[e+1],c=r[e+6],d=r[e+7],u=r[s],p=r[s+1],m=r[s+6],g=r[s+7],f=r[i],y=r[i+1],x=r[i+6],w=r[i+7];this.drawTriangle(h,n,a,c,d,u,p,m,g,f,y,x,w),this.debugRendering&&(t.strokeStyle="green",t.beginPath(),t.moveTo(n,a),t.lineTo(u,p),t.lineTo(f,y),t.lineTo(n,a),t.stroke())}}}this.ctx.globalAlpha=1}drawTriangle(e,t,s,i,n,a,r,o,l,h,c,d,u){let p=this.ctx;const m=e.width-1,g=e.height-1;i*=m,n*=g,o*=m,l*=g,d*=m,u*=g,p.beginPath(),p.moveTo(t,s),p.lineTo(a,r),p.lineTo(h,c),p.closePath();let f=(o-=i)*(u-=n)-(d-=i)*(l-=n);if(0==f)return;f=1/f;const y=(u*(a-=t)-l*(h-=t))*f,x=(u*(r-=s)-l*(c-=s))*f,w=(o*h-d*a)*f,b=(o*c-d*r)*f,v=t-y*i-w*n,S=s-x*i-b*n;p.save(),p.transform(y,x,w,b,v,S),p.clip(),p.drawImage(e,0,0),p.restore()}computeRegionVertices(e,t,s){let i=e.bone.skeleton.color,n=e.color,a=t.color,r=i.a*n.a*a.a,o=s?r:1,l=this.tempColor;l.set(i.r*n.r*a.r*o,i.g*n.g*a.g*o,i.b*n.b*a.b*o,r),t.computeWorldVertices(e,this.vertices,0,Ln.VERTEX_SIZE);let h=this.vertices,c=t.uvs;return h[as.C1R]=l.r,h[as.C1G]=l.g,h[as.C1B]=l.b,h[as.C1A]=l.a,h[as.U1]=c[0],h[as.V1]=c[1],h[as.C2R]=l.r,h[as.C2G]=l.g,h[as.C2B]=l.b,h[as.C2A]=l.a,h[as.U2]=c[2],h[as.V2]=c[3],h[as.C3R]=l.r,h[as.C3G]=l.g,h[as.C3B]=l.b,h[as.C3A]=l.a,h[as.U3]=c[4],h[as.V3]=c[5],h[as.C4R]=l.r,h[as.C4G]=l.g,h[as.C4B]=l.b,h[as.C4A]=l.a,h[as.U4]=c[6],h[as.V4]=c[7],h}computeMeshVertices(e,t,s){let i=e.bone.skeleton.color,n=e.color,a=t.color,r=i.a*n.a*a.a,o=s?r:1,l=this.tempColor;l.set(i.r*n.r*a.r*o,i.g*n.g*a.g*o,i.b*n.b*a.b*o,r);let h=t.worldVerticesLength/2,c=this.vertices;c.length<t.worldVerticesLength&&(this.vertices=c=Me.newFloatArray(t.worldVerticesLength)),t.computeWorldVertices(e,0,t.worldVerticesLength,c,0,Ln.VERTEX_SIZE);let d=t.uvs;for(let e=0,t=0,s=2;e<h;e++)c[s++]=l.r,c[s++]=l.g,c[s++]=l.b,c[s++]=l.a,c[s++]=d[t++],c[s++]=d[t++],s+=2;return c}}class _n extends i.Plugins.ScenePlugin{game;isWebGL;gl;static gameWebGLRenderer=null;get webGLRenderer(){return _n.gameWebGLRenderer}canvasRenderer;phaserRenderer;skeletonDataCache;atlasCache;constructor(e,t,s){super(e,t,s),this.game=t.game,this.isWebGL=2===this.game.config.renderType,this.gl=this.isWebGL?this.game.renderer.gl:null,this.phaserRenderer=this.game.renderer,this.canvasRenderer=null,this.skeletonDataCache=this.game.cache.addCustom("esotericsoftware.spine.skeletonFile.cache"),this.atlasCache=this.game.cache.addCustom("esotericsoftware.spine.atlas.cache"),t.registerFileType("spineJson",(function(e,t,s){let i=new Dn(this,e,t,Fn.json,s);return this.addFile(i.files),this}),e),t.registerFileType("spineBinary",(function(e,t,s){let i=new Dn(this,e,t,Fn.binary,s);return this.addFile(i.files),this}),e),t.registerFileType("spineAtlas",(function(e,t,s,i){let n=new Yn(this,e,t,s,i);return this.addFile(n.files),this}),e),t.registerGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:Ae,(function(e,t,n,a,r){this.scene.sys.renderer instanceof i.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.clear();const o=this.scene.sys[s];let l=new Tn(this.scene,o,e,t,n,a,r);return this.displayList.add(l),this.updateList.add(l),this.scene.sys.renderer instanceof i.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.rebind(),l}),(function(e,t=!1){this.scene.sys.renderer instanceof i.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.clear();let n=e.x?e.x:0,a=e.y?e.y:0,r=e.boundsProvider?e.boundsProvider:void 0;const o=this.scene.sys[s];let l=new Tn(this.scene,o,n,a,e.dataKey,e.atlasKey,r);return void 0!==t&&(e.add=t),this.scene.sys.renderer instanceof i.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.rebind(),i.GameObjects.BuildGameObject(this.scene,l,e)}))}static rendererId=0;boot(){ys.yDown=!0,this.isWebGL?(_n.gameWebGLRenderer||(_n.gameWebGLRenderer=new rn(this.game.renderer.canvas,this.gl,!0)),this.onResize(),this.game.scale.on(i.Scale.Events.RESIZE,this.onResize,this)):this.canvasRenderer||(this.canvasRenderer=new Ln(this.scene.sys.context));var e=this.systems.events;e.once("shutdown",this.shutdown,this),e.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)}onResize(){var e=this.game.renderer,t=this.webGLRenderer;if(e&&t){var s=e.width,i=e.height;t.camera.position.x=s/2,t.camera.position.y=i/2,t.camera.up.y=-1,t.camera.direction.z=1,t.camera.setViewport(s,i)}}shutdown(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(i.Scale.Events.RESIZE,this.onResize,this)}destroy(){this.shutdown()}gameDestroy(){this.pluginManager.removeGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:Ae,!0,!0),this.webGLRenderer&&this.webGLRenderer.dispose(),_n.gameWebGLRenderer=null}getAtlas(e){let t;if(this.atlasCache.exists(e))t=this.atlasCache.get(e);else{let s=this.game.cache.text.get(e);if(t=new Qt(s.data),this.isWebGL){let s=this.gl;const i=s.getParameter(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL);i&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);for(let i of t.pages)i.setTexture(new Si(s,this.game.textures.get(e+"!"+i.name).getSourceImage(),!1));i&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)}else for(let s of t.pages)s.setTexture(new Rn(this.game.textures.get(e+"!"+s.name).getSourceImage()));this.atlasCache.add(e,t)}return t}isAtlasPremultiplied(e){let t=this.game.cache.text.get(e);return!!t&&t.premultipliedAlpha}getSkeletonData(e,t){const s=this.getAtlas(t),i=e+t;let n;if(this.skeletonDataCache.exists(i))n=this.skeletonDataCache.get(i);else{if(this.game.cache.json.exists(e)){let t=this.game.cache.json.get(e);n=new mi(new rs(s)).readSkeletonData(t)}else{let t=this.game.cache.binary.get(e);n=new Es(new rs(s)).readSkeletonData(new Uint8Array(t))}this.skeletonDataCache.add(i,n)}return n}createSkeleton(e,t){return new ys(this.getSkeletonData(e,t))}}var Fn;!function(e){e[e.json=0]="json",e[e.binary=1]="binary"}(Fn||(Fn={}));class Dn extends i.Loader.MultiFile{fileType;constructor(e,t,s,n,a){if("string"!=typeof t){const e=t;t=e.key,s=e.url,n="spineJson"===e.type?Fn.json:Fn.binary,a=e.xhrSettings}let r=null;r=n==Fn.json?new i.Loader.FileTypes.JSONFile(e,{key:t,url:s,extension:"json",xhrSettings:a}):new i.Loader.FileTypes.BinaryFile(e,{key:t,url:s,extension:"skel",xhrSettings:a}),super(e,"spineSkeletonData",t,[r]),this.fileType=n}onFileComplete(e){this.pending--}addToCache(){this.isReadyToProcess()&&this.files[0].addToCache()}}class Yn extends i.Loader.MultiFile{premultipliedAlpha;constructor(e,t,s,n,a){if("string"!=typeof t){const e=t;t=e.key,s=e.url,n=e.premultipliedAlpha,a=e.xhrSettings}super(e,"spineAtlasData",t,[new i.Loader.FileTypes.TextFile(e,{key:t,url:s,xhrSettings:a,extension:"atlas"})]),this.premultipliedAlpha=n}onFileComplete(e){if(-1!=this.files.indexOf(e)&&(this.pending--,"text"==e.type)){var t=e.data.split(/\r\n|\r|\n/);let h=[];h.push(t[0]);for(var s=1;s<t.length;s++){var n=t[s];""===n.trim()&&s<t.length-1&&(n=t[s+1],h.push(n))}let c=e.src.match(/^.*\//)??"";for(var a=0;a<h.length;a++){var r=c+h[a],o=e.key+"!"+h[a],l=new i.Loader.FileTypes.ImageFile(this.loader,o,r);this.loader.keyExists(l)||(this.addToMultiFile(l),this.loader.addFile(l))}}}addToCache(){if(this.isReadyToProcess()){let e=this.loader.textureManager;for(let t of this.files)"image"==t.type?e.exists(t.key)||e.addImage(t.key,t.data):(this.premultipliedAlpha=this.premultipliedAlpha??(t.data.indexOf("pma: true")>=0||t.data.indexOf("pma:true")>=0),t.data={data:t.data,premultipliedAlpha:this.premultipliedAlpha},t.addToCache())}}}window.spine={SpinePlugin:_n},window["spine.SpinePlugin"]=_n;class On{static calculateVelocity(e,t){return this.scaleVector(e,t)}static calculateAcceleration(e,t){return this.scaleVector(e,t)}static calculateDirection(e,t){if(Xn.equals(e,t))return Xn.zero();const s=this.calculateDisplacement(e,t);return Xn.normalize(s)}static calculateAngle(e){return Math.atan2(e.y,e.x)}static scaleVector(e,t){if(Xn.isZero(e))return Xn.zero();const s=Xn.normalize(e);return Xn.scale(s,t)}static calculateDisplacement(e,t){return Xn.equals(e,t)?Xn.zero():Xn.subtract(t,e)}}const Xn={zero:()=>({x:0,y:0}),normalize:e=>{const t=Math.sqrt(e.x**2+e.y**2);return 0!==t?{x:e.x/t,y:e.y/t}:Xn.zero()},scale:(e,t)=>{if(Xn.isZero(e))return Xn.zero();const s=Xn.normalize(e);return{x:s.x*t,y:s.y*t}},multiply:(e,t)=>({x:e.x*t.x,y:e.y*t.y}),subtract:(e,t)=>({x:e.x-t.x,y:e.y-t.y}),equals:(e,t)=>e.x===t.x&&e.y===t.y,isZero:e=>0===e.x&&0===e.y};class Vn{_entity;_value;_component;constructor(e,t,s){this._entity=e,this._value=s,this._component=t}get uniqueId(){return this._entity.uniqueId}addComponent(e){return this._entity.addComponent(e)}addComponentsRecursively(){this._entity.addComponentsRecursively()}initializeAllComponents(){this._entity.initializeAllComponents()}}class Nn extends Vn{constructor(e,t,s){super(e,t,s)}get value(){return this._value??0}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.value[this.uniqueId]=this.value}}class Un extends Vn{constructor(e,t,s){super(e,t,s)}get value(){return this._value??Xn.zero()}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.x[this.uniqueId]=this.value.x,this._component.y[this.uniqueId]=this.value.y}}var zn;!function(e){e[e.ELLIPSE=0]="ELLIPSE",e[e.POLYGON=1]="POLYGON",e[e.LINE=2]="LINE"}(zn||(zn={}));class Gn extends Vn{constructor(e,t,s){super(e,t,s)}get value(){return this._value??{x:0,y:0,z:0}}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.x[this.uniqueId]=this.value.x,this._component.y[this.uniqueId]=this.value.y,this._component.z[this.uniqueId]=this.value.z}}class Wn extends Vn{constructor(e,t,s){super(e,t,s)}get value(){return this._value??!1}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.value[this.uniqueId]=this.value?1:0}}const qn={value:ke.f32},jn={width:ke.f32,height:ke.f32},Hn={x:ke.f32,y:ke.f32},Jn={x:ke.f32,y:ke.f32,z:ke.f32},$n={value:ke.ui8},Kn={magnitude:ke.f32,initialSpeed:ke.f32},Qn={id:ke.ui16},Zn=pe(Hn),ea=pe(Hn),ta=pe(qn),sa=pe(Hn),ia=pe($n),na=pe(Kn),aa=pe(jn),ra=pe(qn),oa=pe(Jn),la=pe(Jn),ha=pe(qn),ca=pe(Hn),da=pe(Qn);class ua{_component;_id;constructor(e,t){this._id=t??-1,this._component=e}get entityId(){return this._id}set entityId(e){this._id=e}}class pa extends ua{constructor(e,t){super(e,t)}get value(){return this._component.value[this.entityId]}set value(e){this._component.value[this.entityId]=e}}class ma extends ua{constructor(e,t){super(e,t)}get x(){return this._component.x[this.entityId]}get y(){return this._component.y[this.entityId]}get vector(){return{x:this.x,y:this.y}}set x(e){this._component.x[this.entityId]=e}set y(e){this._component.y[this.entityId]=e}set vector(e){this._component.x[this.entityId]=e.x,this._component.y[this.entityId]=e.y}}class ga extends ua{constructor(e,t){super(e,t)}get x(){return this._component.x[this.entityId]}get y(){return this._component.y[this.entityId]}get z(){return this._component.z[this.entityId]}get vector2(){return{x:this.x,y:this.y}}get vector3(){return{x:this.x,y:this.y,z:this.z}}set x(e){this._component.x[this.entityId]=e}set y(e){this._component.y[this.entityId]=e}set z(e){this._component.z[this.entityId]=e}set vector2(e){this._component.x[this.entityId]=e.x,this._component.y[this.entityId]=e.y}set vector3(e){this._component.x[this.entityId]=e.x,this._component.y[this.entityId]=e.y,this._component.z[this.entityId]=e.z}}const fa=new ma(Zn),ya=(new ma(ea),new class extends ua{constructor(e){super(aa,e)}get width(){return this._component.width[this.entityId]}get height(){return this._component.height[this.entityId]}get value(){return{width:this.width,height:this.height}}set width(e){this._component.width[this.entityId]=e}set height(e){this._component.height[this.entityId]=e}set value(e){this._component.width[this.entityId]=e.x,this._component.height[this.entityId]=e.y}}),xa=new class extends ua{constructor(e){super(na,e)}get initialSpeed(){return this._component.initialSpeed[this.entityId]}set initialSpeed(e){this._component.initialSpeed[this.entityId]=e}get magnitude(){return this._component.magnitude[this.entityId]}set magnitude(e){this._component.magnitude[this.entityId]=e}},wa=(new pa(ta),new ma(sa)),ba=new class extends ua{constructor(e,t){super(e,t)}get value(){return this._component.value[this.entityId]>0}set value(e){this._component.value[this.entityId]=e?1:0}}(ia),va=new pa(ra),Sa=new ga(oa),ka=new ga(la),Ia=new pa(ha),Aa=(new ma(ca),new class extends ua{constructor(e,t){super(e,t)}get value(){return this._component.id[this.entityId]}set value(e){this._component.id[this.entityId]=e}}(da));class Ea extends Vn{constructor(e,t){super(e,na,t)}get value(){return this._value??{magnitude:0,initialSpeed:0}}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.magnitude[this.uniqueId]=this.value.magnitude,this._component.initialSpeed[this.uniqueId]=this.value.initialSpeed}}class Ca extends Vn{constructor(e,t){super(e,aa,t)}get value(){return this._value??{width:0,height:0}}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.width[this.uniqueId]=this.value.width,this._component.height[this.uniqueId]=this.value.height}}class Pa extends Vn{constructor(e,t,s){super(e,t,s)}get value(){return this._value??-1}addComponentsRecursively(){super.addComponentsRecursively(),super.addComponent(this._component)}initializeAllComponents(){super.initializeAllComponents(),this._component.id[this.uniqueId]=this.value}}class Ma extends Un{constructor(e,t){super(e,Zn,t)}}class Ta extends Un{constructor(e,t){super(e,sa,t)}}class Ra extends Wn{constructor(e,t){super(e,ia,t)}}class Ba extends Nn{constructor(e,t){super(e,ra,t)}}class La extends Gn{constructor(e,t){super(e,oa,t)}}class _a extends Gn{constructor(e,t){super(e,la,t)}}class Fa extends Nn{constructor(e,t){super(e,ha,t)}}class Da extends Pa{constructor(e,t){super(e,da,t)}}class Ya{controllers=new Map;constructor(){}addController(e){let t=e.constructor;const s=Object.getPrototypeOf(t);s!==Object&&(t=s),this.controllers.set(t,e)}get(e){const t=this.controllers.get(e);return t instanceof e?t:void 0}hasController(e){return this.controllers.has(e)}removeController(e){this.controllers.delete(e)}}class Oa extends Phaser.GameObjects.Graphics{id;controllers=new Ya;constructor(e,t){super(t),this.id=e}}class Xa extends Phaser.GameObjects.Image{id;controllers=new Ya;constructor(e,t){super(t,0,0,""),this.id=e}}class Va{name;gameObject;constructor(e,t){this.name=e,this.gameObject=t}}class Na extends Va{constructor(e,t){super(e,t),this.gameObject.scene.physics.add.existing(this.gameObject)}get physicBody(){return this.gameObject.body}setVelocity(e){this.physicBody.setVelocity(e.x,e.y)}setAcceleration(e){this.physicBody.setAcceleration(e.x,e.y)}enableGravity(e){this.physicBody.setAllowGravity(e)}}class Ua{name;gameObject;constructor(e,t){this.name=e,this.gameObject=t}}class za extends Ua{constructor(e,t){super(e,t)}render(e,t){this.gameObject.clear(),this.gameObject.fillStyle(t.color,1),this.gameObject.fillEllipse(0,0,t.size.width,t.size.height),e.add.existing(this.gameObject)}}class Ga{name;gameObject;constructor(e,t){this.name=e,this.gameObject=t}}class Wa extends Ga{constructor(e,t){super(e,t)}get position(){return{x:this.gameObject.x,y:this.gameObject.y}}get rotation(){return this.gameObject.rotation}get scale(){return{x:this.gameObject.scaleX,y:this.gameObject.scaleY}}set position(e){this.gameObject.setPosition(e.x,e.y)}set rotation(e){this.gameObject.rotation=e}}class qa{_id;_world;constructor(e,t){this._id=e,this._world=t}addComponent(e){ge(this._world,e,this._id)}get uniqueId(){return this._id}addComponentsRecursively(){}initializeAllComponents(){}}class ja{_entity;constructor(e){const t=(e=>{const t=e[ve]?U.length?U.shift():X++:U.length>Math.round(.01*V)?U.shift():X++;if(t>e[fe])throw new Error("bitECS - max entities reached");return e[D].add(t),G.set(t,e),e[j].forEach((s=>{re(e,s,t)&&oe(s,t)})),e[F].set(t,new Set),t})(e);this._entity=new qa(t,e)}}const Ha=JSON.parse('{"section1":{"files":[{"url":["assets/sounds/Alert1_01.mp3"],"type":"audio","key":"Alert1_01"},{"url":"assets/AlertImg.png","type":"image","key":"AlertImg"},{"url":"assets/Animations/animations.json","type":"animation","key":"animations"},{"url":"assets/bg1.png","type":"image","key":"bg1"},{"url":"assets/bg2.png","type":"image","key":"bg2"},{"url":["assets/sounds/bgMusic.mp3"],"type":"audio","key":"bgMusic"},{"url":"assets/SpineAnimations/InfoSphere/BIGBUS.json","type":"spineJson","key":"BIGBUS","previewAtlasKey":"BIGBUS-atlas"},{"url":"assets/SpineAnimations/InfoSphere/BIGBUS.atlas","type":"spineAtlas","key":"BIGBUS-atlas"},{"url":"assets/BulletIcon.png","type":"image","key":"BulletIcon"},{"url":"assets/Cannon.png","type":"image","key":"Cannon"},{"url":"assets/Animations/JumpNRunAnimations/CompanionBot.png","frameConfig":{"frameWidth":32,"frameHeight":32,"startFrame":0,"endFrame":-1,"spacing":0,"margin":0},"type":"spritesheet","key":"CompanionBot"},{"atlasURL":"assets/Animations/JumpNRunAnimations/CompanionBot.json","textureURL":"assets/Animations/JumpNRunAnimations/CompanionBot.png","type":"atlas","key":"CompanionBot_1"},{"url":"assets/CoreIcon.png","type":"image","key":"CoreIcon"},{"url":"assets/Animations/JumpNRunAnimations/Deacon.png","frameConfig":{"frameWidth":32,"frameHeight":32,"startFrame":0,"endFrame":-1,"spacing":0,"margin":0},"type":"spritesheet","key":"Deacon"},{"atlasURL":"assets/Animations/JumpNRunAnimations/Deacon.json","textureURL":"assets/Animations/JumpNRunAnimations/Deacon.png","type":"atlas","key":"Deacon_1"},{"url":["assets/sounds/dead1_01.mp3"],"type":"audio","key":"dead1_01"},{"url":["assets/sounds/dead2_01.mp3"],"type":"audio","key":"dead2_01"},{"url":["assets/sounds/dead3_01.mp3"],"type":"audio","key":"dead3_01"},{"url":["assets/sounds/dead4_01.mp3"],"type":"audio","key":"dead4_01"},{"url":"assets/SpineAnimations/Enemy1/Enemy1.json","type":"spineJson","key":"Enemy1","previewAtlasKey":"Enemy1-atlas"},{"url":"assets/SpineAnimations/Enemy1/Enemy1.atlas","type":"spineAtlas","key":"Enemy1-atlas"},{"url":"assets/SpineAnimations/Enemy10/Enemy10.json","type":"spineJson","key":"Enemy10","previewAtlasKey":"Enemy10-atlas"},{"url":"assets/SpineAnimations/Enemy10/Enemy10.atlas","type":"spineAtlas","key":"Enemy10-atlas"},{"url":"assets/SpineAnimations/Enemy11/Enemy11.json","type":"spineJson","key":"Enemy11","previewAtlasKey":"Enemy11-atlas"},{"url":"assets/SpineAnimations/Enemy11/Enemy11.atlas","type":"spineAtlas","key":"Enemy11-atlas"},{"url":"assets/SpineAnimations/Enemy12/Enemy12.json","type":"spineJson","key":"Enemy12","previewAtlasKey":"Enemy12-atlas"},{"url":"assets/SpineAnimations/Enemy12/Enemy12.atlas","type":"spineAtlas","key":"Enemy12-atlas"},{"url":"assets/SpineAnimations/Enemy2/Enemy2.json","type":"spineJson","key":"Enemy2","previewAtlasKey":"Enemy2-atlas"},{"url":"assets/SpineAnimations/Enemy2/Enemy2.atlas","type":"spineAtlas","key":"Enemy2-atlas"},{"url":"assets/SpineAnimations/Enemy3/Enemy3.json","type":"spineJson","key":"Enemy3","previewAtlasKey":"Enemy3-atlas"},{"url":"assets/SpineAnimations/Enemy3/Enemy3.atlas","type":"spineAtlas","key":"Enemy3-atlas"},{"url":"assets/SpineAnimations/Enemy4/Enemy4.json","type":"spineJson","key":"Enemy4","previewAtlasKey":"Enemy4-atlas"},{"url":"assets/SpineAnimations/Enemy4/Enemy4.atlas","type":"spineAtlas","key":"Enemy4-atlas"},{"url":"assets/SpineAnimations/Enemy5/Enemy5.json","type":"spineJson","key":"Enemy5","previewAtlasKey":"Enemy5-atlas"},{"url":"assets/SpineAnimations/Enemy5/Enemy5.atlas","type":"spineAtlas","key":"Enemy5-atlas"},{"url":"assets/SpineAnimations/Enemy6/Enemy6.json","type":"spineJson","key":"Enemy6","previewAtlasKey":"Enemy6-atlas"},{"url":"assets/SpineAnimations/Enemy6/Enemy6.atlas","type":"spineAtlas","key":"Enemy6-atlas"},{"url":"assets/SpineAnimations/Enemy7/Enemy7.json","type":"spineJson","key":"Enemy7","previewAtlasKey":"Enemy7-atlas"},{"url":"assets/SpineAnimations/Enemy7/Enemy7.atlas","type":"spineAtlas","key":"Enemy7-atlas"},{"url":"assets/SpineAnimations/Enemy8/Enemy8.json","type":"spineJson","key":"Enemy8","previewAtlasKey":"Enemy8-atlas"},{"url":"assets/SpineAnimations/Enemy8/Enemy8.atlas","type":"spineAtlas","key":"Enemy8-atlas"},{"url":"assets/SpineAnimations/Enemy9/Enemy9.json","type":"spineJson","key":"Enemy9","previewAtlasKey":"Enemy9-atlas"},{"url":"assets/SpineAnimations/Enemy9/Enemy9.atlas","type":"spineAtlas","key":"Enemy9-atlas"},{"url":["assets/sounds/EnemyExplode1_01.mp3"],"type":"audio","key":"EnemyExplode1_01"},{"url":["assets/sounds/EnemyExplode2_01.mp3"],"type":"audio","key":"EnemyExplode2_01"},{"url":["assets/sounds/EnemyExplode3_01.mp3"],"type":"audio","key":"EnemyExplode3_01"},{"url":["assets/sounds/EnemyExplode4_01.mp3"],"type":"audio","key":"EnemyExplode4_01"},{"url":["assets/sounds/EnemyExplode5_01.mp3"],"type":"audio","key":"EnemyExplode5_01"},{"url":["assets/sounds/EnemyExplode6_01.mp3"],"type":"audio","key":"EnemyExplode6_01"},{"url":["assets/sounds/EnemyLaser_01.mp3"],"type":"audio","key":"EnemyLaser_01"},{"url":["assets/sounds/EnemylaserShoot1_01.mp3"],"type":"audio","key":"EnemylaserShoot1_01"},{"url":["assets/sounds/EnemylaserShoot2_01.mp3"],"type":"audio","key":"EnemylaserShoot2_01"},{"url":["assets/sounds/EnemylaserShoot3_01.mp3"],"type":"audio","key":"EnemylaserShoot3_01"},{"url":["assets/sounds/EnemylaserShoot4_01.mp3"],"type":"audio","key":"EnemylaserShoot4_01"},{"url":"assets/EnemyLaserTexture.png","type":"image","key":"EnemyLaserTexture"},{"url":"assets/EnemyLaserTexture2.png","type":"image","key":"EnemyLaserTexture2"},{"url":"assets/EnemyLaserTexture3.png","type":"image","key":"EnemyLaserTexture3"},{"url":"assets/SpineAnimations/Enemy1Old/EnemyV1.json","type":"spineJson","key":"EnemyV1","previewAtlasKey":"EnemyV1-atlas"},{"url":"assets/SpineAnimations/Enemy1Old/EnemyV1.atlas","type":"spineAtlas","key":"EnemyV1-atlas"},{"url":"assets/FinalBtn.png","type":"image","key":"FinalBtn"},{"url":"assets/FinalImage.png","type":"image","key":"FinalImage"},{"url":"assets/FullScreenBtn.png","type":"image","key":"FullScreenBtn"},{"url":"assets/FxOffBtn.png","type":"image","key":"FxOffBtn"},{"url":"assets/FxOnBtn.png","type":"image","key":"FxOnBtn"},{"url":"assets/gameTitle.png","type":"image","key":"gameTitle"},{"url":"assets/HelpMovile.png","type":"image","key":"HelpMovile"},{"url":"assets/HelpPc.png","type":"image","key":"HelpPc"},{"url":"assets/SpineAnimations/IdlePlayer/Idle.json","type":"spineJson","key":"Idle","previewAtlasKey":"Idle-atlas"},{"url":"assets/SpineAnimations/IdlePlayer/Idle.atlas","type":"spineAtlas","key":"Idle-atlas"},{"url":"assets/SpineAnimations/InfoSphere/InfoSphere.json","type":"spineJson","key":"InfoSphere","previewAtlasKey":"InfoSphere-atlas"},{"url":"assets/SpineAnimations/InfoSphere/InfoSphere.atlas","type":"spineAtlas","key":"InfoSphere-atlas"},{"url":["assets/sounds/IsDead_01.mp3"],"type":"audio","key":"IsDead_01"},{"url":["assets/sounds/jump1.mp3"],"type":"audio","key":"jump1"},{"url":["assets/sounds/jump2.mp3"],"type":"audio","key":"jump2"},{"url":["assets/sounds/jump3.mp3"],"type":"audio","key":"jump3"},{"url":["assets/sounds/jump4.mp3"],"type":"audio","key":"jump4"},{"url":"assets/JumpBtn.png","type":"image","key":"JumpBtn"},{"url":"assets/Animations/JumpNRunAnimations/JumpNRunAnimations.png","frameConfig":{"frameWidth":80,"frameHeight":80,"startFrame":0,"endFrame":-1,"spacing":0,"margin":0},"type":"spritesheet","key":"JumpNRunAnimations"},{"url":"assets/LaserIcon.png","type":"image","key":"LaserIcon"},{"url":"assets/LaserInterval.png","type":"image","key":"LaserInterval"},{"url":"assets/LaserPower.png","type":"image","key":"LaserPower"},{"url":["assets/sounds/laserShoot1_01.mp3"],"type":"audio","key":"laserShoot1_01"},{"url":["assets/sounds/laserShoot2_01.mp3"],"type":"audio","key":"laserShoot2_01"},{"url":["assets/sounds/laserShoot3_01.mp3"],"type":"audio","key":"laserShoot3_01"},{"url":["assets/sounds/laserShoot4_01.mp3"],"type":"audio","key":"laserShoot4_01"},{"url":"assets/LaserSpeed.png","type":"image","key":"LaserSpeed"},{"url":"assets/laserTexture.png","type":"image","key":"laserTexture"},{"url":"assets/MagnetPower.png","type":"image","key":"MagnetPower"},{"url":"assets/MagnetSpeed.png","type":"image","key":"MagnetSpeed"},{"url":"assets/SpineAnimations/Enemy7/MainEnemy.json","type":"spineJson","key":"MainEnemy","previewAtlasKey":"MainEnemy-atlas"},{"url":"assets/SpineAnimations/Enemy7/MainEnemy.atlas","type":"spineAtlas","key":"MainEnemy-atlas"},{"url":"assets/MineInterval.png","type":"image","key":"MineInterval"},{"url":"assets/MinePower.png","type":"image","key":"MinePower"},{"url":"assets/MineSpeed.png","type":"image","key":"MineSpeed"},{"url":"assets/missileV1.png","type":"image","key":"missile"},{"url":"assets/MissileIcon.png","type":"image","key":"missile"},{"url":"assets/MissileInterval.png","type":"image","key":"MissileInterval"},{"url":"assets/MissilePower.png","type":"image","key":"MissilePower"},{"url":["assets/sounds/MissileShot_01.mp3"],"type":"audio","key":"MissileShot_01"},{"url":"assets/MissileSize.png","type":"image","key":"MissileSize"},{"url":"assets/MissileSpeed.png","type":"image","key":"MissileVelocity"},{"url":"assets/MusicOffBtn.png","type":"image","key":"MusicOffBtn"},{"url":"assets/MusicOnBtn.png","type":"image","key":"MusicOnBtn"},{"url":"assets/OnlyCannon.png","type":"image","key":"OnlyCannon"},{"url":"assets/particleImage.png","type":"image","key":"particleImage"},{"url":"assets/particleImageBlue.png","type":"image","key":"particleImageBlue"},{"url":"assets/SpineAnimations/Player/Player.json","type":"spineJson","key":"Player","previewAtlasKey":"Player-atlas"},{"url":"assets/SpineAnimations/Player/Player.atlas","type":"spineAtlas","key":"Player-atlas"},{"url":"assets/PlayerShield.png","type":"image","key":"PlayerShield"},{"url":"assets/PlayerSpeed.png","type":"image","key":"PlayerSpeed"},{"url":["assets/sounds/powerUp_01.mp3"],"type":"audio","key":"powerUp_01"},{"url":"assets/RainInterval.png","type":"image","key":"RainInterval"},{"url":"assets/RainPower.png","type":"image","key":"RainPower"},{"url":"assets/RainVelocity.png","type":"image","key":"RainVelocity"},{"url":"assets/restartBtn.png","type":"image","key":"restartBtn"},{"url":"assets/RunningIcon.png","type":"image","key":"RunningIcon"},{"url":"assets/SawBouncingTime.png","type":"image","key":"SawBouncingTime"},{"url":"assets/sawBullet.png","type":"image","key":"sawBullet"},{"url":"assets/SawInterval.png","type":"image","key":"SawInterval"},{"url":"assets/SawPower.png","type":"image","key":"SawPower"},{"url":"assets/SawSize.png","type":"image","key":"SawSize"},{"url":"assets/SawSpeed.png","type":"image","key":"SawSpeed"},{"url":"assets/selector.png","type":"image","key":"selector"},{"url":"assets/ShieldIcon.png","type":"image","key":"ShieldIcon"},{"url":"assets/ShieldLife.png","type":"image","key":"ShieldLife"},{"url":"assets/ShieldLifeTime.png","type":"image","key":"ShieldLifeTime"},{"url":"assets/swordWeapon.png","type":"image","key":"swordWeapon"},{"url":"assets/TheBuilding.png","type":"image","key":"TheBuilding"},{"url":"assets/UpgradeBtn.png","type":"image","key":"UpgradeBtn"}]},"meta":{"app":"Phaser Editor 2D - Asset Pack Editor","contentType":"phasereditor2d.pack.core.AssetContentType","url":"https://phasereditor2d.com","version":2,"showAllFilesInBlocks":false,"visible":true}}'),Ja=Ha.section1.files.filter((e=>"image"===e.type)),$a={},Ka={};Ja.forEach(((e,t)=>{const s=t+1;$a[e.key]=s,Ka[s]=e.key}));class Qa{static getIdByKey(e){return $a[e]}static getKeyById(e){return Ka[e]}}class Za extends Ua{constructor(e,t){super(e,t)}render(e,t){const s=Qa.getKeyById(t.textureId);void 0!==s&&(this.gameObject.setTexture(s),this.gameObject.setDisplaySize(t.size.width,t.size.height),e.add.existing(this.gameObject))}}class er extends ja{_scene;_origin=Xn.zero();_depht=0;_size={width:0,height:0};_acceleration={magnitude:0,initialSpeed:0};_target=Xn.zero();_hasGravity=!1;constructor(e){super(e.world),this._scene=e}setOrigin(e){return this._origin=e,this}setDepht(e){return this._depht=e,this}setAcceleration(e){return this._acceleration=e,this}setTarget(e){return this._target=e,this}setSize(e){return this._size=e,this}hasGravity(e){return this._hasGravity=e,this}addComponents(){const e={x:this._origin.x,y:this._origin.y,z:this._depht};this._entity=new La(this._entity,e),this._entity=new _a(this._entity,e),this._entity=new Fa(this._entity),this._entity=new Ea(this._entity,this._acceleration),this._entity=new Ma(this._entity),this._entity=new Ta(this._entity,this._target),this._entity=new Ca(this._entity,this._size),this._entity=new Ra(this._entity,this._hasGravity)}}class tr extends er{_color=0;setColor(e){return this._color=e,this}build(){this.addComponents();const e=new Oa(this._entity.uniqueId,this._scene);return this.addControllers(e),e}addComponents(){super.addComponents(),this._entity=new Ba(this._entity,this._color),this._entity.addComponentsRecursively(),this._entity.initializeAllComponents()}addControllers(e){e.controllers.addController(new Wa("transform",e)),e.controllers.addController(new za("shape",e)),e.controllers.addController(new Na("physic",e))}}class sr extends er{_textureId="";setTextureKey(e){return this._textureId=e,this}build(){this.addComponents();const e=new Xa(this._entity.uniqueId,this._scene);return this.addControllers(e),e}addComponents(){super.addComponents();const e=Qa.getIdByKey(this._textureId);if(void 0===e)throw new Error(`Texture key ${this._textureId} not found`);this._entity=new Da(this._entity,e),this._entity.addComponentsRecursively(),this._entity.initializeAllComponents()}addControllers(e){e.controllers.addController(new Wa("transform",e)),e.controllers.addController(new Na("physic",e)),e.controllers.addController(new Za("texture",e))}}class ir extends Phaser.GameObjects.Image{constructor(e,t,s,i,n){super(e,t??0,s??0,i||"sawBullet",n),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",((e,t)=>this.update(t)))}BulletGravity=100;BulletVelocity=2e3;LifeTime=3e3;Damage=0;create(){this.scene.physics.add.existing(this);const e=this.body;e.setVelocityX(this.BulletVelocity),e.setVelocityY(this.BulletVelocity),e.setGravityY(this.BulletGravity),e.setImmovable(!0),e.setAllowGravity(!1),e.setBounce(1),e.setCollideWorldBounds(!0),this.scene.time.addEvent({delay:this.LifeTime,callback:()=>{this.destroy()}});const t=this.scene.enemies.getChildren();this.scene.physics.add.overlap(this,t,this.handleLaserCollision,void 0,this)}handleLaserCollision(e,t){t.EnemyLife-=1;const s=this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:{min:-1e3,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this),e.destroy()}update(e){}}class nr extends Phaser.GameObjects.Image{constructor(e,t,s,i,n,a,r){super(e,t??0,s??0,i||"AlertImg",n),void 0!==a&&(this.offsetX=a),void 0!==r&&(this.offsetY=r),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",this.update,this)}blinkCount=0;maxBlinks=12;blinkInterval=150;followingPlayer=!0;blinkEvent;offsetX=120;offsetY=200;create(){this.startBlink()}startBlink(){this.blinkCount=0,this.setVisible(!0),this.blinkEvent=this.scene.time.addEvent({delay:this.blinkInterval,repeat:2*this.maxBlinks-1,callback:()=>{this.setVisible(!this.visible),this.blinkCount++,this.blinkCount>=2*this.maxBlinks&&(this.blinkEvent&&this.blinkEvent.remove(!1),this.destroy())}})}update(e,t){if(!this.followingPlayer)return;const s=this.scene,i=s&&s.player;i&&void 0!==i.x&&void 0!==i.y&&(this.x+=(i.x+this.offsetX-this.x)*Math.min(1,t/200),this.y+=(i.y+this.offsetY-(i.height?i.height/2:0)-this.y)*Math.min(1,t/200))}}class ar extends Tn{trailParticles;doublejumparticles;shootBulletParciles;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Player",a??"Player-atlas",o??new Mn("Idle",["default"])),this.setInteractive(new Phaser.Geom.Rectangle(0,0,100,600),Phaser.Geom.Rectangle.Contains),this.skeleton.setSkinByName(r??"default"),this.scaleX=.5,this.scaleY=.5,this.setOrigin(.5,.5),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",this.updatePlayerCallback,this)}PlayerSpeed=1400;cursors;currentAnimation="Idle";facingLeft=!1;isJumping=!1;fallMultiplier=3.5;playerGravity=3500;JumpVelocity=2500;IsFalling=!1;mouseInactiveTimer=0;mouseInactiveThreshold=500;hasDoubleJumped=!1;lastShotTime=2e3;shotInterval=250;laserColor="FF0000";laserSpeed=3e3;laserDuration=500;isInAir=!1;TouchX=0;TouchY=0;TouchJump=!1;factor=.5;collectedParticles=0;IsRolling=!1;IsFallingAfterCannon=!1;CannonVelo=8e3;SawMissileInterval=4e3;LastSawMissileTime=4e3;lastShotTimeMissile=2e3;Shield;IsShieldActive=!0;ShieldLife=30;IsDead=!1;OrioginalShieldLife=this.ShieldLife;ShieldRestoreTime=1e4;IsRestoringShield=!1;WannaSord;justTinted;MissileSize=100;SawMissileSize=1;SawMissile=1;SawMissileDamage=5;SawMissileVelocity=1e3;SawBulletLifeTime=3e3;SawBulletInterval=100;AddSawMissile=1;AttractionRange=600;AttractionSpeed=2e3;_graphics=this.scene.add.graphics();updatePlayerCallback=(e,t)=>this.updatePlayer(t);create(){this.factor=this.scene.scale.height/this.scene.scale.width,this.flipX=!0,this.Shield=this.scene.add.sprite(0,0,"PlayerShield"),this.Shield.postFX.addBloom(16777215,1,1,1.5,1),this.Shield.postFX.addShine(1,.5,4,.5,.5,.5),this.scene.add.existing(this.Shield),this.scene.physics.add.existing(this.Shield);const e=this.Shield.body;e.setAllowGravity(!1),e.setImmovable(!0),e.setCircle(this.Shield.width/2),this.scene.physics.add.existing(this);const t=this.body;t.setCollideWorldBounds(!1),t.setGravityY(this.playerGravity),t.setSize(400,450),t.setOffset(140,210),this.scene.input.keyboard&&(this.cursors=this.scene.input.keyboard.createCursorKeys(),this.scene.input.keyboard.addKeys({A:Phaser.Input.Keyboard.KeyCodes.A,D:Phaser.Input.Keyboard.KeyCodes.D,W:Phaser.Input.Keyboard.KeyCodes.W,S:Phaser.Input.Keyboard.KeyCodes.S,SPACE:Phaser.Input.Keyboard.KeyCodes.SPACE})),this.setAnimation("Idle",!0);const s=this.scene.scene.get("GameUI");s.events.on("joystickMove",this.handleJoystickMove,this),s.events.on("jump",this.handleJump,this),this.on("PlayerIsDead",(()=>{const e=this.body;e.setEnable(!1),e.setImmovable(!0)}),this)}hideAndRoll(e,t){if(!this.IsRolling){this.IsRolling=!0,this.setAnimation("Roll",!0);const s=this.body;s.setEnable(!1),this.Shield.setVisible(!1),this.x=e,this.y=t,this.scene.time.delayedCall(500,(()=>{this.scene.cameras.main.shake(900,.1)})),this.scene.time.delayedCall(1e3,(()=>{this.Shield.setVisible(!0),this.IsRolling=!1,s.setEnable(!0),this.IsFallingAfterCannon=!0;const e=this.CannonVelo,t=Phaser.Math.DegToRad(30),i=Math.cos(t),n=Math.sin(t);s.setVelocity(i*e,-n*e)}))}}handleJump(e){this.TouchJump=e}handleJoystickMove(e){this.body,e.x>0?this.TouchX=1:e.x<0?this.TouchX=-1:this.TouchX=0,e.y>.9?this.TouchY=1:e.y<0?this.TouchY=-1:this.TouchY=0}setAnimation(e,t){this.animationState.setAnimation(0,e,t)}resetMouseInactiveTimer(){this.mouseInactiveTimer=0}scanAndDestroy(){this.scene.enemies.getChildren().forEach((e=>{e.IsNearPlayer?(this.scene.time.now>this.lastShotTimeMissile+1e3&&(this.createLaserParticles(),this.scene.time.delayedCall(100,(()=>{})),this.lastShotTimeMissile=this.scene.time.now),this.scene.time.now>this.lastShotTime+this.shotInterval&&(this.createLaserParticles(),this.scene.time.delayedCall(100,(()=>{})),this.lastShotTime=this.scene.time.now)):this._graphics.clear()}))}castRay(e){this._graphics.clear(),this._graphics.lineStyle(4,16711680,1),this._graphics.strokeLineShape(new Phaser.Geom.Line(this.x,this.y,e.x,e.y))}shootSawBullet(e){for(let e=0;e<this.AddSawMissile;e++)if(this.SawMissile>0){if(!this.scene.scene.get("Level").isFxMuted){const e=["MissileShot_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const e=this.scene.add.existing(new ir(this.scene,this.x,this.y));e.BulletVelocity=this.SawMissileVelocity,e.setScale(this.SawMissileSize),e.Damage=this.SawMissileDamage,e.LifeTime=this.SawBulletLifeTime,this.scene.tweens.add({targets:e,angle:360,duration:500,repeat:-1})}}handleMissileBoundsCollision(e){const t=this.scene.cameras.main,s=e.body;e.x>t.worldView.x+t.worldView.width-100&&(s.velocity.x*=-1)}shootMisile(e){const t=new sr(this.scene).setOrigin({x:this.x,y:this.y}).setTextureKey("missile").setSize({width:this.MissileSize,height:this.MissileSize}).setAcceleration({magnitude:3e3,initialSpeed:-100}).setTarget({x:e.x,y:e.y}).hasGravity(!0).build();this.scene.time.addEvent({delay:1e4,callback:()=>{t.destroy()}}),this.scene.enemies.getChildren().forEach((e=>{e.IsNearPlayer&&this.scene.physics.add.overlap(t,e,this.handleLaserCollision,void 0,this)})),this.scene.addGameObject(t)}shootBullet(e){const t=new tr(this.scene).setOrigin({x:this.x,y:this.y}).setColor(Phaser.Display.Color.HexStringToColor("FF0000").color).setSize({width:100,height:30}).setAcceleration({magnitude:9e3,initialSpeed:1e3}).setTarget({x:e.x,y:e.y}).hasGravity(!0).build();this.scene.time.addEvent({delay:1e4,callback:()=>{t.destroy()}}),this.scene.enemies.getChildren().forEach((e=>{e.IsNearPlayer&&this.scene.physics.add.overlap(t,e,this.handleLaserCollision,void 0,this)})),this.scene.addGameObject(t)}tryToSword(e){this.isJumping&&(this.WannaSord=!0,this.handleSowrdCollision(this,e))}handleSowrdCollision(e,t){if(t.EnemyLife-=1,!this.scene.scene.get("Level").isFxMuted){const e=["EnemylaserShoot1_01","EnemylaserShoot2_01","EnemylaserShoot3_01","EnemylaserShoot4_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const s=this.scene.add.particles(0,0,"particleImage",{x:t.x,y:t.y,speed:{min:-1e3,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this)}handleLaserCollision(e,t){t.EnemyLife-=1;const s=this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:{min:-2e3,max:-2e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this),e.destroy()}createLaserParticles(){const e=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:-30,max:30},angle:{min:0,max:360},lifespan:{min:30,max:200},scale:{start:1,end:0},quantity:1,maxParticles:10,frequency:10});e.setDepth(1),this.scene.time.delayedCall(500,(function(){e.stop(),e.destroy()}),[],this)}updatePlayer(e){const t=(this.body?.position.x??0)+160,s=(this.body?.position.y??0)+70;this.Shield.x+=.5*(t-this.Shield.x),this.Shield.y+=.5*(s-this.Shield.y),this.scene.time.now>this.SawMissileInterval+this.LastSawMissileTime&&this.scene.enemies.getChildren().forEach((e=>{this.scene.time.delayedCall(this.SawBulletInterval,(()=>{this.shootSawBullet(e)})),this.SawMissileInterval=this.scene.time.now}));const i=this.cursors;let n=this.currentAnimation;if(this.IsDead)n="Dead";else{if(this.scene.input.keyboard){const t=this.body;if(this.isInAir&&(i.down.isDown||this.scene.input.keyboard.keys[83].isDown||1==this.TouchY)&&t.velocity.y>0&&(t.setVelocityY(3*this.JumpVelocity),n="HyperFall"),i.left.isDown||this.scene.input.keyboard.keys[65].isDown||-1==this.TouchX?(t.setVelocityX(Phaser.Math.Linear(t.velocity.x,-this.PlayerSpeed,.3)),this.facingLeft||(this.skeleton.scaleX=-1,this.facingLeft=!0),this.isJumping||(n=this.mouseInactiveTimer<=this.mouseInactiveThreshold?"RundAndGun":"Run")):i.right.isDown||this.scene.input.keyboard.keys[68].isDown||1==this.TouchX?(t.setVelocityX(Phaser.Math.Linear(t.velocity.x,this.PlayerSpeed,.3)),this.facingLeft&&(this.skeleton.scaleX=1,this.facingLeft=!1),this.isJumping||(n=this.mouseInactiveTimer<=this.mouseInactiveThreshold?"RundAndGun":"Run")):this.isJumping||(t.setVelocityX(0),n="IdleGun"),i.up.isDown||this.scene.input.keyboard.keys[87].isDown||this.scene.input.keyboard.keys[32].isDown||this.TouchJump)if(this.isJumping)if(this.isJumping&&!this.hasDoubleJumped&&t.velocity.y>0)if(t.setVelocityY(-this.JumpVelocity),this.hasDoubleJumped=!0,n="Roll",this.doublejumparticles=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:0,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:4,end:0},quantity:15,maxParticles:15,frequency:100,gravityY:3e3}),this.playJumpSound(),this.scene.sys.game.device.os.android||this.scene.sys.game.device.os.iOS){const e=this.scene.cameras.main;e.zoomTo(this.factor/6,500),this.scene.time.delayedCall(1e3,(()=>{e.zoomTo(this.factor/5,500)}))}else{const e=this.scene.cameras.main;e.zoomTo(this.factor/4,500),this.scene.time.delayedCall(1e3,(()=>{e.zoomTo(this.factor/3,500)}))}else this.WannaSord?n="SwordDash1":t.blocked.down&&this.disableJumpVars();else this.isJumping=!0,t.setVelocityY(-this.JumpVelocity),this.isInAir=!0,n="Jump",this.doublejumparticles=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:0,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:4,end:0},quantity:15,maxParticles:15,frequency:100,gravityY:3e3}),this.playJumpSound();else t.blocked.down&&this.disableJumpVars();t.velocity.y>0?(this.IsFalling=!0,n="Falling",t.setGravityY(this.playerGravity*this.fallMultiplier),this.IsFallingAfterCannon&&(this.IsFallingAfterCannon=!1,this.createalandingPlatform())):(this.IsFalling=!1,t.setGravityY(this.playerGravity)),this.mouseInactiveTimer+=e}this.mouseInactiveTimer>this.mouseInactiveThreshold&&"IdleGun"===n&&(n="Idle")}n!==this.currentAnimation?(this.animationState.setAnimation(0,n,"Jump"!==n&&"Falling"!==n&&"Dead"!==n),this.currentAnimation=n):"SwordDash1"===n&&this.animationState.addListener({complete:e=>{if(e.animation&&"SwordDash1"===e.animation.name){const e=Phaser.Math.RND.pick(["SwordDash2","SwordDash3"]);this.animationState.setAnimation(0,e,!1),this.animationState.clearListeners()}}});const a=this.body,r=this.cursors&&this.cursors.down&&this.cursors.down.isDown||this.scene.input.keyboard&&this.scene.input.keyboard.keys&&this.scene.input.keyboard.keys[83]&&this.scene.input.keyboard.keys[83].isDown||1==this.TouchY;this.isInAir&&r&&a.velocity.y>0?this.trailParticles=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:0,max:-1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:-3e3}):this.trailParticles&&this.trailParticles.stop(),this.update(e)}disableJumpVars(){this.WannaSord=!1,this.isJumping=!1,this.hasDoubleJumped=!1,this.isInAir=!1,this.IsFalling=!1}playJumpSound(){if(!this.scene.scene.get("Level").isFxMuted){const e=["jump1","jump2","jump3","jump4"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}}handleDamage(e){if(!this.scene.scene.get("Level").isFxMuted){const e=["EnemyExplode2_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}if(this.justTinted||(this.justTinted=!0,this.skeleton.color.set(1,0,0,1),this.scene.time.delayedCall(150,(()=>{this.skeleton.color.set(1,1,1,1),this.justTinted=!1}))),this.IsShieldActive){if(this.ShieldLife-=e,this.scene.tweens.add({targets:this.Shield,alpha:{from:1,to:.5},duration:100,repeat:10,ease:"Bounce.easeOut"}),this.ShieldLife<=this.ShieldLife/2&&this.ShieldLife>0)this.scene.tweens.add({targets:this.Shield,alpha:{from:1,to:.2},duration:100,repeat:10,ease:"Bounce.easeOut"});else if(this.ShieldLife<=0){const e=new nr(this.scene,this.x-120,this.y-120);if(!this.scene.scene.get("Level").isFxMuted){const e=["Alert1_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}this.scene.add.existing(e),this.scene.tweens.add({targets:this.Shield,alpha:{from:1,to:.1},duration:50,repeat:15,ease:"Bounce.easeOut",onComplete:()=>{this.IsShieldActive=!1,this.Shield.setVisible(!1)}})}}else{if(this.IsDead=!0,this.trailParticles&&(this.trailParticles.stop(),this.trailParticles=void 0),!this.scene.scene.get("Level").isFxMuted){const e=["IsDead_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}this.scene.game.events.emit("PlayerIsDead");const e=this.scene.plugins.get("poki");e&&e.gameplayStop()}!this.IsRestoringShield&&this.ShieldLife<this.OrioginalShieldLife&&this.scene.time.addEvent({delay:this.ShieldRestoreTime,callback:()=>{this.restoreShieldLife()}})}restoreShieldLife(){if(!this.scene.scene.get("Level").isFxMuted){const e=["powerUp_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}this.IsRestoringShield=!0,this.ShieldLife=this.OrioginalShieldLife,this.IsShieldActive=!0,this.Shield.setVisible(!0),this.Shield.setAlpha(.1),this.scene.tweens.add({targets:this.Shield,alpha:{from:.1,to:1},duration:50,repeat:10,ease:"Bounce.easeIn",onComplete:()=>{this.IsRestoringShield=!1}})}createalandingPlatform(){if(this.scene.add){const e=this.scene.add.rectangle(this.x,this.scene.scale.height-1200,this.scene.scale.width+15e3,500,0);e.setOrigin(0,.5),e.setDepth(this.depth-1),this.scene.physics.add.existing(e,!0),this.scene.physics.add.collider(this,e)}}ArmsFollowMouse(e,t){if(this.mouseInactiveTimer<=this.mouseInactiveThreshold){this.scene.cameras.main;const e=t.worldX,s=t.worldY,i=this.x,n=this.y,a=Phaser.Math.Angle.Between(i,n,e,s),r=this.skeleton.findBone("RigthArm"),o=this.skeleton.findBone("LeftArm");r&&!this.isJumping&&r.rotateWorld(Phaser.Math.RadToDeg(a)+90),o&&!this.isJumping&&o.rotateWorld(Phaser.Math.RadToDeg(a)+90)}}setCollectParticles(e){this.collectedParticles=e}collectParticle(e){this.collectedParticles+=e,this.scene.events.emit("particleCollected",e)}getCollectedParticles(){return this.collectedParticles}destroy(){this.trailParticles&&(this.trailParticles.stop(),this.trailParticles=void 0),null!=this.scene&&super.destroy()}}class rr extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,n){super(e,t??0,s??0,i||"CompanionBot_1",n??"WeaponBeacon0000"),this.scaleX=2,this.scaleY=2,this.play("CompanionBot_1"),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.updateListener=(e,t)=>this.update(t),this.scene.events.on("update",this.updateListener)}detectionRadius=2e3;MissileNumber=1;MissileVelocity=3e3;MissileSize=1;MissileDamage=10;MissileInterval=1e3;LaserShotsNumber=1;LaserVelocity=4500;LaserShotsInterval=500;LaserDamage=1;SwordNumber=1;SwordVelocity=2e3;swordWeaponDamage=20;SwordInterval=3e3;rainNumber=1;rainInterval=1e3;rainDamage=5;RainVelocity=8e3;updateListener;laserEvent;missileEvent;swordEvent;rainEvent;swordsGroup;missilesGroup;create(){this.scene.physics.world.enable(this),this.body.setAllowGravity(!1),this.swordsGroup=this.scene.physics.add.group(),this.missilesGroup=this.scene.physics.add.group(),this.laserEvent=this.scene.time.addEvent({delay:this.LaserShotsInterval,callback:this.fireLaser,callbackScope:this,loop:!0}),this.missileEvent=this.scene.time.addEvent({delay:this.MissileInterval,callback:this.fireMissile,callbackScope:this,loop:!0}),this.swordEvent=this.scene.time.addEvent({delay:this.SwordInterval,callback:this.fireSwords,callbackScope:this,loop:!0}),this.rainEvent=this.scene.time.addEvent({delay:this.rainInterval,callback:this.rayCreator,callbackScope:this,loop:!0})}update(e){if(this.active){const e=this.scene.player;if(e){const t=this.body,s=e.x,i=e.y-e.height/2-10,n=.1;t.velocity.x=(s-this.x)*n*60,t.velocity.y=(i-this.y)*n*60}this.swordsGroup?.getChildren().forEach((e=>{e.angle+=10})),this.missilesGroup?.getChildren().forEach((e=>{const t=e.target;if(e.active&&t&&!t.IsDestroyed){const s=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),i=this.scene.physics.velocityFromRotation(s,1e3);e.body.setVelocity(i.x,i.y),e.angle=Phaser.Math.RadToDeg(s)}else e.active&&t&&t.IsDestroyed&&this.destroyMissile(e)}))}}rayCreator(){for(let e=0;e<this.rainNumber;e++){const e=this.scene.cameras.main,t=(this.scene.player,Phaser.Math.Between(e.worldView.x,e.worldView.x+e.worldView.width)),s=this.scene.add.rectangle(t,e.worldView.y-50,20,4*this.scene.scale.height,16711680);this.scene.physics.world.enable(s);const i=s.body;if(s.setOrigin(.5,1),i.setVelocityY(this.RainVelocity),i.setAllowGravity(!1),!this.scene.scene.get("Level").isFxMuted){const e=["laserShoot1_01"];Phaser.Math.RND.pick(e)}this.scene.tweens.add({targets:s,scaleX:0,scaleY:0,duration:500});const n=this.scene.platforms;this.scene.physics.add.collider(s,n,(()=>{this.destroyRay(s)})),this.scene.physics.add.overlap(s,this.scene.enemies,((e,t)=>{this.handleRayCollision(e,t)})),this.scene.time.delayedCall(3e3,(()=>{s.active&&this.destroyRay(s)}))}}handleRayCollision(e,t){t.EnemyLife-=this.rainDamage,t.EnemyLife<=0&&t.handleDestroy();const s=this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:{min:-500,max:500},angle:{min:0,max:360},lifespan:{min:100,max:300},scale:{start:2,end:0},quantity:10,maxParticles:20});s.setDepth(1),this.scene.time.delayedCall(500,(()=>{s.stop(),s.destroy()})),this.destroyRay(e)}destroyRay(e){this.scene.tweens.add({targets:e,alpha:0,duration:300,onComplete:()=>{e.destroy()}})}fireSwords(){for(let e=0;e<this.SwordNumber;e++){if(!this.scene.scene.get("Level").isFxMuted){const e=["MissileShot_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const e=this.scene.add.sprite(this.x,this.y,"swordWeapon");e.setData("damage",this.swordWeaponDamage),e.setOrigin(.5,.5),this.scene.physics.world.enable(e);const t=Phaser.Math.Between(-this.SwordVelocity,this.SwordVelocity),s=Phaser.Math.Between(-this.SwordVelocity,-this.SwordVelocity);e.body.setVelocity(t,s),e.body.setAllowGravity(!0),e.body.gravity.y=1e3,e.body.setCircle(200),this.swordsGroup.add(e),this.scene.physics.add.overlap(e,this.scene.enemies,this.handleLaserCollision,void 0,this),this.scene.time.delayedCall(1e4,(()=>{e.active&&e.destroy()}))}}fireMissile(){for(let e=0;e<this.MissileNumber;e++){const e=this.scene.enemies.getChildren();let t=null,s=this.detectionRadius;if(e.forEach((e=>{const i=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);i<s&&(s=i,t=e)})),t){if(!this.scene.scene.get("Level").isFxMuted){const e=["MissileShot_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const e=this.scene.add.sprite(this.x,this.y,"missile");e.setData("damage",this.MissileDamage),e.setScale(this.MissileSize),this.scene.physics.world.enable(e),e.target=t,this.missilesGroup.add(e);const s=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),i=this.scene.physics.velocityFromRotation(s,this.MissileVelocity);e.body.setVelocity(i.x,i.y),e.body.setAllowGravity(!1),e.angle=Phaser.Math.RadToDeg(s),this.scene.physics.add.overlap(e,this.scene.enemies,this.handleLaserCollision,void 0,this),this.scene.time.delayedCall(2e3,(()=>{e.active&&this.destroyMissile(e)}))}}}destroyMissile(e){e.active&&(this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:Phaser.Math.Between(10,800),lifespan:{min:30,max:1e3},scale:{start:0,end:Phaser.Math.Between(2,5)},quantity:5,maxParticles:30}),e.destroy())}fireLaser(){for(let e=0;e<this.LaserShotsNumber;e++){const e=this.scene.enemies.getChildren();let t=null,s=this.detectionRadius;if(e.forEach((e=>{const i=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);i<s&&(s=i,t=e)})),t){if(!this.scene.scene.get("Level").isFxMuted){const e=["laserShoot1_01","laserShoot2_01","laserShoot3_01","laserShoot4_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const e=this.scene.add.sprite(this.x,this.y,"laserTexture");e.postFX.addBloom(16777215,1,1,2,1.2),this.scene.physics.world.enable(e),this.scene.scene.get("Level");const s=this.scene.scene.get("GameUI").level;e.setData("damage",this.LaserDamage*s);const i=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),n=this.scene.physics.velocityFromRotation(i,this.LaserVelocity);e.body.setVelocity(n.x,n.y),e.body.setAllowGravity(!1),e.angle=Phaser.Math.RadToDeg(i),this.scene.physics.add.overlap(e,this.scene.enemies,this.handleLaserCollision,void 0,this),this.scene.time.delayedCall(2e3,(()=>{e.active&&e.destroy()}))}}}handleLaserCollision(e,t){t.EnemyLife-=e.getData("damage");const s=this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:{min:-1e3,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this),e.destroy()}destroy(e){this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=void 0),this.laserEvent?.remove(),this.missileEvent?.remove(),this.swordEvent?.remove(),this.rainEvent?.remove(),this.missilesGroup&&this.missilesGroup.children&&this.missilesGroup.clear(!0,!0),super.destroy(e)}}class or extends Tn{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"InfoSphere",a??"InfoSphere-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=3.6406729013562154,this.scaleY=3.6406729013562154,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this)}create(){this.animationState.setAnimation(0,"idle",!0),this.scene.physics.add.existing(this,!1),this.body.setAllowGravity(!1);const e=this.scene.player;if(e){let t=!1;this.scene.events.on("update",(()=>{if(!e.body||!this.body)return;if(Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y)>6e3)return void this.destroy();const s=this.body,i=e.body,n=new Phaser.Geom.Rectangle(s.x,s.y,s.width,s.height),a=new Phaser.Geom.Rectangle(i.x,i.y,i.width,i.height),r=Phaser.Geom.Intersects.RectangleToRectangle(n,a),o=this.scene.scene.get("GameUI");r?(!t&&o&&o.helpPc&&(this.scene.sys.game.device.os.android||this.scene.sys.game.device.os.iOS?o.helpPc.setTexture("HelpMovile"):o.helpPc.setTexture("HelpPc"),o.helpPc.setVisible(!0)),t=!0):(t&&o&&o.helpPc&&o.helpPc.setVisible(!1),t=!1)}))}}}class lr extends Phaser.GameObjects.Ellipse{constructor(e,t,s,i,n){super(e,t??0,s??0,i??26,n??26),this.scaleX=2.0449978628728975,this.scaleY=2.0449978628728975,this.isFilled=!0,this.fillColor=16711680,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",((e,t)=>this.update(e,t)))}AttractionRange=600;AttractionSpeed=2e3;player;isDestroyed=!1;MaxKillTime=1e4;LevelPoins=0;create(){this.scene.physics.add.existing(this);const e=this.body;e.setCircle(3*this.width),e.setOffset(1.5*-this.width,1.5*-this.height),e.setAllowGravity(!1),e.setImmovable(!0),this.player=this.scene.player,this.scene.physics.add.overlap(this,this.player,this.handlePlayerCollision,void 0,this),this.scene.time.delayedCall(this.MaxKillTime,this.autoDestroy,[],this)}autoDestroy(){this.isDestroyed||this.isDestroyed||(this.isDestroyed=!0,this.destroy())}update(e,t){this.isDestroyed||this.checkDistanceToPlayer()}checkDistanceToPlayer(){try{const e=this.player.AttractionRange??this.AttractionRange;if(!this.player||!this.player.active)return void this.destroy();Phaser.Math.Distance.Between(this.x,this.y,this.player.x,this.player.y)<e&&this.moveToPlayer()}catch(e){this.destroy()}}moveToPlayer(){if(this.isDestroyed)return;const e=Phaser.Math.Angle.Between(this.x,this.y,this.player.x,this.player.y),t=this.body,s=this.player.AttractionSpeed??this.AttractionSpeed;t.setVelocity(Math.cos(e)*s,Math.sin(e)*s)}handlePlayerCollision(e,t){this.isDestroyed=!0,this.scene.tweens.add({targets:this,y:this.y-1e3,scale:0,alpha:0,ease:"Quadratic.Out",duration:500,callbackScope:this,onComplete:function(){t.collectParticle(1),this.destroy()}})}}class hr extends Phaser.GameObjects.Image{constructor(e,t,s,i,n){super(e,t??0,s??0,i||"Cannon",n),this.scaleX=.5,this.scaleY=.5,this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this)}IsActiveCannon=!0;create(){this.scene.physics.add.existing(this);const e=this.body;e.setCollideWorldBounds(!1),e.setAllowGravity(!0),e.setSize(this.texture.source[0].width/2,this.texture.source[0].height),e.setOffset(this.texture.source[0].width/4,0),this.setDepth(1e3);const t=this.scene.player;this.scene.physics.add.overlap(this,t,this.handlePlayerCollision,void 0,this);const s=this.scene.platforms;this.scene.physics.add.collider(this,s,this.handleFloorColision,void 0,this)}handleFloorColision(e,t){}handlePlayerCollision(e,t){if(this.IsActiveCannon){const e=this.scene.scene.get("GameUI");e.upgradeSystem.isUpgradeSelected=!1,e.upgradeSystem.createUpgradeWindow(),t.hideAndRoll(this.x,this.y),this.IsActiveCannon=!1,this.setTint(16711680),this.scene.time.delayedCall(6e3,(()=>{this.IsActiveCannon=!1}),[],this)}}update(){const e=this.scene.player;e&&this.active&&Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y)>15e3&&this.destroy()}}class cr extends Tn{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"BIGBUS",a??"BIGBUS-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this.scene.events.on("update",this.update,this)}create(){const e=Phaser.Math.FloatBetween(2,3);this.setScale(e),this.scene.physics.add.existing(this);const t=this.body;t.setGravityY(0),t.setAllowGravity(!1),t.setImmovable(!0),this.animationState.setAnimation(0,"idle",!0),t.setVelocityX(-Phaser.Math.Between(100,2e3));const s=.6*this.width,i=.15*this.height;t.setSize(s,i),t.setOffset((this.width-s)/2,0);const n=this.scene.player;n&&(this.setDepth(n.depth-1),this.scene.physics.add.collider(this,n,this.handlePlayerCollisionStand,void 0,this))}handlePlayerCollisionStand(e,t){}update(){const e=this.scene.player;if(e&&this.active&&this.x<e.x-2e4){this.x=e.x+2e4,this.y=e.y-Phaser.Math.Between(e.y,2e3);const t=Phaser.Math.FloatBetween(1.5,2);this.setScale(t);const s=this.body;this.width,this.height,s.setVelocityX(-Phaser.Math.Between(1e3,3e3))}}}class dr{_scene;_world;_query;_enterQuery;_exitQuery;constructor(e,t,s){var i;this._scene=e,this._world=t,this._query=ae(s),this._enterQuery=(i=this._query,e=>{e[K].has(i)||te(e,i);const t=e[K].get(i);if(0===t.entered.dense.length)return ee;{const e=t.entered.dense.slice();return t.entered.reset(),e}}),this._exitQuery=(e=>t=>{t[K].has(e)||te(t,e);const s=t[K].get(e);if(0===s.exited.dense.length)return ee;{const e=s.exited.dense.slice();return s.exited.reset(),e}})(this._query)}execute(){this.processEntities(this._enterQuery,this.enter.bind(this)),this.processEntities(this._query,this.update.bind(this)),this.processEntities(this._exitQuery,this.exit.bind(this))}processEntities(e,t){const s=e(this._world);for(let e=0;e<s.length;e++){const i=s[e],n=this._scene.getGameObject(i);void 0!==n&&t(n)}}enter(e){}update(e){}exit(e){}}class ur extends dr{constructor(e,t){super(e,t,[oa,la])}enter(e){}update(e){const t=e.controllers.get(Ga);if(void 0===t)return;Sa.entityId=e.id,ka.entityId=e.id;const s=On.calculateDirection(Sa.vector2,ka.vector2);var i=On.calculateAngle(s);0!=i&&(t.rotation=i)}exit(e){}}class pr extends dr{constructor(e,t){super(e,t,[ia])}enter(e){const t=e.controllers.get(Va);t&&(ba.entityId=e.id,t.enableGravity(ba.value))}update(e){}exit(e){}}class mr extends dr{constructor(e,t){super(e,t,[aa,ra])}enter(e){const t=e.controllers.get(Ua);if(void 0===t)return;ya.entityId=e.id,va.entityId=e.id;const s={type:zn.ELLIPSE,size:ya.value,color:va.value};t.render(this._scene,s)}update(e){}exit(e){}}class gr extends dr{constructor(e,t){super(e,t,[aa,da])}enter(e){const t=e.controllers.get(Ua);if(void 0===t)return;ya.entityId=e.id,Aa.entityId=e.id;const s={size:ya.value,textureId:Aa.value};t.render(this._scene,s)}update(e){}exit(e){}}class fr extends dr{constructor(e,t){super(e,t,[oa,la,ha])}enter(e){const t=e.controllers.get(Ga);void 0!==t&&(ka.entityId=e.id,t.position=ka.vector2)}update(e){const t=e.controllers.get(Ga);void 0!==t&&(Sa.entityId=e.id,ka.entityId=e.id,Ia.entityId=e.id,Sa.vector2=ka.vector2,ka.vector2=t.position,Ia.value=t.rotation)}exit(e){}}class yr extends dr{_accelerationService;constructor(e,t,s){super(e,t,[na,Zn]),this._accelerationService=s}enter(e){this._accelerationService.apply(e,xr.getAccelerationVector(e.id))}}const xr=new class{getAccelerationVector(e){return xa.entityId=e,fa.entityId=e,{direction:fa.vector,magnitude:xa.magnitude,initialSpeed:xa.initialSpeed}}};class wr extends dr{constructor(e,t){super(e,t,[la,sa,Zn])}enter(e){e.controllers.get(Va)&&(ka.entityId=e.id,wa.entityId=e.id,fa.entityId=e.id,fa.vector=On.calculateDirection(ka.vector2,wa.vector))}update(e){}exit(e){}}class br{apply(e,t){const s=e.controllers.get(Va);if(void 0===s)throw new Error(`The game object with id: ${e.id} does not have a physic controller`);const i=this.calculateVelocity(t.direction,t.initialSpeed),n=this.calculateAcceleration(t.direction,t.magnitude);s.setVelocity(i),s.setAcceleration(n)}calculateAcceleration(e,t){return Xn.scale(e,t)}calculateVelocity(e,t){return Xn.scale(e,t)}}class vr extends Tn{timers=[];_updateListener;constructor(e,t,s,i,n,a,r){super(e,t,s??0,i??0,n,a,r??new Mn(null,["default"])),this.blendMode=Phaser.BlendModes.SKIP_CHECK,this.skeleton.setSkinByName("default"),this.scene.events.once(Phaser.Scenes.Events.UPDATE,this.create,this),this._updateListener=(e,t)=>this.updateEnemy(t),this.scene.events.on("update",this._updateListener)}enemyGravity=0;EnemyVelo=300;laserDuration=6e3;laserSpeed=3e3;laserColor="#ff0000";lastShotTime=400;shotInterval=2500;shootingRadius=2e3;IsNearPlayer=!1;EnemyLife=3;IsDestroyed=!1;EnemyDamage=10;canShoot=!1;canFlip=!0;shootMissile=!1;shootingrate=200;canHitPlayer=!1;canPlayerStand=!0;canPlayerHit=!0;hasHitPlayer=!1;IsMegaLaser=!1;canCollideWithPlayer=!0;create(){const e=this.scene.scene.get("GameUI").level;this.EnemyLife=e*this.EnemyLife,this.scene.enemies.add(this),this.scene.physics.add.existing(this);const t=this.body;t.setGravityY(this.enemyGravity),t.setAllowGravity(!1),t.setImmovable(!0),this.animationState.setAnimation(0,"Idle",!0);const s=Phaser.Math.FloatBetween(.5,6);this.EnemyVelo*=s,t.setVelocityX(-this.EnemyVelo),this.setDepth(1);const i=this.scene.player;this.canHitPlayer?this.scene.physics.add.collider(this,i,this.handlePlayerCollision,void 0,this):this.canPlayerStand?this.scene.physics.add.collider(this,i,this.handlePlayerCollisionStand,void 0,this):this.canPlayerHit&&this.scene.physics.add.overlap(this,i,this.handlePlayerHit,void 0,this)}handlePlayerHit(e,t){this.hasHitPlayer||(t.tryToSword(e),this.hasHitPlayer=!0)}resetPlayerHit(e,t){this.scene.physics.overlap(e,t)||(this.hasHitPlayer=!1)}handlePlayerCollisionStand(e,t){}handlePlayerCollision(e,t){if(!this.canCollideWithPlayer)return;if(this.scene.add.particles(0,0,"particleImage",{x:t.x,y:t.y,speed:{min:0,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:4,end:0},quantity:15,maxParticles:15,frequency:100,gravityY:3e3}),!this.scene.scene.get("Level").isFxMuted){const e=["dead2_01","dead3_01","dead1_01","dead4_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}this.canCollideWithPlayer=!1,this.scene.scene.get("GameUI").level,t.body.setVelocityY(-2e3),t.body.setVelocityX(-1e3),t.handleDamage(this.EnemyDamage);const s=this.scene.add.particles(0,0,"particleImage",{x:t.x,y:t.y,speed:{min:-1e3,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this),this.scene.time.delayedCall(1500,(()=>{this.canCollideWithPlayer=!0}))}updateEnemy(e){if(!this.IsDestroyed){const e=this.scene.player;this.canFlip&&(e.x<this.x?this.skeleton.scaleX=1:this.skeleton.scaleX=-1),Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y)<=this.shootingRadius?(this.IsNearPlayer=!0,this.scene.time.now>this.lastShotTime+this.shotInterval&&this.canShoot&&(this.createLaserParticles(),this.scene.time.delayedCall(this.shootingrate,(()=>{this.shootMissile?this.shootAMissile(e):this.IsMegaLaser?this.shootMegaLaser(e):this.shootLaser(e)})),this.lastShotTime=this.scene.time.now)):this.IsNearPlayer=!1,this.x<this.scene.cameras.main.worldView.x-13e3&&(this.x=this.scene.cameras.main.worldView.x+this.scene.cameras.main.width+13e3),this.EnemyLife<=0&&!this.IsDestroyed&&this.handleDestroy()}}handleDestroy(){if(!this.scene.scene.get("Level").isFxMuted){const e=["EnemyExplode1_01","EnemyExplode2_01","EnemyExplode3_01","EnemyExplode4_01","EnemyExplode5_01","EnemyExplode6_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}this.timers&&Array.isArray(this.timers)&&(this.timers.forEach((e=>{e&&!e.hasDispatched&&e.remove(!1)})),this.timers=[]),this.IsDestroyed=!0,this.generateParticles();const e=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:-3e3,max:3e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:8,end:0},quantity:60,maxParticles:50,frequency:1});e.setDepth(1),this.scene.time.delayedCall(1500,(()=>{e.stop(),e.destroy(),this.destroy()}),[],this),this.setVisible(!1);const t=this.body;this.scene.enemies.remove(this),t.setEnable(!1)}generateParticles(){const e=this.scene.scene.get("GameUI").level,t=this.scene.scene.get("Level"),s=Math.ceil(e*t.FactorDeDificultad);for(let e=0;e<s;e++){const e=this.x+Phaser.Math.Between(-130,130),t=this.y+Phaser.Math.Between(-130,130),s=new lr(this.scene,e,t);this.scene.add.existing(s)}}createLaserParticles(){const e=this.scene.add.particles(0,0,"particleImage",{x:this.x,y:this.y,speed:{min:-30,max:30},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:3,end:0},quantity:2,maxParticles:10,frequency:10});e.setDepth(1),this.scene.time.delayedCall(500,(function(){e.stop(),e.destroy()}),[],this)}shootAMissile(e){if(this.canShoot){let t=0;const s=3,i=()=>{if(t<2*s)t%2==0?this.skeleton.color.set(1,0,0,1):this.skeleton.color.set(1,1,1,1),t++,this.scene.time.delayedCall(60,i,[],this);else{this.skeleton.color.set(1,1,1,1);const t=this.scene.add.ellipse(this.x,this.y+80,60,80,16711680);this.scene.physics.add.existing(t);const s=t.body;s.setAllowGravity(!0),s.setGravityY(3e3),t.lifespan=this.laserDuration,this.scene.time.addEvent({delay:this.laserDuration,callback:()=>{t.destroy()}}),this.scene.physics.add.overlap(t,e,this.handleLaserCollision,void 0,this)}};i()}}shootLaser(e){if(this.canShoot){let t=0;const s=3,i=()=>{if(t<2*s)t%2==0?this.skeleton.color.set(1,0,0,1):this.skeleton.color.set(1,1,1,1),t++,this.scene.time.delayedCall(60,i,[],this);else{if(this.skeleton.color.set(1,1,1,1),!this.scene.scene.get("Level").isFxMuted){const e=["EnemyLaser_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const t=Phaser.Display.Color.HexStringToColor(this.laserColor).color,s=this.scene.add.ellipse(this.x,this.y,200,40,t);this.scene.physics.add.existing(s);const i=s.body;i.setAllowGravity(!1);const n=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y),a=Math.cos(n)*this.laserSpeed,r=Math.sin(n)*this.laserSpeed;i.setVelocity(a,r),s.rotation=n,s.lifespan=this.laserDuration,this.scene.time.addEvent({delay:this.laserDuration,callback:()=>{s.destroy()}}),this.scene.physics.add.overlap(s,e,this.handleLaserCollision,void 0,this)}};i()}}shootMegaLaser(e){if(this.canShoot){let t=0;const s=3,i=()=>{if(t<2*s)t%2==0?this.skeleton.color.set(1,0,0,1):this.skeleton.color.set(1,1,1,1),t++,this.scene.time.delayedCall(60,i,[],this);else{if(this.skeleton.color.set(1,1,1,1),!this.scene.scene.get("Level").isFxMuted){const e=["EnemyLaser_01"],t=Phaser.Math.RND.pick(e);this.scene.sound.play(t)}const t=Phaser.Display.Color.HexStringToColor(this.laserColor).color,s=this.scene.add.ellipse(this.x,this.y,400,120,t);this.scene.physics.add.existing(s);const i=s.body;i.setAllowGravity(!1);const n=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y),a=Math.cos(n)*this.laserSpeed,r=Math.sin(n)*this.laserSpeed;i.setVelocity(a,r),s.rotation=n,s.lifespan=this.laserDuration,this.scene.time.addEvent({delay:this.laserDuration,callback:()=>{s.destroy()}}),this.scene.physics.add.overlap(s,e,this.handleLaserCollision,void 0,this)}};i()}}handleLaserCollision(e,t){this.scene.scene.get("GameUI").level,t.handleDamage(this.EnemyDamage);const s=this.scene.add.particles(0,0,"particleImage",{x:e.x,y:e.y,speed:{min:-1e3,max:1e3},angle:{min:0,max:360},lifespan:{min:30,max:500},scale:{start:2,end:0},quantity:5,maxParticles:5,frequency:100,gravityY:3e3});s.setDepth(1),this.scene.time.delayedCall(500,(function(){s.stop(),s.destroy()}),[],this),e.destroy()}}class Sr extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy1",a??"Enemy1-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6659081713348685,this.scaleY=1.6659081713348685}}class kr extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy2",a??"Enemy2-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=2,this.scaleY=2,this.canShoot=!0,this.EnemyLife=4}}class Ir extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy3",a??"Enemy3-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.canShoot=!0,this.shootMissile=!0,this.shootingrate=150}}class Ar extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy4",a??"Enemy4-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=2,this.scaleY=2,this.EnemyLife=12,this.canFlip=!1,this.canPlayerStand=!0}}class Er extends vr{baseY;waveAmplitude;waveSpeed;elapsedTime;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy5",a??"Enemy5-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.8,this.scaleY=1.8,this.baseY=i,this.waveAmplitude=120,this.waveSpeed=.005,this.elapsedTime=0,this.scene.events.on("update",((e,t)=>this.update(t)))}update(e){this.elapsedTime+=e,this.y=this.baseY+Math.sin(this.elapsedTime*this.waveSpeed)*this.waveAmplitude}}class Cr extends vr{elapsedTime;rotationSpeed;baseX;radius;baseY;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy6",a??"Enemy6-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.5,this.scaleY=1.5,this.elapsedTime=0,this.canShoot=!0,this.rotationSpeed=.005,this.baseX=s,this.baseY=i,this.radius=40,this.angle=0,this.scene.events.on("update",((e,t)=>this.update(t)))}update(e){this.elapsedTime+=e,this.y=this.baseY+Math.sin(this.angle)*this.radius}}class Pr extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy7",a??"Enemy7-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.canHitPlayer=!0,this.canFlip=!1}}class Mr extends vr{hasDived=!1;diveTime=0;originalY=this.y;isDiving=!1;diveCooldown=3e3;diveCooldownTimer=0;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy8",a??"Enemy8-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=2,this.scaleY=2,this.canHitPlayer=!0,this.scene.events.on("update",((e,t)=>this.update(t)))}update(e){if(this.IsNearPlayer&&!this.hasDived&&(this.isDiving=!0,this.diveTime=0,this.hasDived=!0,this.diveCooldownTimer=0),this.isDiving){this.diveTime+=e;const t=Math.min(.005*this.diveTime,Math.PI);this.y=this.originalY+250*Math.sin(t),t>=Math.PI&&(this.isDiving=!1,this.y=this.originalY)}this.hasDived&&!this.isDiving&&(this.diveCooldownTimer+=e,this.diveCooldownTimer>=this.diveCooldown&&(this.hasDived=!1))}}class Tr extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy9",a??"Enemy9-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.canShoot=!0,this.shotInterval=1e3,this.shootingRadius*=2,this.laserSpeed*=1.5}}class Rr extends vr{height;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy10",a??"Enemy10-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=2,this.scaleY=2,this.EnemyLife=6,this.EnemyDamage=3,this.scene.time.addEvent({delay:3e3,callback:this.shotMegaLaser,callbackScope:this,loop:!0})}shotMegaLaser(){this.animationState.setAnimation(0,"Shoot",!1),this.animationState.addListener({complete:e=>{e.animation&&"Shoot"===e.animation.name&&(this.animationState.setAnimation(0,"Idle",!0),this.deployLaser())}})}deployLaser(){const e=this.x,t=this.y+(this.height?this.height/2:60),s=this.scene.add.sprite(e,t,"EnemyLaserTexture");this.scene.physics.world.enable(s);const i=s.body;i.setVelocityY(1800),i.setAllowGravity(!1);const n=this.scene.player;n&&this.scene.physics.add.overlap(s,n,(()=>{n.handleDamage(this.EnemyDamage),s.destroy()})),this.scene.time.delayedCall(2e3,(()=>{s.active&&s.destroy()}))}}class Br extends vr{height;LaserDeplyTimer;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy11",a??"Enemy11-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.EnemyLife=6,this.EnemyDamage=3,this.canFlip=!0,this.LaserDeplyTimer=this.scene.time.addEvent({delay:1e3,callback:this.deployLaser,callbackScope:this,loop:!0}),this.timers.push(this.LaserDeplyTimer)}deployLaser(){const e=this.x,t=this.y+(this.height?this.height/2:60),s=this.scene.add.sprite(e,t,"EnemyLaserTexture2");this.scene.physics.world.enable(s);const i=s.body,n=Math.sign(-this.skeleton.scaleX)||1;s.flipX=this.skeleton.scaleX<0,i.setVelocityX(3e3*n),i.setAllowGravity(!1);const a=this.scene.player;a&&this.scene.physics.add.overlap(s,a,(()=>{a.handleDamage(this.EnemyDamage),s.destroy()})),this.scene.time.delayedCall(5e3,(()=>{s.active&&s.destroy()}))}}class Lr extends vr{height;LaserDeplyTimer;constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"Enemy12",a??"Enemy12-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.EnemyLife=6,this.EnemyDamage=3,this.canFlip=!0,this.LaserDeplyTimer=this.scene.time.addEvent({delay:1e3,callback:this.deployLaser,callbackScope:this,loop:!0}),this.timers.push(this.LaserDeplyTimer)}deployLaser(){const e=this.x,t=this.y+(this.height?this.height/2:60),s=this.scene.add.sprite(e,t,"EnemyLaserTexture3");this.scene.physics.world.enable(s);const i=s.body,n=Math.sign(-this.skeleton.scaleX)||1;s.flipX=this.skeleton.scaleX<0,i.setVelocityX(3e3*n),i.setAllowGravity(!1);const a=this.scene.player;a&&this.scene.physics.add.overlap(s,a,(()=>{a.handleDamage(this.EnemyDamage),s.destroy()})),this.scene.time.delayedCall(5e3,(()=>{s.active&&s.destroy()}))}}class _r extends vr{constructor(e,t,s,i,n,a,r,o,l){super(e,t,s??0,i??0,n??"MainEnemy",a??"MainEnemy-atlas",o??new Mn(null,["default"])),this.skeleton.setSkinByName(r??"default"),this.scaleX=1.6,this.scaleY=1.6,this.EnemyLife=300,this.EnemyDamage=10,this.canFlip=!1,this.canPlayerStand=!0,this.IsMegaLaser=!0,this.canShoot=!0}preUpdate(e,t){super.preUpdate?.(e,t);const s=this.scene.player;if(!s)return;const i=this.skeleton,n=i.findBone("weapon1"),a=i.findBone("weapon2");if(n&&a){const e=this.x,t=this.y,i=s.x,r=s.y,o=Phaser.Math.Angle.Between(e+n.worldX*this.scaleX,t+n.worldY*this.scaleY,i,r),l=Phaser.Math.Angle.Between(e+a.worldX*this.scaleX,t+a.worldY*this.scaleY,i,r);n.parent&&a.parent&&(n.rotation=Phaser.Math.RadToDeg(o),a.rotation=Phaser.Math.RadToDeg(l))}}}class Fr extends Ie{constructor(){super("Level")}editorCreate(){const e=new ar(this,this.spine,900,-1786);this.add.existing(e),e.scaleX=.5,e.scaleY=.5;const t=this.add.tileSprite(0,0,1920,1080,"bg1");t.setOrigin(0,0);const s=new rr(this,715,740);this.add.existing(s);const i=this.add.sprite(-1345,-178,"TheBuilding");i.setInteractive(new Phaser.Geom.Rectangle(0,0,3072,3072),Phaser.Geom.Rectangle.Contains),i.scaleX=3,i.scaleY=3;const n=this.add.rectangle(-1210,-763,1e3,8e3);n.setInteractive(new Phaser.Geom.Rectangle(0,0,1e3,8e3),Phaser.Geom.Rectangle.Contains),n.alpha=0,n.isFilled=!0;const a=new or(this,this.spine,3552,-771);this.add.existing(a),this.player=e,this.bg1=t,this.laserShot=s,this.theBuilding=i,this.wall=n,this.infoSphere=a,this.events.emit("scene-awake")}player;bg1;laserShot;theBuilding;wall;infoSphere;async showPokiAdAndPauseGame(){const e=this.plugins.get("poki");e?(this.scene.pause(),e.gameplayStart(),await e.commercialBreak(),this.scene.resume()):(e.gameplayStart(),this.scene.resume())}currentPlatform;platforms;platformBuffer=20;enemies;platformCount=0;CannonCountDistance=30;firtCannonPlaced=!1;musicManager;fxManager;bgMusic;isFxMuted=!1;FactorDeDificultad=1.03;WaveNumber=0;_transform=new fr(this,this.world);_shapeRender=new mr(this,this.world);_calculateDirection=new ur(this,this.world);_applyGravity=new pr(this,this.world);_navigation=new wr(this,this.world);_setAcceleration=new yr(this,this.world,new br);_textureRender=new gr(this,this.world);create(){this.editorCreate();const e=this.plugins.get("poki");e?e.gameLoadingFinished():console.warn("Poki plugin not found, proceeding without it.");const t=[],s=this.player.y,i=this.player.y-800,n=this.player.x+2e4;for(let e=0;e<5;e++){let a,r=0;do{a=Phaser.Math.Between(s,i),r++}while(t.some((e=>Math.abs(e-a)<1200))&&r<20);t.push(a);const o=n+5e3*e,l=new cr(this,this.spine,o,a);l.setScale(1),this.add.existing(l)}this.physics.add.existing(this.wall,!0),this.physics.add.collider(this.player,this.wall),this.musicManager=this.sound,this.fxManager=this.sound,this.bgMusic=this.musicManager.add("bgMusic",{loop:!0,volume:1}),this.bgMusic.play();const a=this.scale.height/this.scale.width;this.player.animationState.setAnimation(0,"Idle",!0),this.cameras.main.setBackgroundColor(13684687),this.cameras.main.startFollow(this.player,!0,.8,1,0,390);const r=this.sys.game.device.os.android||this.sys.game.device.os.iOS;r?this.cameras.main.setZoom(a/6):this.cameras.main.setZoom(a/4),this.cameras.main.fadeIn(100);const o=this.cameras.main.postFX.addPixelate(40);this.add.tween({targets:o,duration:700,amount:-1}),this.platforms=this.add.group(),this.enemies=this.add.group(),this.bg1.setDepth(-1),r?(this.bg1.setOrigin(0,0),this.bg1.setPosition(6*-this.scale.width,8*-this.scale.height),this.bg1.setSize(20*this.scale.width,10*this.scale.height),this.bg1.setTileScale(4,4),this.bg1.setScrollFactor(0,.5)):(this.bg1.setOrigin(0,0),this.bg1.setPosition(4*-this.scale.width,4*-this.scale.height),this.bg1.setSize(20*this.scale.width,10*this.scale.height),this.bg1.setTileScale(4,4),this.bg1.setScrollFactor(0,.5)),this.createFloor(),this.createPlatforms(),this.createEnemies(),this.game.events.once("PlayerIsDead",(()=>{console.log("Player is dead..."),this.fadeOut(1e3)}),this),this.game.events.once("RestartLevel",(()=>{console.log("Restarting level...");const e=this.bgMusic&&!this.bgMusic.isPlaying,t=this.isFxMuted;this.sound.stopAll(),this.sound.removeAll(),this.events.removeAllListeners("update"),this.scene.manager.getScenes(!0).forEach((e=>{e.scene.key!==this.scene.key&&e.scene.restart()})),this.game.destroy(!0),qr(),setTimeout((()=>{const s=window.game||window.GAME;if(s){const i=s.scene.getScene("Level");console.log("Level Scene "+i),i&&(console.log("was music mutted "+t),i.setMusic(!e),i.setFX(!t))}}),500)}),this)}setMusic(e){e?this.bgMusic.play():this.bgMusic.stop()}setFX(e){this.isFxMuted=!e}createEnemies(){this.enemies=this.add.group();let e=this.FactorDeDificultad*this.WaveNumber,t=this.cameras.main.x-1e4,s=this.cameras.main.x+1e4,i=this.player.y-2e3,n=this.player.y+500;const a=[Sr,kr,Ir,Ar,Er,Cr,Pr,Mr,Tr,Rr,Br,Lr,_r],r=()=>{let r=Math.min(this.WaveNumber,a.length);for(let o=0;o<e;o++){const e=Phaser.Math.Between(t,s),o=Phaser.Math.Between(i,n),l=Phaser.Math.Between(0,r-1),h=new(0,a[l])(this,this.spine,e,o);this.add.existing(h),this.enemies.add(h)}e+=2},o=()=>{0===this.enemies.getLength()&&r(),this.time.delayedCall(5e3,o,[],this)};o()}createParticles(){this.time.addEvent({delay:1e3,callback:()=>{const e=Phaser.Math.Between(this.player.x-1e3,this.player.x+1e3),t=Phaser.Math.Between(this.player.y,this.player.y-1e3),s=new lr(this,e,t);this.add.existing(s)},callbackScope:this,loop:!0})}createPlatforms(){const e=this.scale.height-1200;let t=0;const s=this.scale.height-600;for(let i=0;i<this.platformBuffer;i++){let n=0===i?15e3:Phaser.Math.Between(400,4e3);const a=Phaser.Math.Between(800,1400),r=Phaser.Math.Between(2e3,4e3),o=0===i?s:Phaser.Math.Between(500,e),l=t+r,{graphics:h,collider:c}=this.createRoundedPlatform(l,o,n,a,40);if(c.graphics=h,this.physics.add.collider(this.player,c,this.checkPlatformDistance,void 0,this),this.platforms.add(c),t=l,this.platformCount++,this.platformCount%5==0&&!this.firtCannonPlaced){this.firtCannonPlaced=!0;const e=new hr(this,l,o-a-500);this.add.existing(e)}if(this.platformCount%this.CannonCountDistance===0){const e=new hr(this,l/2,o-2*a);e.setDepth(this.player.depth-1),this.add.existing(e)}}}createRoundedPlatform(e,t,s,i,n=40,a=0){const r=this.add.graphics();r.fillStyle(a,1),r.fillRoundedRect(e-s/2,t-i/2,s,i,n);const o=this.add.rectangle(e,t,s,i,0,0);return o.setOrigin(.5,.5),o.setVisible(!1),this.physics.add.existing(o,!0),{graphics:r,collider:o}}createFloor(){if(this.add){const e=this.add.rectangle(0,this.scale.height-600,this.scale.width+1300,500,0);e.setOrigin(.5,.5),this.physics.add.existing(e,!0),this.physics.add.collider(this.player,e),e.setDepth(this.player.depth-1),this.platforms.add(e)}}update(e,t){this._transform.execute(),this._navigation.execute(),this._setAcceleration.execute(),this._calculateDirection.execute(),this._applyGravity.execute(),this._shapeRender.execute(),this._textureRender.execute(),this.updatePlatforms(),this.updateWorldBounds(),this.events.emit("playerMove",this.player.x);const s=this.scene.get("GameUI").level;this.WaveNumber=s,this.player.y>2e3&&(this.player.handleDamage(900),this.currentPlatform?(this.player.x=this.currentPlatform.x,this.player.y=this.currentPlatform.y-1800):(this.player.y=-2e3,this.player.x=this.player.x-400),this.cameras.main.shake(500,.1)),this.bg1.tilePositionX=.05*this.cameras.main.scrollX,this.bg1.tilePositionY=.05*this.cameras.main.scrollY,this.theBuilding&&this.player&&Phaser.Math.Distance.Between(this.theBuilding.x,this.theBuilding.y,this.player.x,this.player.y)>15e3&&(this.theBuilding.destroy(),this.theBuilding=void 0)}updatePlatforms(){const e=this.scale.height-500;let t=0;if(this.platforms.getChildren().forEach((e=>{e.x>t&&(t=e.x)})),this.player.x+this.scale.width>t)for(let s=0;s<this.platformBuffer;s++){const s=Phaser.Math.Between(400,4e3),i=Phaser.Math.Between(800,1400),n=Phaser.Math.Between(2e3,4e3),a=Phaser.Math.Between(500,e),r=t+n,{graphics:o,collider:l}=this.createRoundedPlatform(r,a,s,i,40);if(l.graphics=o,this.physics.add.collider(this.player,l,this.checkPlatformDistance,void 0,this),this.platforms.add(l),t=r,this.platformCount++,this.platformCount%this.CannonCountDistance===0){const e=r,t=a-2*i,s=new hr(this,e,t);console.log("cannon added "+e,t),l.fillColor=16711680,this.add.existing(s)}}this.platforms.getChildren().forEach((e=>{e.x<this.player.x-this.scale.width*this.platformBuffer&&(e.graphics&&e.graphics.destroy(),this.platforms.remove(e,!0,!0))}))}checkPlatformDistance(e,t){const s=t;this.currentPlatform=s,this.platforms.getChildren().forEach((e=>{e!==s&&(e.fillColor=0)}));const i=this.platforms.getChildren().find((e=>e.x>s.x));if(i){const e=Math.abs(i.y-s.y),t=Math.abs(i.x-s.x);if(e>3e3&&!s.hasCreatedMidPlatform){const e=(s.x+s.width/2+i.x-i.width/2)/2,t=(s.y+i.y)/2,n=400,a=400,{graphics:r,collider:o}=this.createRoundedPlatform(e,t,n,a,40);o.setDepth(this.player.depth-1),this.physics.add.collider(this.player,o,this.checkPlatformDistance,void 0,this),this.platforms.add(o),s.hasCreatedMidPlatform=!0}if(t>3e3&&!s.hasCreatedMidPlatform){const e=(s.x+s.width/2+i.x-i.width/2)/2,t=(s.y+i.y)/2,n=400,a=400,{graphics:r,collider:o}=this.createRoundedPlatform(e,t,n,a,40);this.physics.add.collider(this.player,o,this.checkPlatformDistance,void 0,this),this.platforms.add(o),s.hasCreatedMidPlatform=!0}}}updateWorldBounds(){const e=this.cameras.main,t=this.physics.world.bounds;t.x=e.worldView.x,t.y=e.worldView.y,t.width=e.worldView.width,t.height=e.worldView.height}fadeOut(e){this.cameras.main.fadeOut(e,0,0,0)}}class Dr extends Phaser.Scene{constructor(){super("LevelPreloader")}editorCreate(){this.events.emit("scene-awake")}preload(){console.log("Preloader cargando")}create(){this.editorCreate(),this.restartGame()}restartGame(){console.log("Restarting game..."),this.game.destroy(!0),qr()}}const Yr=JSON.parse('{"section1":{"files":[]},"meta":{"app":"Phaser Editor 2D - Asset Pack Editor","contentType":"phasereditor2d.pack.core.AssetContentType","url":"https://phasereditor2d.com","version":2,"showAllFilesInBlocks":false,"visible":true}}');class Or extends Phaser.Scene{constructor(){super("Preload")}editorCreate(){this.add.rectangle(0,0,this.scale.width,this.scale.height,0,1).setOrigin(0,0);const e=this.scale.width/2,t=(this.scale.width-e)/2,s=(this.scale.height-32)/2,i=this.add.graphics();i.lineStyle(4,16711680,1),i.strokeRect(t,s,e,32);const n=this.add.graphics();this.progressBar=n,this.progressBarX=t,this.progressBarY=s,this.progressBarWidth=e,this.progressBarHeight=32,this.add.text(this.scale.width/2,s-40,"Loading...",{color:"#ff0000",fontFamily:"arial",fontSize:"24px"}).setOrigin(.5,.5),this.events.emit("scene-awake")}progressBar;progressBarX;progressBarY;progressBarWidth;progressBarHeight;preload(){this.editorCreate(),this.load.pack("asset-pack",Ha),this.load.on("progress",(e=>{this.progressBar.clear(),this.progressBar.fillStyle(16711680,1),this.progressBar.fillRect(this.progressBarX,this.progressBarY,this.progressBarWidth*e,this.progressBarHeight)}))}create(){this.scene.start("Level"),this.scene.start("GameUI")}}var Xr=s(770);window.onload=()=>{console.log("Loading game..."),qr()},window.onload=()=>{console.log("Loading game..."),function(e,t){if(document.fonts&&window.FontFace)return new FontFace(e,`url(${t})`).load().then((e=>{document.fonts.add(e)}));{const s=document.createElement("style");return s.innerHTML=`\n        @font-face {\n            font-family: '${e}';\n            src: url('${t}') format('truetype');\n            font-weight: normal;\n            font-style: normal;\n        }`,document.head.appendChild(s),Promise.resolve()}}("Bahiana","fonts/Bahiana-Regular.ttf").then((()=>{console.log("Local font loaded"),qr()}))};class Vr extends n().Scene{constructor(){super("Boot")}preload(){this.load.pack("pack",Yr)}create(){document.fullscreenElement&&document.exitFullscreen();let e=document.getElementById("game_canvas");e||(e=this.sys.game.canvas,e.setAttribute("id","game_canvas"),console.log("Canvas renombrado dentro de Boot scene.")),this.scene.start("Preload")}}function Nr(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}Nr()&&(window.screen.width,window.screen.height,console.log("Mobile"));const Ur=function(){const e=document.createElement("div");e.style.width="0in",e.style.height="0in",e.style.position="absolute",e.style.top="-100%",document.body.appendChild(e);const t={x:e.offsetWidth,y:e.offsetHeight};return document.body.removeChild(e),t}();var zr,Gr;console.log(`DPI: ${Ur.x} x ${Ur.y}`),zr=window.navigator.userAgent,Gr=window.navigator.platform,-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(Gr)||-1!==["iPhone","iPad","iPod"].indexOf(Gr)||-1!==["Win32","Win64","Windows","WinCE"].indexOf(Gr)||/Android/.test(zr)||/Linux/.test(Gr);class Wr extends n().Game{playerData={isMobile:!1}}function qr(){const e=Nr();new Wr({width:e?640:1031,height:e?360:580,title:"Eggy Carton",type:n().WEBGL,backgroundColor:"#e2e2e2",scale:{mode:n().Scale.ScaleModes.FIT,autoCenter:n().Scale.Center.CENTER_BOTH},fps:{target:30,forceSetTimeOut:!1},plugins:{global:[{plugin:Xr.PokiPlugin,key:"poki",start:!0,data:{loadingSceneKey:"Preload",gameplaySceneKey:"Level",autoCommercialBreak:!0}}],scene:[{key:"spine.SpinePlugin",plugin:_n,mapping:"spine"}]},scene:[Vr,Or,Fr,h,Dr],input:{keyboard:!0,mouse:!0,touch:{capture:!0},gamepad:!0},physics:{default:"arcade",arcade:{gravity:{x:0,y:300},debug:!1,fps:60,timeScale:1}},render:{pixelArt:!1,antialias:!0,powerPreference:"high-performance",clearBeforeRender:!0}}).playerData={isMobile:e}}}},n={};function a(e){var t=n[e];if(void 0!==t){if(void 0!==t.error)throw t.error;return t.exports}var s=n[e]={exports:{}};try{var r={id:e,module:s,factory:i[e],require:a};a.i.forEach((function(e){e(r)})),s=r.module,r.factory.call(s.exports,s,s.exports,r.require)}catch(e){throw s.error=e,e}return s.exports}a.m=i,a.c=n,a.i=[],e=[],a.O=(t,s,i,n)=>{if(!s){var r=1/0;for(c=0;c<e.length;c++){for(var[s,i,n]=e[c],o=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(o=!1,n<r&&(r=n));if(o){e.splice(c--,1);var h=i();void 0!==h&&(t=h)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,i,n]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.hu=e=>e+"."+a.h()+".hot-update.js",a.hmrF=()=>"main."+a.h()+".hot-update.json",a.h=()=>"41508d0db4fb8cb6be33",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},s="phaser3-webpack-template:",a.l=(e,i,n,r)=>{if(t[e])t[e].push(i);else{var o,l;if(void 0!==n)for(var h=document.getElementsByTagName("script"),c=0;c<h.length;c++){var d=h[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==s+n){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",s+n),o.src=e),t[e]=[i];var u=(s,i)=>{o.onerror=o.onload=null,clearTimeout(p);var n=t[e];if(delete t[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((e=>e(i))),s)return s(i)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}},(()=>{var e,t,s,i={},n=a.c,r=[],o=[],l="idle",h=0,c=[];function d(e){l=e;for(var t=[],s=0;s<o.length;s++)t[s]=o[s].call(null,e);return Promise.all(t).then((function(){}))}function u(){0===--h&&d("ready").then((function(){if(0===h){var e=c;c=[];for(var t=0;t<e.length;t++)e[t]()}}))}function p(e){if("idle"!==l)throw new Error("check() is only allowed in idle status");return d("check").then(a.hmrM).then((function(s){return s?d("prepare").then((function(){var i=[];return t=[],Promise.all(Object.keys(a.hmrC).reduce((function(e,n){return a.hmrC[n](s.c,s.r,s.m,e,t,i),e}),[])).then((function(){return t=function(){return e?g(e):d("ready").then((function(){return i}))},0===h?t():new Promise((function(e){c.push((function(){e(t())}))}));var t}))})):d(f()?"ready":"idle").then((function(){return null}))}))}function m(e){return"ready"!==l?Promise.resolve().then((function(){throw new Error("apply() is only allowed in ready status (state: "+l+")")})):g(e)}function g(e){e=e||{},f();var i=t.map((function(t){return t(e)}));t=void 0;var n=i.map((function(e){return e.error})).filter(Boolean);if(n.length>0)return d("abort").then((function(){throw n[0]}));var a=d("dispose");i.forEach((function(e){e.dispose&&e.dispose()}));var r,o=d("apply"),l=function(e){r||(r=e)},h=[];return i.forEach((function(e){if(e.apply){var t=e.apply(l);if(t)for(var s=0;s<t.length;s++)h.push(t[s])}})),Promise.all([a,o]).then((function(){return r?d("fail").then((function(){throw r})):s?g(e).then((function(e){return h.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e})):d("idle").then((function(){return h}))}))}function f(){if(s)return t||(t=[]),Object.keys(a.hmrI).forEach((function(e){s.forEach((function(s){a.hmrI[e](s,t)}))})),s=void 0,!0}a.hmrD=i,a.i.push((function(c){var g,f,y,x,w=c.module,b=function(t,s){var i=n[s];if(!i)return t;var a=function(a){if(i.hot.active){if(n[a]){var o=n[a].parents;-1===o.indexOf(s)&&o.push(s)}else r=[s],e=a;-1===i.children.indexOf(a)&&i.children.push(a)}else console.warn("[HMR] unexpected require("+a+") from disposed module "+s),r=[];return t(a)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return t[e]},set:function(s){t[e]=s}}};for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&"e"!==c&&Object.defineProperty(a,c,o(c));return a.e=function(e,s){return function(e){switch(l){case"ready":d("prepare");case"prepare":return h++,e.then(u,u),e;default:return e}}(t.e(e,s))},a}(c.require,c.id);w.hot=(g=c.id,f=w,x={_acceptedDependencies:{},_acceptedErrorHandlers:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:y=e!==g,_requireSelf:function(){r=f.parents.slice(),e=y?void 0:g,a(g)},active:!0,accept:function(e,t,s){if(void 0===e)x._selfAccepted=!0;else if("function"==typeof e)x._selfAccepted=e;else if("object"==typeof e&&null!==e)for(var i=0;i<e.length;i++)x._acceptedDependencies[e[i]]=t||function(){},x._acceptedErrorHandlers[e[i]]=s;else x._acceptedDependencies[e]=t||function(){},x._acceptedErrorHandlers[e]=s},decline:function(e){if(void 0===e)x._selfDeclined=!0;else if("object"==typeof e&&null!==e)for(var t=0;t<e.length;t++)x._declinedDependencies[e[t]]=!0;else x._declinedDependencies[e]=!0},dispose:function(e){x._disposeHandlers.push(e)},addDisposeHandler:function(e){x._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=x._disposeHandlers.indexOf(e);t>=0&&x._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,l){case"idle":t=[],Object.keys(a.hmrI).forEach((function(e){a.hmrI[e](g,t)})),d("ready");break;case"ready":Object.keys(a.hmrI).forEach((function(e){a.hmrI[e](g,t)}));break;case"prepare":case"check":case"dispose":case"apply":(s=s||[]).push(g)}},check:p,apply:m,status:function(e){if(!e)return l;o.push(e)},addStatusHandler:function(e){o.push(e)},removeStatusHandler:function(e){var t=o.indexOf(e);t>=0&&o.splice(t,1)},data:i[g]},e=void 0,x),w.parents=r,w.children=[],r=[],c.require=b})),a.hmrC={},a.hmrI={}})(),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=s[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e,t,s,i,n,r=a.hmrS_jsonp=a.hmrS_jsonp||{792:0},o={};function l(t,s){return e=s,new Promise(((e,s)=>{o[t]=e;var i=a.p+a.hu(t),n=new Error;a.l(i,(e=>{if(o[t]){o[t]=void 0;var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;n.message="Loading hot update chunk "+t+" failed.\n("+i+": "+a+")",n.name="ChunkLoadError",n.type=i,n.request=a,s(n)}}))}))}function h(e){function o(e){for(var t=[e],s={},i=t.map((function(e){return{chain:[e],id:e}}));i.length>0;){var n=i.pop(),r=n.id,o=n.chain,h=a.c[r];if(h&&(!h.hot._selfAccepted||h.hot._selfInvalidated)){if(h.hot._selfDeclined)return{type:"self-declined",chain:o,moduleId:r};if(h.hot._main)return{type:"unaccepted",chain:o,moduleId:r};for(var c=0;c<h.parents.length;c++){var d=h.parents[c],u=a.c[d];if(u){if(u.hot._declinedDependencies[r])return{type:"declined",chain:o.concat([d]),moduleId:r,parentId:d};-1===t.indexOf(d)&&(u.hot._acceptedDependencies[r]?(s[d]||(s[d]=[]),l(s[d],[r])):(delete s[d],t.push(d),i.push({chain:o.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:s}}function l(e,t){for(var s=0;s<t.length;s++){var i=t[s];-1===e.indexOf(i)&&e.push(i)}}a.f&&delete a.f.jsonpHmr,t=void 0;var h={},c=[],d={},u=function(e){console.warn("[HMR] unexpected require("+e.id+") to disposed module")};for(var p in s)if(a.o(s,p)){var m=s[p],g=m?o(p):{type:"disposed",moduleId:p},f=!1,y=!1,x=!1,w="";switch(g.chain&&(w="\nUpdate propagation: "+g.chain.join(" -> ")),g.type){case"self-declined":e.onDeclined&&e.onDeclined(g),e.ignoreDeclined||(f=new Error("Aborted because of self decline: "+g.moduleId+w));break;case"declined":e.onDeclined&&e.onDeclined(g),e.ignoreDeclined||(f=new Error("Aborted because of declined dependency: "+g.moduleId+" in "+g.parentId+w));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(g),e.ignoreUnaccepted||(f=new Error("Aborted because "+p+" is not accepted"+w));break;case"accepted":e.onAccepted&&e.onAccepted(g),y=!0;break;case"disposed":e.onDisposed&&e.onDisposed(g),x=!0;break;default:throw new Error("Unexception type "+g.type)}if(f)return{error:f};if(y)for(p in d[p]=m,l(c,g.outdatedModules),g.outdatedDependencies)a.o(g.outdatedDependencies,p)&&(h[p]||(h[p]=[]),l(h[p],g.outdatedDependencies[p]));x&&(l(c,[g.moduleId]),d[p]=u)}s=void 0;for(var b,v=[],S=0;S<c.length;S++){var k=c[S],I=a.c[k];I&&(I.hot._selfAccepted||I.hot._main)&&d[k]!==u&&!I.hot._selfInvalidated&&v.push({module:k,require:I.hot._requireSelf,errorHandler:I.hot._selfAccepted})}return{dispose:function(){var e;i.forEach((function(e){delete r[e]})),i=void 0;for(var t,s=c.slice();s.length>0;){var n=s.pop(),o=a.c[n];if(o){var l={},d=o.hot._disposeHandlers;for(S=0;S<d.length;S++)d[S].call(null,l);for(a.hmrD[n]=l,o.hot.active=!1,delete a.c[n],delete h[n],S=0;S<o.children.length;S++){var u=a.c[o.children[S]];u&&(e=u.parents.indexOf(n))>=0&&u.parents.splice(e,1)}}}for(var p in h)if(a.o(h,p)&&(o=a.c[p]))for(b=h[p],S=0;S<b.length;S++)t=b[S],(e=o.children.indexOf(t))>=0&&o.children.splice(e,1)},apply:function(t){for(var s in d)a.o(d,s)&&(a.m[s]=d[s]);for(var i=0;i<n.length;i++)n[i](a);for(var r in h)if(a.o(h,r)){var o=a.c[r];if(o){b=h[r];for(var l=[],u=[],p=[],m=0;m<b.length;m++){var g=b[m],f=o.hot._acceptedDependencies[g],y=o.hot._acceptedErrorHandlers[g];if(f){if(-1!==l.indexOf(f))continue;l.push(f),u.push(y),p.push(g)}}for(var x=0;x<l.length;x++)try{l[x].call(null,b)}catch(s){if("function"==typeof u[x])try{u[x](s,{moduleId:r,dependencyId:p[x]})}catch(i){e.onErrored&&e.onErrored({type:"accept-error-handler-errored",moduleId:r,dependencyId:p[x],error:i,originalError:s}),e.ignoreErrored||(t(i),t(s))}else e.onErrored&&e.onErrored({type:"accept-errored",moduleId:r,dependencyId:p[x],error:s}),e.ignoreErrored||t(s)}}}for(var w=0;w<v.length;w++){var S=v[w],k=S.module;try{S.require(k)}catch(s){if("function"==typeof S.errorHandler)try{S.errorHandler(s,{moduleId:k,module:a.c[k]})}catch(i){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:k,error:i,originalError:s}),e.ignoreErrored||(t(i),t(s))}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:k,error:s}),e.ignoreErrored||t(s)}}return c}}}self.webpackHotUpdatephaser3_webpack_template=(t,i,r)=>{for(var l in i)a.o(i,l)&&(s[l]=i[l],e&&e.push(l));r&&n.push(r),o[t]&&(o[t](),o[t]=void 0)},a.hmrI.jsonp=function(e,t){s||(s={},n=[],i=[],t.push(h)),a.o(s,e)||(s[e]=a.m[e])},a.hmrC.jsonp=function(e,o,c,d,u,p){u.push(h),t={},i=o,s=c.reduce((function(e,t){return e[t]=!1,e}),{}),n=[],e.forEach((function(e){a.o(r,e)&&void 0!==r[e]?(d.push(l(e,p)),t[e]=!0):t[e]=!1})),a.f&&(a.f.jsonpHmr=function(e,s){t&&a.o(t,e)&&!t[e]&&(s.push(l(e)),t[e]=!0)})},a.hmrM=()=>{if("undefined"==typeof fetch)throw new Error("No browser support: need fetch API");return fetch(a.p+a.hmrF()).then((e=>{if(404!==e.status){if(!e.ok)throw new Error("Failed to fetch update manifest "+e.statusText);return e.json()}}))},a.O.j=e=>0===r[e];var c=(e,t)=>{var s,i,[n,o,l]=t,h=0;if(n.some((e=>0!==r[e]))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var c=l(a)}for(e&&e(t);h<n.length;h++)i=n[h],a.o(r,i)&&r[i]&&r[i][0](),r[i]=0;return a.O(c)},d=self.webpackChunkphaser3_webpack_template=self.webpackChunkphaser3_webpack_template||[];d.forEach(c.bind(null,0)),d.push=c.bind(null,d.push.bind(d))})();var r=a.O(void 0,[418],(()=>a(987)));r=a.O(r)})();